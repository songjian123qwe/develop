{"version":3,"sources":["webpack://[name]/webpack/universalModuleDefinition","webpack://[name]/webpack/bootstrap","webpack://[name]/external \"nc-lightapp-front\"","webpack://[name]/./src/uapbd/sminfo/payment_base/card/index.js","webpack://[name]/external {\"root\":\"React\",\"var\":\"React\",\"commonjs\":\"react\",\"commonjs2\":\"react\",\"amd\":\"react\"}","webpack://[name]/external {\"root\":\"ReactDOM\",\"var\":\"ReactDOM\",\"commonjs\":\"react-dom\",\"commonjs2\":\"react-dom\",\"amd\":\"react-dom\"}"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__1__","__WEBPACK_EXTERNAL_MODULE__2__","__WEBPACK_EXTERNAL_MODULE__3__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","_react","_ncLightappFront","NCAffix","base","PrintOutput","NCPopconfirm","NCFormControl","NCBackBtn","high","addCache","cardCache","getCacheById","updateCache","getCurrentLastId","deleteCacheById","getNextId","dataSource","formId","tableId","queryCardUrl","qryUserInfoUrl","printUrl","pk_item","toggleShow","props","status","getUrlParam","meta","getMeta","cardTable","showColByKey","button","setButtonVisible","setButtonDisabled","cardPagination","setCardPaginationVisible","hideColByKey","form","setFormStatus","setStatus","Card","_classCallCheck","this","_this2","_possibleConstructorReturn","__proto__","getPrototypeOf","_initialiseProps","state","json","pk_org","title_code","context","nodeType","pk_org_v","org_Name","org_v_Name","mdid","PermissionOrgIDs","Component","_this3","createUIDom","pagecode","pagecode_card","data","assign","template","modifierMeta","setMeta","setButtons","setPopContent","items","map","item","attrcode","disabled","queryCondition","AppCode","TreeRefActionExt","porCol","label","visible","className","width","itemtype","fixed","render","text","record","index","btnArray","tableBtnAry","createOprationButton","area","buttonLimit","onButtonClick","id","allData","getVisibleRows","forEach","element","values","parseInt","toString","setValByKeyAndRowId","rowid","addRow","showorder","display","delRowsByIndex","toggleRowView","openModel","console","log","tableButtonClick","push","_this4","MultiInit","getMultiLang","domainName","callback","inlt","setState","initTemplate","pk","getdata","setDefaultValue","l_formstatus","getFormStatus","onbeforeunload","cardData","setAllFormValue","_defineProperty","head","body","setTableData","rows","setUrlParam","EmptyAllFormValue","pushTo","listUrl","pagecode_list","appcode","_props","modal","BillHeadInfo","createCardPagination","createBillHeadInfo","createForm","getButtons","createCardTable","createButtonApp","createModal","_react2","default","createElement","backBtnClick","onReturnClick","buttonClick","handlePageInfoChange","pageInfoClick","onAfterEvent","afterEvent","tableHead","getTableHead","modelSave","showIndex","tableAfterEvent","onBeforeEvent","tableBeforeEvent","title","content","beSureBtnClick","delConfirm","ref","url","funcode","printFunCode","nodekey","printNodeKey","oids","ids","outputType","_this5","ajax","success","res","setFormItemsValue","group","pk_group","effectdate","effectDate","add","valid","promptBox","color","saveClick","getDataForCache","cancel","resetTableData","rowNum","getNumberOfRows","onPrint","onOutput","deepClone","getFormItemsValue","businessInfo","getBusinessInfo","date","grpId","grpName","businessDate","groupId","groupName","operateCode","arguments","length","undefined","pks","mdOperateCode","getAllFormValue","print","toast","refs","printOutput","open","cacheTools","pageid","changedrows","g","type","setValByKeyAndIndex","newvalue","oldvalue","line","model","includes","checkdata","getValByKeyAndIndex","find","isRefresh","pk_org_c","_this5$props$dealForm","formulamsg","Array","dealFormulamsg","btn","getAllRows","setTimeout","isCheckNow","checkTableRequired","filterEmptyRows","CardData","createMasterChildData","validateToSave","pk_value","deleteinfo","ts","closeModel","createPage","billinfo","billtype","headcode","bodycode"],"mappings":"CAAA,SAAAA,EAAAC,GACA,iBAAAC,SAAA,iBAAAC,OACAA,OAAAD,QAAAD,EAAAG,QAAA,qBAAAA,QAAA,SAAAA,QAAA,cACA,mBAAAC,eAAAC,IACAD,QAAA,yCAAAJ,GACA,iBAAAC,QACAA,QAAA,wCAAAD,EAAAG,QAAA,qBAAAA,QAAA,SAAAA,QAAA,cAEAJ,EAAA,wCAAAC,EAAAD,EAAA,qBAAAA,EAAA,MAAAA,EAAA,UARA,CASCO,OAAA,SAAAC,EAAAC,EAAAC,GACD,mBCTA,IAAAC,KAGA,SAAAC,EAAAC,GAGA,GAAAF,EAAAE,GACA,OAAAF,EAAAE,GAAAX,QAGA,IAAAC,EAAAQ,EAAAE,IACAC,EAAAD,EACAE,GAAA,EACAb,YAUA,OANAc,EAAAH,GAAAI,KAAAd,EAAAD,QAAAC,IAAAD,QAAAU,GAGAT,EAAAY,GAAA,EAGAZ,EAAAD,QA0DA,OArDAU,EAAAM,EAAAF,EAGAJ,EAAAO,EAAAR,EAGAC,EAAAQ,EAAA,SAAAlB,EAAAmB,EAAAC,GACAV,EAAAW,EAAArB,EAAAmB,IACAG,OAAAC,eAAAvB,EAAAmB,GAA0CK,YAAA,EAAAC,IAAAL,KAK1CV,EAAAgB,EAAA,SAAA1B,GACA,oBAAA2B,eAAAC,aACAN,OAAAC,eAAAvB,EAAA2B,OAAAC,aAAwDC,MAAA,WAExDP,OAAAC,eAAAvB,EAAA,cAAiD6B,OAAA,KAQjDnB,EAAAoB,EAAA,SAAAD,EAAAE,GAEA,GADA,EAAAA,IAAAF,EAAAnB,EAAAmB,IACA,EAAAE,EAAA,OAAAF,EACA,KAAAE,GAAA,iBAAAF,QAAAG,WAAA,OAAAH,EACA,IAAAI,EAAAX,OAAAY,OAAA,MAGA,GAFAxB,EAAAgB,EAAAO,GACAX,OAAAC,eAAAU,EAAA,WAAyCT,YAAA,EAAAK,UACzC,EAAAE,GAAA,iBAAAF,EAAA,QAAAM,KAAAN,EAAAnB,EAAAQ,EAAAe,EAAAE,EAAA,SAAAA,GAAgH,OAAAN,EAAAM,IAAqBC,KAAA,KAAAD,IACrI,OAAAF,GAIAvB,EAAA2B,EAAA,SAAApC,GACA,IAAAmB,EAAAnB,KAAA+B,WACA,WAA2B,OAAA/B,EAAA,SAC3B,WAAiC,OAAAA,GAEjC,OADAS,EAAAQ,EAAAE,EAAA,IAAAA,GACAA,GAIAV,EAAAW,EAAA,SAAAiB,EAAAC,GAAsD,OAAAjB,OAAAkB,UAAAC,eAAA1B,KAAAuB,EAAAC,IAGtD7B,EAAAgC,EAAA,eAIAhC,IAAAiC,EAAA,uBClFA1C,EAAAD,QAAAM,kVCCAsC,EAAAlC,EAAA,UAEAmC,KADAnC,EAAA,IACAA,EAAA,mLACQoC,EAAoDC,OAApDD,QACAE,GADoDD,OAA3CE,aAA2CF,OAA7BG,cAA6BH,OAAdI,UACtBC,OAAhBJ,aAEAK,EAAsFC,YAAtFD,SAAUE,EAA4ED,YAA5EC,aAAcC,EAA8DF,YAA9DE,YAAaC,EAAiDH,YAAjDG,iBAA6BC,GAAoBJ,YAA/BK,UAA+BL,YAApBI,iBACpEE,EAAa,4BAEbC,EAAS,UACTC,EAAU,YAIVC,EAAe,4CAIfC,EAAiB,qDACjBC,EAAW,wCAEXC,EAAU,aAuDhB,SAASC,EAAWC,GAChB,IAAIC,EAASD,EAAME,YAAY,UAGjB,OAAVD,GAEID,EAAMG,KAAKC,UAAUV,IACrBM,EAAMK,UAAUC,aAAaZ,EAAS,OAE1CM,EAAMO,OAAOC,kBAAkB,OAAQ,MAAO,OAAQ,SAAU,UAAW,WAAY,QAAS,SAAU,WAAW,GACrHR,EAAMO,OAAOC,kBAAkB,OAAQ,UAAW,SAAU,UAAW,aAAc,SAAU,YAAY,GAC3GR,EAAMO,OAAOE,kBAAkB,WAAW,GAC1CT,EAAMU,eAAeC,yBAAyB,qBAAqB,IAEpD,QAAVV,GAEDD,EAAMG,KAAKC,UAAUV,IACrBM,EAAMK,UAAUC,aAAaZ,EAAS,OAE1CM,EAAMO,OAAOC,kBAAkB,OAAQ,MAAO,OAAQ,SAAU,UAAW,WAAY,QAAS,SAAU,WAAW,GACrHR,EAAMO,OAAOC,kBAAkB,OAAQ,UAAW,SAAU,UAAW,aAAc,UAAW,WAAW,GAC3GR,EAAMO,OAAOE,kBAAkB,WAAW,GAC1CT,EAAMU,eAAeC,yBAAyB,qBAAqB,KAI/DX,EAAMG,KAAKC,UAAUV,IACrBM,EAAMK,UAAUO,aAAalB,EAAS,OAEtCM,EAAME,YAAY,OAMlBF,EAAMO,OAAOC,kBAAkB,OAAQ,UAAW,SAAU,UAAW,aAAc,UAAW,SAAU,QAAS,SAAS,GAC5HR,EAAMO,OAAOC,kBAAkB,MAAO,OAAQ,SAAU,UAAW,WAAY,SAAU,WAAW,GACpGR,EAAMU,eAAeC,yBAAyB,qBAAqB,KANnEX,EAAMO,OAAOC,kBAAkB,OAAQ,UAAW,SAAU,UAAW,aAAc,UAAW,SAAU,QAAS,OAAQ,OAAQ,SAAU,UAAW,WAAY,SAAU,WAAW,GACzLR,EAAMO,OAAOC,kBAAkB,QAAQ,GACvCR,EAAMU,eAAeC,yBAAyB,qBAAqB,KAQ3EX,EAAMa,KAAKC,cAAcrB,EAAQQ,GACjCD,EAAMK,UAAUU,UAAUrB,EAASO,OAGjCe,iBAEF,SAAAA,EAAYhB,gGAAOiB,CAAAC,KAAAF,GAAA,IAAAG,mKAAAC,CAAAF,MAAAF,EAAAK,WAAAnE,OAAAoE,eAAAN,IAAArE,KAAAuE,KACTlB,IADS,OAAAuB,EAAA5E,KAAAwE,GAEfA,EAAK1B,OAASA,EAEd0B,EAAKzB,QAAUA,EACfyB,EAAKK,OACDC,QACAC,OAAQ,GACRC,WAAY,GACZC,SACIC,SAAU7B,EAAM6B,SAChBH,OAAQ,GACRI,SAAU,GACVC,SAAU,GACVC,WAAY,GACZC,KAAM,GACNC,sBAhBOf,qUAFJgB,qDAwBDnC,GAAM,IAAAoC,EAAAlB,KAChBlB,EAAMqC,aAEEC,SAAUtC,EAAMuC,eAGpB,SAACC,GACG,GAAIA,EAAM,CACN,IAAIZ,EAAUY,EAAKZ,QAEnB,GADAQ,EAAKZ,MAAMI,QAAU1E,OAAOuF,OAAOL,EAAKZ,MAAMI,QAASA,GACnDY,EAAKE,SAAU,CACf,IAAIvC,EAAOqC,EAAKE,SAChBN,EAAKO,aAAa3C,EAAOG,GACzBH,EAAMG,KAAKyC,QAAQzC,EAAM,cAI7B,GAAIqC,EAAKjC,OAAQ,CACb,IAAIA,EAASiC,EAAKjC,OAClBP,EAAMO,OAAOsC,WAAWtC,EAAQ,WAC5BP,EAAMO,OAAOuC,cAAc,UAAWV,EAAKZ,MAAMC,KAAK,wBAE1D1B,EAAWC,4CAQlBA,EAAOG,GAEhB,IAAIF,EAASD,EAAME,YAAY,UAC/BC,EAAKV,GAAQQ,OAASA,EACtBE,EAAKT,GAASO,OAASA,EAEvBE,EAAKV,GAAQsD,MAAMC,IAAI,SAACC,GAEC,UAAjBA,EAAKC,WAEiB,SAAlBlD,EAAM6B,SACNoB,EAAKE,SAAW,QAGhBF,EAAKG,eAAiB,WAClB,OACIC,QAAS,aACTC,iBAAkB,yDAOtC,IAAIC,GACAxF,IAAK,SACLmF,SAAU,MACVM,MAAOtC,KAAKM,MAAMC,KAAK,qBACvBgC,SAAS,EACTC,UAAW,YACXC,MAAO,QACPC,SAAU,WACVC,MAAO,QACPC,OATS,SASFC,EAAMC,EAAQC,GAEjB,IAAIC,EAxLF,SAAClE,GACf,MAAuC,WAAhCA,EAAME,YAAY,WAClB,WAAa,aAAc,WAsLPiE,CAAYnE,GAE3B,OAAOA,EAAMO,OAAO6D,qBAChBF,GAEIG,KAAM,iBACNC,YAAa,EACbC,cAAe,SAACvE,EAAOwE,GAAR,OAjLvC,SAA0BxE,EAAOwE,EAAIT,EAAMC,EAAQC,GAE/C,IAAIQ,EAAUzE,EAAMK,UAAUqE,eAAehF,GACzCjC,KACJ,OAAQ+G,GACJ,IAAK,aACDC,EAAQE,QAAQ,SAAAC,GACRA,EAAQC,OAAR,UAA4BpH,OAASuG,EAAOa,OAAP,UAA2BpH,QAChEA,GAASqH,SAASF,EAAQC,OAAR,UAA4BpH,OAAS,GAAGsH,WAC1D/E,EAAMK,UAAU2E,oBAAoBtF,EAASkF,EAAQK,MAAO,aAAexH,MAAOA,OAG1FuC,EAAMK,UAAU6E,OAAOxF,EAASuE,GAASkB,WAAeC,QAAS,GAAI3H,MAAOwG,EAAQ,EAAI,MAAQ,GAChG,MACJ,IAAK,UACDQ,EAAQE,QAAQ,SAAAC,GACRA,EAAQC,OAAR,UAA4BpH,OAASuG,EAAOa,OAAP,UAA2BpH,QAChEA,GAASqH,SAASF,EAAQC,OAAR,UAA4BpH,OAAS,GAAGsH,WAC1D/E,EAAMK,UAAU2E,oBAAoBtF,EAASkF,EAAQK,MAAO,aAAexH,MAAOA,OAG1FuC,EAAMK,UAAUgF,eAAe3F,EAASuE,GACxC,MACJ,IAAK,SACDjE,EAAMK,UAAUiF,cAAc5F,EAASsE,GACvC,MACJ,IAAK,SACDhE,EAAMK,UAAUkF,UAAU7F,EAAS,OAAQsE,EAAQC,GACnD,MACJ,QACIuB,QAAQC,IAAIjB,EAAIP,IAmJ0ByB,CAAiB1F,EAAOwE,EAAIT,EAAMC,EAAQC,QAOxF,OAFA9D,EAAKT,GAASqD,MAAM4C,KAAKpC,GAElBpD,8CAGS,IAAAyF,EAAA1E,KAahB,GAHAA,KAAKlB,MAAM6F,UAAUC,cAAcvJ,SAAU,aAAcwJ,WAAY,QAAQC,SAPhE,SAACvE,EAAMxB,EAAQgG,GAC/BhG,GACH2F,EAAKM,UAAUzE,OAAMwE,QAAM,WAC1BL,EAAKO,aAAaP,EAAK5F,YAON,OADDkB,KAAKlB,MAAME,YAAY,UACf,CACjB,IAAIkG,EAAKlF,KAAKlB,MAAME,YAAY,MAC5BkG,GAAY,aAANA,GACNlF,KAAKmF,QAAQD,QAIjBlF,KAAKoF,+DAKT,IAAIC,EAAerF,KAAKlB,MAAMa,KAAK2F,cAAc/G,GAE7CxD,OAAOwK,eADS,OAAhBF,GAAyC,QAAhBA,EACD,KAGA,WACpB,MAAO,iGAgjBHH,EAAIJ,GACtB,GAAII,EAMM,CACA,IAAIM,EAAWvH,EAAaiH,EAAI5G,GAC7BkH,GACCxF,KAAKlB,MAAMa,KAAK8F,gBAAhBC,KAAmCnH,EAAQiH,EAASG,KAAKpH,KACtDiH,EAASI,MAAQJ,EAASI,KAAKpH,GAC9BwB,KAAKlB,MAAMK,UAAU0G,aAAarH,EAASgH,EAASI,KAAKpH,IAGzDwB,KAAKlB,MAAMK,UAAU0G,aAAarH,GAAUsH,UAEhD9F,KAAKlB,MAAMiH,YAAYb,KAGvBlF,KAAKmF,QAAQD,GACblF,KAAKlB,MAAMiH,YAAYb,SAnBpClF,KAAKlB,MAAMa,KAAKqG,kBAAkBhG,KAAKzB,QAC9ByB,KAAKlB,MAAMK,UAAU0G,aAAa7F,KAAKxB,SAAUsH,UAsBxDhB,GAA+B,mBAAZA,GACrBA,EAASrJ,KAAKuE,8CAuCTA,KAAKlB,MAAMmH,OAAOjG,KAAKlB,MAAMoH,SACzB9E,SAAUpB,KAAKlB,MAAMqH,cACrBC,QAASpG,KAAKlB,MAAMsH,QACpBrH,OAAQ,4CAIP,IAAAsH,EACiErG,KAAKlB,MAArEK,EADDkH,EACClH,UAAWQ,EADZ0G,EACY1G,KAAMN,EADlBgH,EACkBhH,OAAQiH,EAD1BD,EAC0BC,MAAO9G,EADjC6G,EACiC7G,eAAe+G,EADhDF,EACgDE,aAC7CC,EAAyBhH,EAAzBgH,qBACDC,EAAsBF,EAAtBE,mBAKDC,GAJQ1G,KAAKlB,MAAMO,OAAOsH,aAIXhH,EAAf+G,YACAE,EAAoBzH,EAApByH,gBACAC,EAAoBxH,EAApBwH,gBACAC,EAAgBR,EAAhBQ,YACF/H,EAASiB,KAAKlB,MAAME,YAAY,UACpC,OACI+H,EAAAC,QAAAC,cAAA,OAAK3D,GAAG,gBACJyD,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,gBACXuE,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,oBACXuE,EAAAC,QAAAC,cAACzJ,EAAD,KACIuJ,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,uBAIXuE,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,4BACViE,GACOS,aAAclH,KAAKmH,cAAcrK,KAAKkD,QAG9C+G,EAAAC,QAAAC,cAAA,MAAIzE,UAAU,uBAAoG,SAAvBxC,KAAKlB,MAAM6B,SAAqBX,KAAKM,MAAMC,KAAK,qBAAuBP,KAAKM,MAAMC,KAAK,qBAAgC,UAAVxB,EAAA,IAAyBiB,KAAKM,MAAMG,WAAe,KAE/PsG,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,sBACVqE,GACG1D,KAAM,qBACNE,cAAerD,KAAKoH,YAAYtK,KAAKkD,QAExCwG,GACGa,qBAAsBrH,KAAKsH,cAAcxK,KAAKkD,MAC9C1B,WAAYA,OAK5ByI,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,qBACVkE,EAAW1G,KAAKzB,QACbgJ,aAAcvH,KAAKwH,WAAW1K,KAAKkD,UAI/C+G,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,uBACXuE,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,sBACVoE,EAAgB5G,KAAKxB,SAClBiJ,UAAWzH,KAAK0H,aAAa5K,KAAKkD,MAClC2H,UAAW3H,KAAK2H,UAAU7K,KAAKkD,MAC/B4H,WAAW,EACXL,aAAcvH,KAAK6H,gBAAgB/K,KAAKkD,MACxC8H,cAAe9H,KAAK+H,iBAAiBjL,KAAKkD,SAGjD8G,EAAY,UACTkB,MAAOhI,KAAKM,MAAMC,KAAK,qBACvB0H,QAASjI,KAAKM,MAAMC,KAAK,qBACzB2H,eAAgBlI,KAAKmI,WAAWrL,KAAKkD,QAGxC8G,EAAY,SACTkB,MAAOhI,KAAKM,MAAMC,KAAK,qBACvB0H,QAASjI,KAAKM,MAAMC,KAAK,uBAQ7BwG,EAAAC,QAAAC,cAACvJ,GACG0K,IAAI,cACJC,IAAK1J,EACL2C,MACI8E,QAASpG,KAAKlB,MAAMsH,QACpBkC,QAAStI,KAAKlB,MAAMyJ,aACpBC,QAASxI,KAAKlB,MAAM2J,aACpBC,KAAM1I,KAAKM,MAAMqI,IACjBC,WAAY,qDAlsBxCxD,gBAAkB,WAOa,SAAvByD,EAAK/J,MAAM6B,UAEX,EAAApD,EAAAuL,OACIT,IAAK3J,EACLqK,QAAS,SAACC,GACNH,EAAK/J,MAAMa,KAAKsJ,kBAAkBJ,EAAKtK,QACnCiC,QAEIjE,MAAOyM,EAAI1H,KAAK4H,MAAMC,SACtBjF,QAAS8E,EAAI1H,KAAK4H,MAAMrN,MACzBuN,YAEC7M,MAAOyM,EAAI1H,KAAK+H,WAChBnF,QAAS,YAQzB,EAAA3G,EAAAuL,OACIT,IAAK3J,EACLqK,QAAS,SAACC,GACNH,EAAK/J,MAAMa,KAAKsJ,kBAAkBJ,EAAKtK,QACnC6K,YAEI7M,MAAOyM,EAAI1H,KAAK+H,WAChBnF,QAAS,MAEb1D,QAEIjE,MAAOsM,EAAKvI,MAAMI,QAAQF,OAC1B0D,QAAS2E,EAAKvI,MAAMI,QAAQG,qBAQpDuG,YAAc,SAACtI,EAAOwE,GAGlB,OAAQA,GACJ,IAAK,MACDuF,EAAKS,IAAIxK,GAMTA,EAAMiH,aACFK,QAAStH,EAAMsH,QACfhF,SAAUtC,EAAMuC,cAChBtC,OAAQ,QAEZF,EAAWgK,EAAK/J,OAChB,MACJ,IAAK,OACD+J,EAAKU,MAAMzK,EAAM,OAAQ,WAOrBA,EAAMiH,aACFK,QAAStH,EAAMsH,QACfhF,SAAUtC,EAAMuC,cAChBtC,OAAQ,OACRuE,GAAIxE,EAAME,YAAY,QAE1BH,EAAWgK,EAAK/J,SAEpB,MACJ,IAAK,SACD+J,EAAKU,MAAMzK,EAAM,SAAU,YACvB,EAAAvB,EAAAiM,YACIC,MAAO,UACPzB,MAAOa,EAAKvI,MAAMC,KAAK,qBACvB0H,QAASY,EAAKvI,MAAMC,KAAK,qBACzB2H,eAAgBW,EAAKV,WAAWrL,KAAK+L,OAG7C,MACJ,IAAK,OACD/J,EAAMmH,OAAOnH,EAAMoH,SACfE,QAAStH,EAAMsH,QACfhF,SAAUtC,EAAMqH,cAChBpH,OAAQ,WAEZ,MACJ,IAAK,OACD8J,EAAKa,UAAU,QACf,MACJ,IAAK,UACDb,EAAKa,UAAU,WACf,MACJ,IAAK,UACD,EAAAnM,EAAAiM,YACIC,MAAO,UACPzB,MAAOa,EAAKvI,MAAMC,KAAK,qBACvB0H,QAASY,EAAKvI,MAAMC,KAAK,qBACzB2H,eAAgB,WACZ,GAAoC,QAAhCpJ,EAAME,YAAY,UAAqB,CAE3C,IAAIkG,EAAK/G,EAAiBG,GACxCuK,EAAKc,gBAAgBzE,EAAI,WACpBpG,EAAMa,KAAKiK,OAAOf,EAAKtK,QACvBO,EAAMK,UAAU0K,eAAehB,EAAKrK,SACpCM,EAAMiH,aACVhH,OAAQ,SACRuE,GAAIxE,EAAME,YAAY,MACtBoH,QAAQtH,EAAMsH,QACdhF,SAAStC,EAAMuC,kBA4BmC,SAAhCvC,EAAME,YAAY,YACnBF,EAAMa,KAAKiK,OAAOf,EAAKtK,QACvBO,EAAMK,UAAU0K,eAAehB,EAAKrK,SAOpCM,EAAMiH,aACFK,QAAStH,EAAMsH,QACfhF,SAAUtC,EAAMuC,cAChBtC,OAAQ,SACRuE,GAAIxE,EAAME,YAAY,SAG9BH,EAAWgK,EAAK/J,UAGxB,MACJ,IAAK,UACD,IAAIgL,EAAShL,EAAMK,UAAU4K,gBAAgBlB,EAAKrK,SAClDM,EAAMK,UAAU6E,OAAO6E,EAAKrK,QAASsL,GAAU7F,WAAeC,QAAS,GAAI3H,MAAOuN,EAAS,EAAI,MAAQ,GACvG,MACJ,IAAK,UAODhL,EAAMiH,aACFK,QAAStH,EAAMsH,QACfhF,SAAUtC,EAAMuC,cAChBtC,OAAQD,EAAME,YAAY,UAC1BsE,GAAIxE,EAAME,YAAY,QAE1BH,EAAWgK,EAAK/J,OAChB+J,EAAK1D,QAAQrG,EAAME,YAAY,OAAO,GACtC,MACJ,IAAK,WAGL,IAAK,QACD6J,EAAKmB,UACL,MACJ,IAAK,SACDnB,EAAKoB,kBAOjBX,IAAM,SAACxK,GACH,IAAI0B,GAAS,EAAAjD,EAAA2M,WAAUpL,EAAMa,KAAKwK,kBAAkBtB,EAAKtK,OAAQ,WAEjEO,EAAMa,KAAKqG,kBAAkB6C,EAAKtK,QAClCO,EAAMK,UAAU0G,aAAagD,EAAKrK,SAAWsH,UAM7ChH,EAAMiH,aACFK,QAAStH,EAAMsH,QACfhF,SAAUtC,EAAMuC,cAChBtC,OAAQ,QAEZ,IAAIqL,GAAe,EAAA7M,EAAA8M,mBACfC,EAAO,KACPC,EAAQ,KACRC,EAAU,KAEVJ,IACAE,EAAOF,EAAaK,aACpBF,EAAQH,EAAaM,QACrBF,EAAUJ,EAAaO,WAIL,OAAlB7L,EAAM6B,UAAqBH,EAAOjE,OAASgO,IAC3C/J,GAAWjE,MAAO,GAAI2H,QAAS,KAGb,SAAlBpF,EAAM6B,UAAuBH,GAAU+J,IACvC/J,GAAWjE,MAAOgO,EAAOrG,QAASsG,IAEtC1L,EAAMa,KAAKsJ,kBAAkBJ,EAAKtK,QAAUiC,QAAYjE,MAAOiE,EAAOjE,MAAO2H,QAAS1D,EAAO0D,WAC7FpF,EAAMa,KAAKsJ,kBAAkBJ,EAAKtK,QAAU6K,YAAgB7M,MAAO+N,EAAMpG,QAASoG,WAGtFf,MAAQ,SAACzK,GAAmC,IAA7B8L,EAA6BC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAjB,GAAI/F,EAAa+F,UAAA,GACpCvJ,GACA0J,KAAMlM,EAAMa,KAAKwK,kBAAkB5L,EAAQK,GAASrC,OACpDoE,SAAU7B,EAAM6B,SAChBsK,cAAcL,IAElB,EAAArN,EAAAuL,OACIT,IA9eK,wCA+eL/G,OACAyH,QAAS,SAACC,GACNlE,GAAYA,aAKxBkF,QAAU,WAEN,IAAIzG,EAAUsF,EAAK/J,MAAMa,KAAKuL,gBAAgB3M,GAE9C,GAAuB,IAAnBgF,EAAQuH,OAAZ,CAKA,IAAIE,KAEJzH,EAAQuC,KAAKrC,QAAQ,SAAC1B,EAAMlF,GACxBmO,EAAIvG,KAAK1C,EAAK4B,OAAO/E,GAASrC,UAElC,EAAAgB,EAAA4N,OACI,MACAxM,GAEIyH,QAASyC,EAAK/J,MAAMsH,QACpBkC,QAASO,EAAK/J,MAAMyJ,aACpBC,QAASK,EAAK/J,MAAM2J,aACpBC,KAAMsC,SAhBV,EAAAzN,EAAA6N,QAAQnD,QAASY,EAAKvI,MAAMC,KAAK,qBAAsBkJ,MAAO,kBAqBtEQ,SAAW,WAEP,IAAI1G,EAAUsF,EAAK/J,MAAMa,KAAKuL,gBAAgB3M,GAC9C,GAAuB,IAAnBgF,EAAQuH,OAAZ,CAIA,IAAIE,KAEJzH,EAAQuC,KAAKrC,QAAQ,SAAC1B,EAAMlF,GACxBmO,EAAIvG,KAAK1C,EAAK4B,OAAO/E,GAASrC,SAElCsM,EAAK7D,UACD2D,IAAKqC,GACNnC,EAAKwC,KAAKC,YAAYC,aAVrB,EAAAhO,EAAA6N,QAAQnD,QAASY,EAAKvI,MAAMC,KAAK,qBAAsBkJ,MAAO,kBAatEnC,cAAgB,SAACxI,EAAOoG,GAEpB,IAAI5D,GACAd,OAAUgL,aAAWrP,IAAI,UACzB+I,GAAMA,EACNuG,OAAU3M,EAAMuC,gBAEpB,EAAA9D,EAAAuL,OACIT,IAAK5J,EACL6C,KAAMA,EACNyH,QAAS,SAACC,GACFA,EAAI1H,KAAKqE,OAET7G,EAAMa,KAAK8F,gBAAXC,KAA8BnH,EAASyK,EAAI1H,KAAKqE,KAAKpH,KACrDO,EAAMiH,YAAYb,IAElB8D,EAAI1H,KAAKsE,MACT9G,EAAMK,UAAU0G,aAAarH,EAASwK,EAAI1H,KAAKsE,KAAKpH,aAOpEgJ,WAAa,SAAC1I,EAAOzD,EAAUwB,EAAKN,EAAOmP,EAAapQ,EAAG+B,EAAGsO,UAE9D9D,gBAAkB,SAAC/I,EAAOzD,EAAUwB,EAAKN,EAAOmP,EAAa3I,EAAOD,EAAQ8I,GAC7D,cAAP/O,GAAuBN,GAAkB,MAATA,GAA0B,IAATA,IACjDuC,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,cAAgBxG,MAAO,KAAM2H,QAAS,OAC3FpF,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,aAAexG,MAAO,KAAM2H,QAAS,OAC1FpF,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,eAAiBxG,MAAO,KAAM2H,QAAS,OAC5FpF,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,kBAAoBxG,MAAO,KAAM2H,QAAS,QAExF,aAAPrH,GAAsBN,GAAkB,MAATA,GAA0B,IAATA,IAChDuC,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,cAAgBxG,MAAO,KAAM2H,QAAS,OACvFwH,EAAY,GAAGI,SAASvP,OAASmP,EAAY,GAAGK,SAASxP,QACzDuC,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,cAAgBxG,MAAO,KAAM2H,QAAS,OAC3FpF,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,eAAiBxG,MAAO,IAAK2H,QAAS2E,EAAKvI,MAAMC,KAAK,uBAC3GzB,EAAMK,UAAU0M,oBAAoBxQ,EAAU0H,EAAO,kBAAoBxG,MAAO,IAAK2H,QAAS,cAK1G6D,iBAAmB,SAACjJ,EAAOzD,EAAUwB,EAAKN,EAAOwG,EAAOD,EAAQzF,EAAG2O,EAAMC,GAErE,IAAIlN,EAASD,EAAME,YAAY,UAE3BC,EAAOH,EAAMG,KAAKC,UAEtB,GAAc,UAAVH,IAAuB,aAAc,cAAe,kBAAkBmN,SAASrP,GAAM,CAErF,IAAIsP,EAAYrN,EAAMK,UAAUiN,oBAAoB/Q,EAAU0H,EAAO,aAErE,IAAKoJ,GAAgC,MAAnBA,EAAU5P,OAAoC,IAAnB4P,EAAU5P,MAEnD,OADA,EAAAgB,EAAA6N,QAAQnD,QAASY,EAAKvI,MAAMC,KAAK,qBAAsBkJ,MAAO,YACvD,EAKL,gBAAP5M,IACoBoC,EAAK5D,GAAUwG,MAAMwK,KAAK,SAACtK,GAAD,MAA2B,gBAAjBA,EAAKC,WAC/CE,eAAiB,WAC1B,OACI1B,OAAO1B,EAAMa,KAAKwK,kBAAkB5L,EAAO,UAAUhC,SAKvD,WAAPM,IACeoC,EAAK5D,GAAUwG,MAAMwK,KAAK,SAACtK,GAAD,MAA2B,WAAjBA,EAAKC,WAC/CE,eAAiB,WACrB,OACI1B,OAAO1B,EAAMa,KAAKwK,kBAAkB5L,EAAO,UAAUhC,SAMjE,OAAO,QAIX4I,QAAU,SAACD,EAAIoH,GAA8B,IAApBC,EAAoB1B,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAT,KAC5BvJ,GACA4D,KACA1E,OAAoB,MAAZ+L,EAAkBf,aAAWrP,IAAI,UAAUoQ,IAEvD,EAAAhP,EAAAuL,OACIT,IAAK5J,EACL6C,OACAyH,QAAS,SAACC,GACN,GAAIA,EAAI1H,KAAKqE,KAAM,CACfkD,EAAK/J,MAAMa,KAAK8F,gBAAhBC,KAAmCmD,EAAKtK,OAASyK,EAAI1H,KAAKqE,KAAKkD,EAAKtK,UACpE,IAAIkC,EAAauI,EAAI1H,KAAKqE,KAAKkD,EAAKtK,QAAQuH,KAAK,GAAGnC,OAAnC,KAAqDpH,MACtEsM,EAAK7D,UAAWvE,eAOgE,IAAA+L,GALhFxD,EAAI1H,KAAKsE,MACTiD,EAAK/J,MAAMK,UAAU0G,aAAagD,EAAKrK,QAASwK,EAAI1H,KAAKsE,KAAKiD,EAAKrK,UAInEwK,EAAIyD,YAAczD,EAAIyD,sBAAsBC,OAAS1D,EAAIyD,WAAW3B,OAAS,IAC7EjC,EAAK/J,MAAM6N,eACP3D,EAAIyD,YADR/G,EAAA8G,KAGS3D,EAAKrK,QAAS,SAHvBkH,EAAA8G,EAIS3D,EAAKtK,OAAQ,QAJtBiO,IASAF,IACA,EAAA/O,EAAA6N,QAAQnD,QAASY,EAAKvI,MAAMC,KAAK,qBAAsBkJ,MAAO,qBAO9EC,UAAY,SAACkD,GAST,GARK/D,EAAK/J,MAAMK,UAAU0N,WAAWrO,KACjC,EAAAjB,EAAA6N,QAAQnD,QAASY,EAAKvI,MAAMC,KAAK,qBAAsBkJ,MAAO,WAElEqD,WAAW,aAGR,GAECjE,EAAK/J,MAAMa,KAAKoN,WAAWxO,IAAWsK,EAAK/J,MAAMK,UAAU6N,mBAAmBxO,GAAU,CACxFqK,EAAK/J,MAAMK,UAAU8N,gBAAgBzO,GACrC,IAAI0O,EAAWrE,EAAK/J,MAAMqO,sBAAsBtE,EAAK/J,MAAMuC,cAAewH,EAAKtK,OAAQsK,EAAKrK,SAExF6J,EA3qBA,uCA4qBqC,SAArCQ,EAAK/J,MAAME,YAAY,YACvBqJ,EA5qBE,0CAgrBNQ,EAAK/J,MAAMsO,eAAgBF,EAAW,YAClC,EAAA3P,EAAAuL,OACIT,IAAKA,EACL/G,KAAM4L,EACNnE,QAAS,SAACC,GACN,IAAIqE,EAAW,KACf,GAAIrE,EAAID,QAAS,CAWb,GAVIC,EAAI1H,OACA0H,EAAI1H,KAAKqE,MAAQqD,EAAI1H,KAAKqE,KAAKkD,EAAKtK,UACpCsK,EAAK/J,MAAMa,KAAK8F,gBAAhBC,KAAmCmD,EAAKtK,OAASyK,EAAI1H,KAAKqE,KAAKkD,EAAKtK,UACpE8O,EAAWrE,EAAI1H,KAAKqE,KAAKkD,EAAKtK,QAAQuH,KAAK,GAAGnC,OAAO/E,GAASrC,OAE9DyM,EAAI1H,KAAKsE,MAAQoD,EAAI1H,KAAKsE,KAAKiD,EAAKrK,UACpCqK,EAAK/J,MAAMK,UAAU0G,aAAagD,EAAKrK,QAASwK,EAAI1H,KAAKsE,KAAKiD,EAAKrK,YAG3E,EAAAjB,EAAA6N,QAAQpD,MAAOa,EAAKvI,MAAMC,KAAK,qBAAsBkJ,MAAO,YACjD,QAAPmD,EAAe,CACf,IAAIL,EAASvD,EAAI1H,KAAKqE,KAAKkD,EAAKtK,QAAQuH,KAAK,GAAGnC,OAAOnD,OAAOjE,MAC9DsM,EAAK1D,QAAQkI,GAAS,EAAMd,GAO5B1D,EAAK/J,MAAMiH,aACPK,QAASyC,EAAK/J,MAAMsH,QACpBhF,SAAUyH,EAAK/J,MAAMuC,cACrBtC,OAAQ,SACRuE,GAAI+J,IAERxE,EAAK/J,MAAMiH,mBAGX8C,EAAKS,IAAIT,EAAK/J,OAMd+J,EAAK/J,MAAMiH,aACPK,QAASyC,EAAK/J,MAAMsH,QACpBhF,SAAUyH,EAAK/J,MAAMuC,cACrBtC,OAAQ,QAMyB,SAArC8J,EAAK/J,MAAME,YAAY,UACvBd,EAAYU,EAAQoK,EAAI1H,KAAKqE,KAAKpH,GAAQuH,KAAK,GAAGnC,OAAO/E,GAASrC,MAAMyM,EAAI1H,KAAK/C,EAAOD,GAExFP,EAASsP,EAASrE,EAAI1H,KAAKuH,EAAKtK,OAAOD,GAE3CO,EAAWgK,EAAK/J,YAvDhC4G,KA2DIlH,EAAS,aAAe,eAOpC2J,WAAa,YACT,EAAA5K,EAAAuL,OACIT,IAnvBM,yCAovBN/G,MAGId,OAAQqI,EAAK/J,MAAMa,KAAKwK,kBAAkBtB,EAAKtK,OAAQ,UAAUhC,MACjE+Q,aACIhK,GAAIuF,EAAK/J,MAAME,YAAY,MAC3BuO,GAAI1E,EAAK/J,MAAMa,KAAKwK,kBAAkBtB,EAAKtK,OAAQ,MAAMhC,SAGjEwM,QAAS,SAACC,GACN,GAAIA,EAAK,CACL,IAAI1F,EAAKuF,EAAK/J,MAAME,YAAY,MAO/CZ,EAAgBQ,EAAQ0E,EAAGhF,GACZuK,EAAK/J,MAAMmH,OAAO4C,EAAK/J,MAAMoH,SACzBE,QAASyC,EAAK/J,MAAMsH,QACpBhF,SAAUyH,EAAK/J,MAAMqH,cACrBpH,OAAQ,qBAQ5B4I,UAAY,SAAC7I,GACTA,EAAMK,UAAUqO,WAAW3E,EAAKrK,SAChCqK,EAAKa,kBAmDThC,aAAe,WAAM,IAEXb,EADWgC,EAAK/J,MAAhBO,OACAwH,gBACQgC,EAAK/J,MAAMO,OAAOsH,aACnBkC,EAAK/J,MAAME,YAAY,UACpC,OACI+H,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,4BACXuE,EAAAC,QAAAC,cAAA,OAAKzE,UAAU,oBACVqE,GACG1D,KAAM,mBAENE,cAAewF,EAAKzB,YAAYtK,KAAK+L,YAkH7D/I,GAAO,EAAAvC,EAAAkQ,aACHC,WACIC,SAAU,OACVvM,SA78BO,kBA88BPwM,SAAUrP,EACVsP,SAAUrP,IAEdyG,iBAPG,CASJnF,aAiBYA,mBCh/BfnF,EAAAD,QAAAO,yDCAAN,EAAAD,QAAAQ","file":"uapbd/sminfo/payment_base/card/index.a1983536.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"nc-lightapp-front\"), require(\"react\"), require(\"react-dom\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"nc-lightapp-front\", \"react\", \"react-dom\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"uapbd/sminfo/payment_base/card/index\"] = factory(require(\"nc-lightapp-front\"), require(\"react\"), require(\"react-dom\"));\n\telse\n\t\troot[\"uapbd/sminfo/payment_base/card/index\"] = factory(root[\"nc-lightapp-front\"], root[\"React\"], root[\"ReactDOM\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__1__, __WEBPACK_EXTERNAL_MODULE__2__, __WEBPACK_EXTERNAL_MODULE__3__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"../../../../\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 281);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__1__;","//主子表卡片\r\nimport React, { Component } from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { createPage, ajax, base, toast, cacheTools, cardCache, print, high, getBusinessInfo, deepClone, promptBox,getMultiLang } from 'nc-lightapp-front';\r\nconst { NCAffix, NCPopconfirm, NCFormControl, NCBackBtn } = base;\r\nconst { PrintOutput } = high;\r\n\r\nconst { addCache, getCacheById, updateCache, getCurrentLastId, getNextId, deleteCacheById } = cardCache;\r\nconst dataSource = 'uapbd.sminfo.payment.data'\r\n\r\nconst formId = 'payment';                      //表头id\r\nconst tableId = 'paymentch';                  //子表id\r\nconst pageId = '10140PAYMG_card';            //pagecode\r\n//const searchId = 'search';                  //查询区id\r\nconst appcode = '10140PAYMG';        //按钮注册id\r\nconst queryCardUrl = '/nccloud/uapbd/sminfo/PaymentCardQuery.do';   //卡片查询url\r\nconst saveUrl = '/nccloud/uapbd/sminfo/PaymentSave.do';             //新增保存\r\nconst updateUrl = '/nccloud/uapbd/sminfo/PaymentUpdate.do';         //修改保存\r\nconst deleteUrl = '/nccloud/uapbd/sminfo/PaymentDelete.do';         //删除\r\nconst qryUserInfoUrl = '/nccloud/uapbd/sminfo/PaymentLoginUserInfoQuery.do';//登录用户信息\r\nconst printUrl = '/nccloud/uapbd/sminfo/PaymentPrint.do';                  //卡片打印url\r\nconst validUrl = '/nccloud/uapbd/sminfo/PaymentValid.do';                   //权限校验\r\nconst pk_item = 'pk_payment';               //单据主键--用于卡片查询刷新\r\nconst titleCode = 'code';           //单据编码--用于卡片表头显示\r\n//const titleName = json['10140PAYMG-000000'];\t\t\t\t\t//节点名称/* 国际化处理： 付款协议-集团*/\r\n//const tableBtnAry = ['delline','detail','spread'];\t\t//表格列操作按钮\r\n\r\nlet tableBtnAry = (props) => {\r\n    return props.getUrlParam('status') === 'browse'\r\n        ? ['detail'] : ['insertline', 'delline'];\r\n    // ,'spread' 展开新增有问题，先隐藏\r\n}\r\n\r\n//\r\n// let initTemplate =(props)=>{\r\n//\r\n//\r\n// }\r\n\r\n\r\n\r\nfunction tableButtonClick(props, id, text, record, index) {\r\n\r\n    let allData = props.cardTable.getVisibleRows(tableId);\r\n    let value = {};\r\n    switch (id) {\r\n        case 'insertline'://插入行\r\n            allData.forEach(element => {\r\n                if (element.values['showorder'].value >= record.values['showorder'].value) {\r\n                    value = (parseInt(element.values['showorder'].value) + 1).toString()\r\n                    props.cardTable.setValByKeyAndRowId(tableId, element.rowid, 'showorder', { value: value })\r\n                }\r\n            })\r\n            props.cardTable.addRow(tableId, index, { 'showorder': { display: '', value: index + 1 + '' } }, false);\r\n            break;\r\n        case \"delline\"://删除行\r\n            allData.forEach(element => {\r\n                if (element.values['showorder'].value >= record.values['showorder'].value) {\r\n                    value = (parseInt(element.values['showorder'].value) - 1).toString()\r\n                    props.cardTable.setValByKeyAndRowId(tableId, element.rowid, 'showorder', { value: value })\r\n                }\r\n            })\r\n            props.cardTable.delRowsByIndex(tableId, index);\r\n            break;\r\n        case \"detail\"://更多\r\n            props.cardTable.toggleRowView(tableId, record);\r\n            break;\r\n        case \"spread\"://展开\r\n            props.cardTable.openModel(tableId, 'edit', record, index);\r\n            break;\r\n        default:\r\n            console.log(id, index);\r\n            break;\r\n    }\r\n}\r\n\r\n//切换页面状态\r\nfunction toggleShow(props) {\r\n    let status = props.getUrlParam('status');\r\n    let flag = status === 'browse' ? false : true;\r\n    //按钮的显示状态\r\n    if (status == 'add') {\r\n        //显示子表操作列\r\n        if (props.meta.getMeta()[tableId]) {\r\n            props.cardTable.showColByKey(tableId, 'opr');\r\n        }\r\n        props.button.setButtonVisible(['edit', 'add', 'back', 'delete', 'refresh', 'printGrp', 'print', 'output', 'detail'], false);\r\n        props.button.setButtonVisible(['save', 'saveAdd', 'cancel', 'addline', 'insertline', 'spread', 'delline'], true);\r\n        props.button.setButtonDisabled('saveAdd', false);\r\n        props.cardPagination.setCardPaginationVisible('cardPaginationBtn', false);\r\n    }\r\n    else if (status == 'edit') {\r\n        //显示子表操作列\r\n        if (props.meta.getMeta()[tableId]) {\r\n            props.cardTable.showColByKey(tableId, 'opr');\r\n        }\r\n        props.button.setButtonVisible(['edit', 'add', 'back', 'delete', 'refresh', 'printGrp', 'print', 'output', 'detail'], false);\r\n        props.button.setButtonVisible(['save', 'saveAdd', 'cancel', 'addline', 'insertline', 'delline', 'spread'], true);\r\n        props.button.setButtonDisabled('saveAdd', true);\r\n        props.cardPagination.setCardPaginationVisible('cardPaginationBtn', false);\r\n\r\n    } else {\r\n        //隐藏子表操作列\r\n        if (props.meta.getMeta()[tableId]) {\r\n            props.cardTable.hideColByKey(tableId, 'opr');\r\n        }\r\n        if(!props.getUrlParam('id')){\r\n            //列表为空新增时id未控制，取消后只保留新增按钮\r\n            props.button.setButtonVisible(['save', 'saveAdd', 'cancel', 'addline', 'insertline', 'delline', 'spread', 'print', 'back', 'edit', 'delete', 'refresh', 'printGrp', 'output', 'detail'], false);\r\n            props.button.setButtonVisible(['add'], true);\r\n            props.cardPagination.setCardPaginationVisible('cardPaginationBtn', false);\r\n        }else{\r\n            props.button.setButtonVisible(['save', 'saveAdd', 'cancel', 'addline', 'insertline', 'delline', 'spread', 'print', 'back'], false);\r\n            props.button.setButtonVisible(['add', 'edit', 'delete', 'refresh', 'printGrp', 'output', 'detail'], true);\r\n            props.cardPagination.setCardPaginationVisible('cardPaginationBtn', true);    \r\n        }\r\n\r\n    }\r\n    props.form.setFormStatus(formId, status);\r\n    props.cardTable.setStatus(tableId, status);\r\n};\r\n\r\nclass Card extends Component {\r\n\r\n    constructor(props) {\r\n        super(props);\r\n        this.formId = formId;\r\n        //this.searchId = searchId;\r\n        this.tableId = tableId;\r\n        this.state = {\r\n            json:{},\r\n            pk_org: '',\r\n            title_code: '',\r\n            context: {\r\n                nodeType: props.nodeType,\r\n                pk_org: '',\r\n                pk_org_v: '',\r\n                org_Name: '',\r\n                org_v_Name: '',\r\n                mdid: '',\r\n                PermissionOrgIDs: []\r\n            }\r\n        }\r\n        \r\n    }\r\n\r\n    initTemplate (props){\r\n        props.createUIDom(\r\n            {\r\n                pagecode: props.pagecode_card//,//页面id\r\n                // appid: props.appid//注册按钮的id\r\n            },\r\n            (data) => {\r\n                if (data) {\r\n                    let context = data.context;\r\n                    this.state.context = Object.assign(this.state.context, context);\r\n                    if (data.template) {\r\n                        let meta = data.template;\r\n                        this.modifierMeta(props, meta)\r\n                        props.meta.setMeta(meta, () => {\r\n                            //this.setDefaultValue();\r\n                        });\r\n                    }\r\n                    if (data.button) {\r\n                        let button = data.button;\r\n                        props.button.setButtons(button, () => {\r\n                            props.button.setPopContent('delline', this.state.json['10140PAYMG-000002']) /*国际化：确认要删除该信息吗？ 设置操作列上删除按钮的弹窗提示 */\r\n                        });\r\n                        toggleShow(props);\r\n                    }\r\n                }\r\n            }\r\n        )\r\n    }\r\n\r\n    //moved by wh 20181020 为了多语json对象能够饮用得到，由外部引入至类内部\r\n    modifierMeta(props, meta) {\r\n\r\n        let status = props.getUrlParam('status');\r\n        meta[formId].status = status;\r\n        meta[tableId].status = status;\r\n    \r\n        meta[formId].items.map((item) => {\r\n    \r\n            if (item.attrcode == 'pk_org') {\r\n    \r\n                if (props.nodeType == 'group') {\r\n                    item.disabled = 'false';\r\n                }\r\n                else {\r\n                    item.queryCondition = function () {\r\n                        return {\r\n                            AppCode: '10140PAYMO',\r\n                            TreeRefActionExt: 'nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder'\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        })\r\n    \r\n        let porCol = {\r\n            key: 'oprCol',\r\n            attrcode: 'opr',\r\n            label: this.state.json['10140PAYMG-000001'],/* 国际化处理： 操作*/\r\n            visible: true,\r\n            className: 'table-opr',\r\n            width: '200px',\r\n            itemtype: 'customer',\r\n            fixed: 'right',\r\n            render(text, record, index) {\r\n    \r\n                let btnArray = tableBtnAry(props);\r\n    \r\n                return props.button.createOprationButton(\r\n                    btnArray,\r\n                    {\r\n                        area: \"table-opr-area\",\r\n                        buttonLimit: 3,\r\n                        onButtonClick: (props, id) => tableButtonClick(props, id, text, record, index)\r\n                    }\r\n                )\r\n            }\r\n        };\r\n        meta[tableId].items.push(porCol);\r\n    \r\n        return meta;\r\n    }\r\n\r\n    componentDidMount() {\r\n        // toggleShow(this.props);\r\n        //add wh 20181020 多语引用的json文件\r\n        let callback = (json, status, inlt) => {\r\n\t\t\tif (status) {\r\n\t\t\t\tthis.setState({json, inlt},() => {\r\n\t\t\t\t\tthis.initTemplate(this.props)\r\n\t\t\t\t})       // 保存json和inlt到页面state中并刷新页面\r\n\t\t\t}\r\n        }\r\n        this.props.MultiInit.getMultiLang({moduleId: '10140PAYMG', domainName: 'uapbd',callback})\r\n\r\n        let status = this.props.getUrlParam('status');\r\n        if (status != \"add\") {\r\n            let pk = this.props.getUrlParam('id');\r\n            if (pk && pk != 'undefined') {\r\n                this.getdata(pk);\r\n            }\r\n        }\r\n        else {\r\n            this.setDefaultValue();\r\n        }\r\n    }\r\n\r\n    componentDidUpdate() {\r\n        let l_formstatus = this.props.form.getFormStatus(formId);\r\n        if (l_formstatus != 'add' && l_formstatus != \"edit\") {\r\n            window.onbeforeunload = null;\r\n        }\r\n        else {\r\n            window.onbeforeunload = () => {//编辑态关闭页签或浏览器的提示\r\n                return '';\r\n            };\r\n        }\r\n    }\r\n\r\n    componentWillReceiveProps() { }\r\n\r\n    setDefaultValue = () => {\r\n        //this.props.form.setFormItemsValue(this.formId,{'pk_org':{value: this.props.CacheTools.get(\"pk_org\"),display:'自由态'}});\r\n\r\n        // let businessInfo = getBusinessInfo();\r\n        // let pkGroup = businessInfo.groupId;\r\n        // let grpName = businessInfo.groupName;\r\n\r\n        if (this.props.nodeType == 'group') {\r\n            // this.props.form.setFormItemsValue(this.formId,{'pk_org':{value:pkGroup,display:grpName}});\r\n            ajax({\r\n                url: qryUserInfoUrl,\r\n                success: (res) => {\r\n                    this.props.form.setFormItemsValue(this.formId, {\r\n                        'pk_org':\r\n                        {\r\n                            value: res.data.group.pk_group,\r\n                            display: res.data.group.name\r\n                        }, 'effectdate':\r\n                        {\r\n                            value: res.data.effectDate,\r\n                            display: null\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        } else {\r\n            //此处暂且先仿照原作者去后台取登录用户集团信息并取form默认值，\r\n            //后续登录用户集团信息应从businessinfo里取，form默认值应再写个action\r\n            ajax({\r\n                url: qryUserInfoUrl,\r\n                success: (res) => {\r\n                    this.props.form.setFormItemsValue(this.formId, {\r\n                        'effectdate':\r\n                        {\r\n                            value: res.data.effectDate,\r\n                            display: null\r\n                        },\r\n                        'pk_org':\r\n                        {\r\n                            value: this.state.context.pk_org,\r\n                            display: this.state.context.org_Name\r\n                        }\r\n                    });\r\n                }\r\n            })\r\n        }\r\n    }\r\n\r\n    buttonClick = (props, id) => {\r\n\r\n        let _this = this;\r\n        switch (id) {\r\n            case 'add':\r\n                this.add(props);\r\n                // props.linkTo(props.cardUrl, {\r\n                //     appcode:props.appcode,\r\n                //     pagecode:props.pagecode_card,\r\n                //     status: 'add'\r\n                // })\r\n                props.setUrlParam({\r\n                    appcode: props.appcode,\r\n                    pagecode: props.pagecode_card,\r\n                    status: 'add'\r\n                })\r\n                toggleShow(this.props);\r\n                break\r\n            case 'edit':\r\n                this.valid(props,'edit', () => {\r\n                    // props.linkTo(props.cardUrl, {\r\n                    //     appcode:props.appcode,\r\n                    //     pagecode:props.pagecode_card,\r\n                    //     status: 'edit',\r\n                    //     id: props.getUrlParam('id')\r\n                    // });\r\n                    props.setUrlParam({\r\n                        appcode: props.appcode,\r\n                        pagecode: props.pagecode_card,\r\n                        status: 'edit',\r\n                        id: props.getUrlParam('id')\r\n                    })\r\n                    toggleShow(this.props);\r\n                })\r\n                break;\r\n            case 'delete':\r\n                this.valid(props,'delete', () => {\r\n                    promptBox({\r\n                        color: 'warning',\r\n                        title: this.state.json['10140PAYMG-000003'],/* 国际化处理： 确认删除*/\r\n                        content: this.state.json['10140PAYMG-000004'],/* 国际化处理： 确定要删除所选数据吗？*/\r\n                        beSureBtnClick: this.delConfirm.bind(this)\r\n                    })\r\n                });\r\n                break;\r\n            case 'back':\r\n                props.pushTo(props.listUrl, {\r\n                    appcode: props.appcode,\r\n                    pagecode: props.pagecode_list,\r\n                    status: 'browse'\r\n                })\r\n                break;\r\n            case 'save':\r\n                this.saveClick('save');\r\n                break;\r\n            case 'saveAdd':\r\n                this.saveClick('saveAdd');\r\n                break;\r\n            case 'cancel':\r\n                promptBox({\r\n                    color: \"warning\",\r\n                    title: this.state.json['10140PAYMG-000005'],/* 国际化处理： 取消*/\r\n                    content: this.state.json['10140PAYMG-000006'],/* 国际化处理： 确定取消吗？*/\r\n                    beSureBtnClick: () => {\r\n                        if (props.getUrlParam('status') === 'add') {\r\n                        //modified by wh 20181029    \r\n                        let pk = getCurrentLastId(dataSource);\r\n\t\t\t\t\t\t    this.getDataForCache(pk, () => { \r\n\t\t\t\t\t\t         props.form.cancel(this.formId);\r\n\t\t\t\t\t\t         props.cardTable.resetTableData(this.tableId);\r\n\t\t\t\t\t\t         props.setUrlParam({\r\n    \t\t\t\t\t\t\tstatus: 'browse',\r\n\t\t\t\t\t    \t\tid: props.getUrlParam('id'),\r\n\t\t\t\t\t\t    \tappcode:props.appcode,\r\n\t\t\t\t\t\t    \tpagecode:props.pagecode_card\r\n\t\t\t\t\t\t    })\r\n\t\t\t\t\t\t    // toggleShow(this.props);\r\n\t\t\t\t\t\t})\r\n                            // if (cacheTools.get(\"preid\")) {\r\n                            //     props.form.cancel(this.formId);\r\n                            //     props.cardTable.resetTableData(this.tableId);\r\n                            //     // props.linkTo(props.cardUrl, {\r\n                            //     //     appcode:props.appcode,\r\n                            //     //     pagecode:props.pagecode_card,\r\n                            //     //     status: 'browse',\r\n                            //     //     id: cacheTools.get(\"preid\")\r\n                            //     // })\r\n                            //     props.setUrlParam({\r\n                            //         appcode: props.appcode,\r\n                            //         pagecode: props.pagecode_card,\r\n                            //         status: 'browse',\r\n                            //         id: cacheTools.get(\"preid\")\r\n                            //     })\r\n                            //     toggleShow(this.props);\r\n                            // } else {\r\n                            //     props.pushTo(props.listUrl, {\r\n                            //         appcode: props.appcode,\r\n                            //         pagecode: props.pagecode_list,\r\n                            //         status: 'browse'\r\n                            //     })\r\n                            // }\r\n                        }\r\n                        if ((props.getUrlParam('status') === 'edit')) {\r\n                            props.form.cancel(this.formId);\r\n                            props.cardTable.resetTableData(this.tableId);\r\n                            // props.linkTo(props.cardUrl, {\r\n                            //     appcode:props.appcode,\r\n                            //     pagecode:props.pagecode_card,\r\n                            //     status: 'browse',\r\n                            //     id: props.getUrlParam('id')\r\n                            // })\r\n                            props.setUrlParam({\r\n                                appcode: props.appcode,\r\n                                pagecode: props.pagecode_card,\r\n                                status: 'browse',\r\n                                id: props.getUrlParam('id')\r\n                            })\r\n                        }\r\n                        toggleShow(this.props);\r\n                    }\r\n                });\r\n                break\r\n            case 'addline':\r\n                let rowNum = props.cardTable.getNumberOfRows(this.tableId);\r\n                props.cardTable.addRow(this.tableId, rowNum, { 'showorder': { display: '', value: rowNum + 1 + '' } }, false);\r\n                break\r\n            case 'refresh':\r\n                // props.linkTo(props.cardUrl, {\r\n                //     appcode:props.appcode,\r\n                //     pagecode:props.pagecode_card,\r\n                //     status:props.getUrlParam('status'),\r\n                //     id:props.getUrlParam('id')\r\n                // })\r\n                props.setUrlParam({\r\n                    appcode: props.appcode,\r\n                    pagecode: props.pagecode_card,\r\n                    status: props.getUrlParam('status'),\r\n                    id: props.getUrlParam('id')\r\n                })\r\n                toggleShow(this.props);\r\n                this.getdata(props.getUrlParam('id'), true);\r\n                break\r\n            case 'printGrp':\r\n                this.onPrint();\r\n                break;\r\n            case 'print':\r\n                this.onPrint();\r\n                break;\r\n            case 'output':\r\n                this.onOutput();\r\n                break;\r\n            default:\r\n                break\r\n        }\r\n    }\r\n\r\n    add = (props) => {\r\n        let pk_org = deepClone(props.form.getFormItemsValue(this.formId, 'pk_org'));\r\n        // Utils.clone(props.form.getFormItemsValue(this.formId,'pk_org'));\r\n        props.form.EmptyAllFormValue(this.formId)\r\n        props.cardTable.setTableData(this.tableId, { rows: [] })\r\n        // props.linkTo(props.cardUrl, {\r\n        //     appcode:props.appcode,\r\n        //     pagecode:props.pagecode_card,\r\n        //     status: 'add'\r\n        // })\r\n        props.setUrlParam({\r\n            appcode: props.appcode,\r\n            pagecode: props.pagecode_card,\r\n            status: 'add'\r\n        })\r\n        let businessInfo = getBusinessInfo();\r\n        let date = null;\r\n        let grpId = null;\r\n        let grpName = null;\r\n\r\n        if (businessInfo) {\r\n            date = businessInfo.businessDate;\r\n            grpId = businessInfo.groupId;\r\n            grpName = businessInfo.groupName;\r\n        }\r\n\r\n        //组织节点不能赋值集团\r\n        if (props.nodeType == 'org' && pk_org.value == grpId) {\r\n            pk_org = { value: '', display: '' };\r\n        }\r\n        //集团一定是集团\r\n        if (props.nodeType == 'group' && pk_org != grpId) {\r\n            pk_org = { value: grpId, display: grpName };\r\n        }\r\n        props.form.setFormItemsValue(this.formId, { 'pk_org': { value: pk_org.value, display: pk_org.display } });\r\n        props.form.setFormItemsValue(this.formId, { 'effectdate': { value: date, display: date } });\r\n    }\r\n\r\n    valid = (props,operateCode='', callback) => {\r\n        let data = {\r\n            pks: [props.form.getFormItemsValue(formId, pk_item).value],\r\n            nodeType: props.nodeType,\r\n            mdOperateCode:operateCode\r\n        }\r\n        ajax({\r\n            url: validUrl,\r\n            data,\r\n            success: (res) => {\r\n                callback && callback();\r\n            }\r\n        })\r\n    }\r\n    //打印\r\n    onPrint = () => {\r\n\r\n        let allData = this.props.form.getAllFormValue(formId);\r\n\r\n        if (allData.length === 0) {\r\n            toast({ content: this.state.json['10140PAYMG-000007'], color: 'warning' });/* 国际化处理： 无可打印数据*/\r\n            return;\r\n        }\r\n\r\n        let pks = [];\r\n\r\n        allData.rows.forEach((item, key) => {\r\n            pks.push(item.values[pk_item].value);\r\n        });\r\n        print(\r\n            'pdf',\r\n            printUrl,\r\n            {\r\n                appcode: this.props.appcode,\r\n                funcode: this.props.printFunCode,//小应用编码\r\n                nodekey: this.props.printNodeKey,//模板节点编码\r\n                oids: pks\r\n            }\r\n        )\r\n    }\r\n    //输出\r\n    onOutput = () => {\r\n\r\n        let allData = this.props.form.getAllFormValue(formId);\r\n        if (allData.length === 0) {\r\n            toast({ content: this.state.json['10140PAYMG-000008'], color: 'warning' });/* 国际化处理： 无可输出的数据*/\r\n            return;\r\n        }\r\n        let pks = [];\r\n\r\n        allData.rows.forEach((item, key) => {\r\n            pks.push(item.values[pk_item].value);\r\n        });\r\n        this.setState({\r\n            ids: pks\r\n        }, this.refs.printOutput.open());\r\n    }\r\n\r\n    pageInfoClick = (props, pk) => {\r\n\r\n        let data = {\r\n            'pk_org': cacheTools.get('pk_org'),\r\n            'pk': pk,\r\n            'pageid': props.pagecode_card\r\n        };\r\n        ajax({\r\n            url: queryCardUrl,\r\n            data: data,\r\n            success: (res) => {\r\n                if (res.data.head) {\r\n\r\n                    props.form.setAllFormValue({ [formId]: res.data.head[formId] });\r\n                    props.setUrlParam(pk)//动态修改地址栏中的id的值\r\n                }\r\n                if (res.data.body) {\r\n                    props.cardTable.setTableData(tableId, res.data.body[tableId]);\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    afterEvent = (props, moduleId, key, value, changedrows, i, s, g) => { }\r\n\r\n    tableAfterEvent = (props, moduleId, key, value, changedrows, index, record, type) => {\r\n        if (key == 'paymentday' && value && value != null && value != '') {\r\n            props.cardTable.setValByKeyAndIndex(moduleId, index, 'accountday', { value: null, display: null })\r\n            props.cardTable.setValByKeyAndIndex(moduleId, index, 'checkdata', { value: null, display: null })\r\n            props.cardTable.setValByKeyAndIndex(moduleId, index, 'effectmonth', { value: null, display: null })\r\n            props.cardTable.setValByKeyAndIndex(moduleId, index, 'effectaddmonth', { value: null, display: null })\r\n        }\r\n        if (key == 'checkdata' && value && value != null && value != '') {\r\n            props.cardTable.setValByKeyAndIndex(moduleId, index, 'paymentday', { value: null, display: null })\r\n            if (changedrows[0].newvalue.value != changedrows[0].oldvalue.value) {\r\n                props.cardTable.setValByKeyAndIndex(moduleId, index, 'accountday', { value: null, display: null })\r\n                props.cardTable.setValByKeyAndIndex(moduleId, index, 'effectmonth', { value: '0', display: this.state.json['10140PAYMG-000009'] })/* 国际化处理： 当月生效*/\r\n                props.cardTable.setValByKeyAndIndex(moduleId, index, 'effectaddmonth', { value: '0', display: '0' })\r\n            }\r\n        }\r\n    }\r\n\r\n    tableBeforeEvent = (props, moduleId, key, value, index, record, s, line, model) => {\r\n\r\n        let status = props.getUrlParam('status');\r\n\r\n        let meta = props.meta.getMeta()\r\n\r\n        if (status != 'browse' && ['accountday', 'effectmonth', 'effectaddmonth'].includes(key)) {\r\n\r\n            let checkdata = props.cardTable.getValByKeyAndIndex(moduleId, index, 'checkdata');\r\n\r\n            if (!checkdata || checkdata.value == null || checkdata.value == '') {\r\n                toast({ content: this.state.json['10140PAYMG-000010'], color: 'danger' });/* 国际化处理： 请先填写固定结账日！*/\r\n                return false;\r\n            }\r\n        }\r\n\r\n        //付款时点参照pk_org过滤pk_payperiod\r\n        if(key == 'pk_payperiod'){\r\n            let pk_payperiod = meta[moduleId].items.find((item) => item.attrcode == 'pk_payperiod');\r\n            pk_payperiod.queryCondition = function () {\r\n                return {\r\n                    pk_org:props.form.getFormItemsValue(formId,'pk_org').value\r\n                }\r\n            }\r\n        }\r\n        //现金折扣参照pk_org过滤pk_rate\r\n        if(key == 'pk_rate'){\r\n            let pk_rate = meta[moduleId].items.find((item) => item.attrcode == 'pk_rate');\r\n            pk_rate.queryCondition = function () {\r\n                return {\r\n                    pk_org:props.form.getFormItemsValue(formId,'pk_org').value\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n        return true;\r\n    }\r\n\r\n    //通过单据id查询单据信息\r\n    getdata = (pk, isRefresh,pk_org_c = null) => {\r\n        let data = {\r\n            pk,\r\n            pk_org: pk_org_c == null? cacheTools.get('pk_org'):pk_org_c\r\n        };\r\n        ajax({\r\n            url: queryCardUrl,\r\n            data,\r\n            success: (res) => {\r\n                if (res.data.head) {\r\n                    this.props.form.setAllFormValue({ [this.formId]: res.data.head[this.formId] });\r\n                    let title_code = res.data.head[this.formId].rows[0].values[titleCode].value;\r\n                    this.setState({ title_code });\r\n                }\r\n                if (res.data.body) {\r\n                    this.props.cardTable.setTableData(this.tableId, res.data.body[this.tableId]);\r\n                }\r\n\r\n                //查询时执行显示公式前端适配\r\n                if (res.formulamsg && res.formulamsg instanceof Array && res.formulamsg.length > 0) {\r\n                    this.props.dealFormulamsg(\r\n                        res.formulamsg,  //参数一：返回的公式对象\r\n                        {                //参数二：界面使用的表格类型\r\n                            [this.tableId]:\"table\",\r\n                            [this.formId]:\"form\"\r\n                        }\r\n                    );\r\n                }\r\n\r\n                if (isRefresh) {\r\n                    toast({ content: this.state.json['10140PAYMG-000011'], color: 'success' });/* 国际化处理： 刷新成功*/\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    //保存单据\r\n    saveClick = (btn) => {\r\n        if (!this.props.cardTable.getAllRows(tableId)) {\r\n            toast({ content: this.state.json['10140PAYMG-000012'], color: 'danger' });/* 国际化处理： 账期不能为空*/\r\n        }\r\n        setTimeout(() => {\r\n            debugger\r\n            //var a = this.props.cardTable.checkTableRequired(tableId)\r\n        }, 0)\r\n        // 必填校验\r\n        if (this.props.form.isCheckNow(formId) && this.props.cardTable.checkTableRequired(tableId)) {\r\n            this.props.cardTable.filterEmptyRows(tableId);\r\n            let CardData = this.props.createMasterChildData(this.props.pagecode_card, this.formId, this.tableId);\r\n            // CardData.head.head.rows[0].values.bill_code = _this.state.bill_code;\r\n            let url = saveUrl;//新增保存\r\n            if (this.props.getUrlParam('status') === 'edit') {\r\n                url = updateUrl;//修改保存\r\n            }\r\n\r\n            //适配保存校验公式\r\n            this.props.validateToSave( CardData , ()=>{\r\n                ajax({\r\n                    url: url,\r\n                    data: CardData,\r\n                    success: (res) => {\r\n                        let pk_value = null\r\n                        if (res.success) {\r\n                            if (res.data) {\r\n                                if (res.data.head && res.data.head[this.formId]) {\r\n                                    this.props.form.setAllFormValue({ [this.formId]: res.data.head[this.formId] });\r\n                                    pk_value = res.data.head[this.formId].rows[0].values[pk_item].value\r\n                                }\r\n                                if (res.data.body && res.data.body[this.tableId]) {\r\n                                    this.props.cardTable.setTableData(this.tableId, res.data.body[this.tableId])\r\n                                }\r\n                            }\r\n                            toast({ title: this.state.json['10140PAYMG-000013'], color: 'success' });/* 国际化处理： 保存成功*/\r\n                            if (btn == 'save') {\r\n                                let pk_org_c=res.data.head[this.formId].rows[0].values.pk_org.value\r\n                                this.getdata(pk_value,false,pk_org_c);\r\n                                // this.props.linkTo(this.props.cardUrl, {\r\n                                //     appcode: this.props.appcode,\r\n                                //     pagecode: this.props.pagecode_card,\r\n                                //     status: 'browse',\r\n                                //     id: pk_value\r\n                                // })\r\n                                this.props.setUrlParam({\r\n                                    appcode: this.props.appcode,\r\n                                    pagecode: this.props.pagecode_card,\r\n                                    status: 'browse',\r\n                                    id: pk_value\r\n                                })\r\n                                this.props.setUrlParam();\r\n                            } else {\r\n                                //保存新增\r\n                                this.add(this.props);\r\n                                // this.props.linkTo(this.props.cardUrl, {\r\n                                //     appcode: this.props.appcode,\r\n                                //     pagecode: this.props.pagecode_card,\r\n                                //     status: 'add'\r\n                                // })\r\n                                this.props.setUrlParam({\r\n                                    appcode: this.props.appcode,\r\n                                    pagecode: this.props.pagecode_card,\r\n                                    status: 'add'\r\n                                })\r\n                                //addCache(pk_value,res.data,this.formId,dataSource);\r\n                            }\r\n    \r\n                            //修改保存\r\n                            if (this.props.getUrlParam('status') === 'edit') {\r\n                                updateCache(pk_item,res.data.head[formId].rows[0].values[pk_item].value,res.data,formId,dataSource);\r\n                            }else{//新增保存\r\n                                addCache(pk_value,res.data,this.formId,dataSource);\r\n                            }\r\n                            toggleShow(this.props)\r\n                        }\r\n                    }\r\n                })\r\n            },{[tableId]:'cardTable'} , 'card' )\r\n\r\n            \r\n        }\r\n    }\r\n\r\n    //删除单据\r\n    delConfirm = () => {\r\n        ajax({\r\n            url: deleteUrl,\r\n            data: {\r\n                //列表新增保存，pk_org 没有缓存，修改成从卡片页面获取。\r\n                // 不修改缓存的原因是列表页面的pk_org 可能是数组，修改完后列表删除会有问题\r\n                pk_org: this.props.form.getFormItemsValue(this.formId, 'pk_org').value,\r\n                deleteinfo: [{\r\n                    id: this.props.getUrlParam('id'),\r\n                    ts: this.props.form.getFormItemsValue(this.formId, 'ts').value\r\n                }]\r\n            },\r\n            success: (res) => {\r\n                if (res) {\r\n                    let id = this.props.getUrlParam(\"id\");\r\n                    //调用删除缓存数据方法\r\n\t\t\t\t\t/*\r\n\t\t\t\t\t* idname: 数据主键的命名\r\n\t\t\t\t\t* id：数据主键的值\r\n\t\t\t\t\t* dataSource: 缓存数据命名空间\r\n\t\t\t\t\t*/\r\n\t\t\t\t\tdeleteCacheById(pk_item,id,dataSource);\r\n                    this.props.pushTo(this.props.listUrl, {\r\n                        appcode: this.props.appcode,\r\n                        pagecode: this.props.pagecode_list,\r\n                        status: 'browse'\r\n                    });\r\n                }\r\n\r\n            }\r\n        });\r\n    };\r\n\r\n    modelSave = (props) => {\r\n        props.cardTable.closeModel(this.tableId);\r\n        this.saveClick();\r\n    }\r\n\r\n    // getButtonNames = (codeId) => {\r\n    //     if (codeId === 'edit'||codeId === 'add'||codeId === 'save'){\r\n    //         return 'main-button'\r\n    //     }else {\r\n    //         return 'secondary - button'\r\n    //     }\r\n    // };\r\n\r\n    //从缓存获取信息\r\n    //added by wh 20181030\r\n    getDataForCache(pk, callback) {\r\n\t\tif(!pk) {\r\n\t\t\tthis.props.form.EmptyAllFormValue(this.formId)\r\n            this.props.cardTable.setTableData(this.tableId, {rows: []})\r\n            // this.props.pushTo('/list', {})\r\n\t\t\t// return\r\n        }\r\n        else{\r\n            let cardData = getCacheById(pk, dataSource);\r\n            if(cardData) {\r\n                this.props.form.setAllFormValue({ [formId]:cardData.head[formId] });\r\n                if(cardData.body && cardData.body[tableId]) {\r\n                    this.props.cardTable.setTableData(tableId, cardData.body[tableId]);\r\n                }\r\n                else {\r\n                    this.props.cardTable.setTableData(tableId, {rows: []})\r\n                }\r\n                this.props.setUrlParam(pk)//动态修改地址栏中的id的值\r\n            }\r\n            else {\r\n                this.getdata(pk)\r\n                this.props.setUrlParam(pk)//动态修改地址栏中的id的值\r\n            }\r\n        }\r\n\t\t\r\n\t\tif(callback && typeof callback == 'function') {\r\n\t\t\tcallback.call(this)\r\n\t\t}\r\n\r\n\t\t//将更新按钮状态的调用延后到callback之后，否则新增取消的时候显示的还是编辑态的按钮\r\n\t\t// if(cardData) {\r\n        //     //note by wh 20181212\r\n        //     //let enableState = cardData.head[formId].rows[0].values.enablestate.value\r\n\t\t// \ttoggleShow(this.props)\r\n\t\t// }\r\n\t}\r\n\r\n    //获取列表肩部信息\r\n    getTableHead = () => {\r\n        let { button } = this.props;\r\n        let { createButtonApp } = button;\r\n        let buttons = this.props.button.getButtons();\r\n        let status = this.props.getUrlParam(\"status\");\r\n        return (\r\n            <div className=\"shoulder-definition-area\">\r\n                <div className=\"definition-icons\">\r\n                    {createButtonApp({\r\n                        area: 'definition-icons',//按钮注册中的按钮区域\r\n                        //buttonLimit: 5,\r\n                        onButtonClick: this.buttonClick.bind(this)\r\n                        //popContainer: document.querySelector('.header-button-area')\r\n                    })}\r\n                    {/* {this.props.cardTable.createBrowseIcons(this.tableId, {\r\n                        iconArr: ['close', 'open', 'max','setCol'],\r\n                        maxDestAreaId: 'nc-bill-card'\r\n                    })} */}\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    /**\r\n     * 返回按钮操作\r\n     */\r\n    onReturnClick() {\r\n        this.props.pushTo(this.props.listUrl, {\r\n            pagecode: this.props.pagecode_list,\r\n            appcode: this.props.appcode,\r\n            status: 'browse'\r\n        })\r\n    }\r\n\r\n    render() {\r\n        let { cardTable, form, button, modal, cardPagination,BillHeadInfo } = this.props;\r\n        const { createCardPagination } = cardPagination;\r\n        const {createBillHeadInfo} = BillHeadInfo;\r\n        let buttons = this.props.button.getButtons();\r\n        // buttons = buttons.sort((a,b)=>{\r\n        //     return b.btnorder - a.btnorder;\r\n        // });\r\n        let { createForm } = form;\r\n        let { createCardTable } = cardTable;\r\n        let { createButtonApp } = button;\r\n        let { createModal } = modal;\r\n        let status = this.props.getUrlParam('status');\r\n        return (\r\n            <div id='nc-bill-card'>\r\n                <div className='nc-bill-card'>\r\n                    <div className=\"nc-bill-top-area\">\r\n                        <NCAffix>\r\n                            <div className='nc-bill-header-area'>\r\n                                {/* <div>\r\n                                    {status == 'browse' ? <NCBackBtn onClick={this.onReturnClick.bind(this)}></NCBackBtn> : ''}\r\n                                </div> */}\r\n                                <div className='header-title-search-area'>\r\n                                    {createBillHeadInfo({\r\n                                            backBtnClick: this.onReturnClick.bind(this)\r\n                                        }\r\n                                    )}\r\n                                    <h2 className='title-search-detail'>{/*modified by wh 20181020 为了适应多语工具的回写功能把nodeName移动至此*/this.props.nodeType == 'group'? this.state.json['10140PAYMG-000000'] : this.state.json['10140PAYMG-000014']}{status == 'browse' ? `：${this.state.title_code}` : ''}</h2>\r\n                                </div>\r\n                                <div className=\"header-button-area\">\r\n                                    {createButtonApp({\r\n                                        area: 'header-button-area',//按钮注册中的按钮区域\r\n                                        onButtonClick: this.buttonClick.bind(this)\r\n                                    })}\r\n                                    {createCardPagination({\r\n                                        handlePageInfoChange: this.pageInfoClick.bind(this),\r\n                                        dataSource: dataSource\r\n                                    })}\r\n                                </div>\r\n                            </div>\r\n                        </NCAffix>\r\n                        <div className=\"nc-bill-form-area\">\r\n                            {createForm(this.formId, {\r\n                                onAfterEvent: this.afterEvent.bind(this)\r\n                            })}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"nc-bill-bottom-area\">\r\n                        <div className=\"nc-bill-table-area\">\r\n                            {createCardTable(this.tableId, {\r\n                                tableHead: this.getTableHead.bind(this),\r\n                                modelSave: this.modelSave.bind(this),\r\n                                showIndex: true,\r\n                                onAfterEvent: this.tableAfterEvent.bind(this),\r\n                                onBeforeEvent: this.tableBeforeEvent.bind(this)\r\n                            })}\r\n                        </div>\r\n                        {createModal('delete', {\r\n                            title: this.state.json['10140PAYMG-000015'],/* 国际化处理： 注意*/\r\n                            content: this.state.json['10140PAYMG-000016'],/* 国际化处理： 确认删除？*/\r\n                            beSureBtnClick: this.delConfirm.bind(this)\r\n                        })}\r\n                        {/* 删除前确认模态框 */}\r\n                        {createModal('modal', {\r\n                            title: this.state.json['10140PAYMG-000003'],\t\t\t\t\t\t\t\t\t\t//标题/* 国际化处理： 确认删除*/\r\n                            content: this.state.json['10140PAYMG-000017'],\t\t\t\t\t\t\t//内容/* 国际化处理： 确认删除所选数据？*/\r\n                            // beSureBtnClick : ()=>{\r\n                            //     console.log('aaaaaaa')\r\n                            // },\t\t//确定按钮事件回调\r\n                            //cancelBtnClick : this.closeDelModal.bind(this),\t\t\t//取消按钮事件回调\r\n                            // leftBtnName : '确认',   \t\t\t\t\t\t\t\t//左侧按钮名称\r\n                            // rightBtnName : '关闭'   \t\t\t\t\t\t\t\t//右侧按钮名称\r\n                        })}\r\n                        <PrintOutput\r\n                            ref='printOutput'\r\n                            url={printUrl}\r\n                            data={{\r\n                                appcode: this.props.appcode,\r\n                                funcode: this.props.printFunCode,//小应用编码\r\n                                nodekey: this.props.printNodeKey,//模板节点编码\r\n                                oids: this.state.ids,\r\n                                outputType: 'output'\r\n                            }}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nCard = createPage({\r\n    billinfo:[{\r\n        billtype: 'card',\r\n        pagecode: pageId,\r\n        headcode: formId,\r\n        bodycode: tableId\r\n    }],\r\n    initTemplate: [],\r\n    //mutiLangCode: '10140PAYMG'\r\n})(Card);\r\n\r\n\r\n// ajav({\r\n\r\n// \tsuccess: function(temp){\r\n// \t\tvar temp0 = temp;\r\n// \t\tCard = createPage({\r\n// \t\t\tinitTemplate: function(){\r\n// \t\t\t\treturn temp0;\r\n// \t\t\t}\r\n// \t\t})(Card);\r\n// \t}\r\n// })\r\n\r\n// ReactDOM.render(<Card />, document.querySelector('#app'));\r\n\r\nexport default Card;\r\n","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","module.exports = __WEBPACK_EXTERNAL_MODULE__3__;"],"sourceRoot":""}