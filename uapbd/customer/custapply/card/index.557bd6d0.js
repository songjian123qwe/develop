!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/customer/custapply/card/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/customer/custapply/card/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,function(e,t,a){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,a),r.l=!0,r.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=261)}({1:function(t,a){t.exports=e},131:function(e,t){e.exports=a},148:function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var a=t.protocol+"//"+t.host,n=a+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var r,o=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?e:(r=0===o.indexOf("//")?o:0===o.indexOf("/")?a+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(r)+")")})}},2:function(e,a){e.exports=t},233:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(2),o=l(r),s=l(a(234)),i=l(a(235));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.type=a.props.data.flow_type,console.log("display",a.props.display,e.data),a.state={showModal:a.props.display,data:a.props.data},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({data:e.data,showModal:e.display})}},{key:"render",value:function(){return"workflow"==this.type?o.default.createElement(i.default,{title:this.props.title||"选择下游环节",getResult:this.props.getResult,data:this.state.data,cancel:this.props.cancel,hideNote:this.props.hideNote,display:this.state.showModal}):o.default.createElement(s.default,{title:this.props.title||"指派",data:this.state.data,getResult:this.props.getResult,cancel:this.props.cancel,display:this.state.showModal})}}]),t}();t.default=u},234:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r),s=a(1);var i=s.base.NCModal,l=s.base.NCTransfer,u=s.base.NCSelect,c=s.base.NCButton,p=(u.NCOption,function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),n=a.props.data.content?a.props.data.content:[];console.log("data",n);var r,o=[];return a.mapSource={},a.result={},n.forEach(function(e,t){o[o.length]={key:e.desc,value:e.activitydefid},a.mapSource[e.activitydefid]=e.uservos.map(function(t){return{key:e.activitydefid+"_"+t.userpk,title:t.username}})}),r=a.mapSource[o[0].value],console.log("sourceKeys",r),a.state={showModal:a.props.display,selectDataSource:o,source:r,target:[],currenttab:o.length>0?o[0].value:""},a.cancel=a.cancel.bind(a),a.confirm=a.confirm.bind(a),a.handleSelectChange=a.handleSelectChange.bind(a),a.handleTransferChange=a.handleTransferChange.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentWillReceiveProps",value:function(e){var t=this,a=e.data.content?e.data.content:[];console.log("data_async",a);var n,r=[];this.mapSource={},this.result={},a.forEach(function(e,a){r[r.length]={key:e.desc,value:e.activitydefid},t.mapSource[e.activitydefid]=e.uservos.map(function(t){return{key:e.activitydefid+"_"+t.userpk,title:t.username}})}),n=this.mapSource[r[0].value],console.log("sourceKeys_async",n),this.state={showModal:e.display,selectDataSource:r,source:n,target:[],currenttab:r.length>0?r[0].value:""}}},{key:"confirm",value:function(){var e=this;console.log("confirm",this.result),0!=this.state.target.length?(this.props.data.content.forEach(function(t){e.result[t.activitydefid]||(t.uservos=[]),t.uservos=t.uservos.filter(function(a){return e.result[t.activitydefid].includes(t.activitydefid+"_"+a.userpk)})}),this.props.getResult(this.props.data)):(0,s.toast)({title:"没有为活动指派参与者!",color:"warning"})}},{key:"cancel",value:function(){console.log("cancel"),this.props.cancel()}},{key:"handleSelectChange",value:function(e){console.log("change",e,this.mapSource),this.setState({source:this.mapSource[e],currenttab:e})}},{key:"handleTransferChange",value:function(e,t,a){var n=this;console.log(e,t,a,this.state.source),this.result[this.state.currenttab]||(this.result[this.state.currenttab]=[]),"right"==t?a.forEach(function(e){e.indexOf(n.state.currenttab)>-1&&n.result[n.state.currenttab].push(e)}):"left"==t&&a.forEach(function(e){if(e.indexOf(n.state.currenttab)>-1){var t=n.result[n.state.currenttab].indexOf(e);n.result[n.state.currenttab].splice(t,1)}}),this.setState({target:e})}},{key:"render",value:function(){console.log("render_source",this.state.source);var e=this.state.selectDataSource,t=e.map(function(e){return o.default.createElement(u.NCOption,{value:e.value},e.key)}),a=e.length>0?e[0].value:"";return o.default.createElement("div",null,o.default.createElement(i,{show:this.state.showModal},o.default.createElement(i.Header,null,o.default.createElement(i.Title,null,this.props.title)),o.default.createElement(i.Body,null,o.default.createElement("div",{style:{margin:"0 auto",display:"table",width:"82%"}},o.default.createElement(u,{style:{width:"100%"},defaultValue:a,onChange:this.handleSelectChange},t)),o.default.createElement("div",{style:{margin:"0 auto",marginTop:"10px",display:"table"}},o.default.createElement(l,{lazy:{container:"modal"},listStyle:{width:200,height:250},notFoundContent:"",dataSource:this.state.source,onChange:this.handleTransferChange,targetKeys:this.state.target,render:function(e){return e.title}}))),o.default.createElement(i.Footer,null,o.default.createElement(c,{onClick:this.confirm,colors:"primary"},"确定"),o.default.createElement(c,{onClick:this.cancel,style:{marginRight:50}},"取消"))))}}]),t}());t.default=p},235:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r),s=a(1);a(236);var i=s.base.NCModal,l=s.base.NCTransfer,u=s.base.NCMenu,c=s.base.NCCheckbox,p=s.base.NCButton,d=s.base.NCTextArea,f=u.NCSubMenu,m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.menuData=[],a.initTransferData=[],a.mapTransfer={},a.usersResult={},a.defaultSelectedKeys,a.falseMap={},a.prepareData(e.data.content),a.isMultiSelect=a.props.data.muplityWithOutAssgin;var n=a;return a.state={showModal:a.props.display,source:a.initTransferData,currentMenu:a.defaultSelectedKeys,target:[],textValue:"",mapCheck:function(t){return Object.keys(n.mapTransfer).map(function(a,n){t[a]=e.data.content[n].isChoice||!1}),t}({})},a.handleTransferChange=a.handleTransferChange.bind(a),a.handleCheckboxChange=a.handleCheckboxChange.bind(a),a.handleMenuClick=a.handleMenuClick.bind(a),a.confirm=a.confirm.bind(a),a.cancel=a.cancel.bind(a),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"prepareData",value:function(e){var t=this;e.forEach(function(e,a){t.falseMap[e.selectpath]=!1,t.menuData[t.menuData.length]={name:e.desc,id:e.selectpath},e.isAssgin?t.mapTransfer[e.selectpath]=e.assginUsers.map(function(t){return{title:t.name,code:t.code,key:e.selectpath+"_"+t.pk}}):t.mapTransfer[e.selectpath]=[]});var a=Object.keys(t.mapTransfer)[0];t.initTransferData=t.mapTransfer[a],t.defaultSelectedKeys=a}},{key:"componentWillReceiveProps",value:function(e){this.menuData=[],this.initTransferData=[],this.mapTransfer={},this.usersResult={},this.falseMap={},this.isMultiSelect=e.data.muplityWithOutAssgin,this.prepareData(e.data.content);var t=this;this.state={showModal:e.display,source:this.initTransferData,currentMenu:this.defaultSelectedKeys,target:[],mapCheck:function(a){return Object.keys(t.mapTransfer).map(function(t,n){a[t]=e.data.content[n].isChoice||!1}),a}({})}}},{key:"handleCheckboxChange",value:function(e){var t={};t[e]=!this.state.mapCheck[e],this.setState({mapCheck:this.isMultiSelect?Object.assign({},this.state.mapCheck,t):Object.assign({},this.falseMap,t)})}},{key:"handleTransferChange",value:function(e,t,a){var n=this;this.usersResult[this.state.currentMenu]||(this.usersResult[this.state.currentMenu]=[]),"right"==t?a.forEach(function(e){e.indexOf(n.state.currentMenu)>-1&&n.usersResult[n.state.currentMenu].push(e)}):"left"==t&&a.forEach(function(e){if(e.indexOf(n.state.currentMenu)>-1){var t=n.usersResult[n.state.currentMenu].indexOf(e);n.usersResult[n.state.currentMenu].splice(t,1)}}),this.setState({target:e})}},{key:"handleMenuClick",value:function(e){this.setState({currentMenu:e.key,source:this.mapTransfer[e.key]})}},{key:"confirm",value:function(){var e=this;this.props.data.content.forEach(function(t){t.isChoice=e.state.mapCheck[t.selectpath],t.isAssgin&&(e.usersResult[t.selectpath]||(t.assginUsers=[]),t.assginUsers=t.assginUsers.filter(function(a){return e.usersResult[t.selectpath].includes(t.selectpath+"_"+a.pk)}))}),this.props.getResult(this.props.data,this.state.textValue)}},{key:"cancel",value:function(){this.props.cancel()}},{key:"render",value:function(){var e=this,t=this,a=this.menuData.map(function(a){return o.default.createElement(u.Item,{key:a.id},o.default.createElement(c,{colors:"info",checked:e.state.mapCheck[a.id],onChange:t.handleCheckboxChange.bind(t,a.id)}),a.name)});return o.default.createElement("div",null,o.default.createElement(i,{show:this.state.showModal,size:"lg"},o.default.createElement(i.Header,null,o.default.createElement(i.Title,null,this.props.title)),o.default.createElement(i.Body,null,o.default.createElement("div",{className:"wrap"},1!=this.menuData.length?o.default.createElement("div",{className:"menuBox"},o.default.createElement("div",{className:"menuContent"},o.default.createElement(u,{mode:"inline",selectedKeys:[this.state.currentMenu],defaultOpenKeys:["sub1"],onClick:this.handleMenuClick,style:{width:150}},o.default.createElement(f,{key:"sub1",title:o.default.createElement("span",null,o.default.createElement("span",null,"选择流程"))},a)))):"",o.default.createElement("div",{style:{float:"left"}},o.default.createElement(l,{titles:["用户","已选"],dataSource:this.state.source,targetKeys:this.state.target,notFoundContent:"",listStyle:{height:330,width:200},onChange:this.handleTransferChange,render:function(e){return e.title},lazy:{container:"modal"}}),this.props.hideNote?"":o.default.createElement(d,{value:this.state.textValue,onChange:function(t){e.setState({textValue:t})},className:"textArea"})))),o.default.createElement(i.Footer,null,o.default.createElement(p,{onClick:this.cancel,style:{marginRight:50}},"取消"),o.default.createElement(p,{onClick:this.confirm,colors:"primary"},"确定"))))}}]),t}();t.default=m},236:function(e,t,a){var n=a(237);"string"==typeof n&&(n=[[e.i,n,""]]);var r={transform:void 0};a(6)(n,r);n.locals&&(e.exports=n.locals)},237:function(e,t,a){(e.exports=a(5)(!1)).push([e.i,".wrap {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  height: 400px;\n  padding-bottom: 11px;\n}\n.wrap::-webkit-scrollbar,\n.menuBox::-webkit-scrollbar {\n  /*整个滚动条区域的宽度*/\n  width: 3px;\n  height: 3px;\n}\n.wrap::-webkit-scrollbar-button,\n.menuBox::-webkit-scrollbar-button {\n  /*滚动条上下两边的按钮*/\n  display: none;\n}\n.wrap::-webkit-scrollbar-thumb,\n.menuBox::-webkit-scrollbar-thumb {\n  /*真滚动条样式*/\n  -webkit-box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2);\n  background: rgba(0, 0, 0, 0.2);\n  border-radius: 100px ;\n}\n.wrap::-webkit-scrollbar-track,\n.menuBox::-webkit-scrollbar-track {\n  /*滚动条滚动的轨道*/\n  display: none;\n}\n.menuBox {\n  float: left;\n  height: auto;\n  border: 1px solid #ccc;\n  border-radius: 3px;\n  margin-right: 5px;\n  overflow: auto;\n}\n.menuBox .menuContent {\n  margin-top: -13px;\n}\n.menuBox .menuContent .u-menu-item {\n  padding-left: 15px !important;\n}\n.menuBox .menuContent .u-menu-item-selected.u-menu-item {\n  padding-left: 15px !important;\n}\n.menuBox .menuContent .u-checkbox .u-checkbox-label {\n  padding-left: 20px !important;\n}\n.menuBox .menuContent .u-menu.u-menu-root {\n  border: none;\n  box-shadow: none;\n  -webkit-box-shadow: none;\n  border-radius: 0px;\n}\n.textArea {\n  margin-top: 4px;\n}\n.u-transfer-list-content-item span {\n  padding-left: 0px !important;\n}\n",""])},252:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=a(2),l=d(i),u=(d(a(131)),a(254)),c=a(1),p=d(a(233));function d(e){return e&&e.__esModule?e:{default:e}}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var m=c.base.NCBackBtn,b=c.base.NCAffix,h=(c.base.NCPopconfirm,c.base.NCFormControl,c.base.NCAnchor),k=c.base.NCScrollElement,v=c.base.NCScrollLink,y=c.high.PrintOutput,g=c.high.NCUploader,C=c.high.ApproveDetail,w=c.cardCache.setDefData,S=c.cardCache.getDefData,T="customerpf",_="bankaccsub",E="10140CUSTPF_custpfcard",P="search",B="10140CUSTPF",I="/nccloud/uapbd/customer/CustApplyCardQuery.do",A="/nccloud/uapbd/customer/CustApplyUpdate.do",F="/nccloud/uapbd/supbanken/enableSupbankenCard.do",x="/nccloud/uapbd/customer/CustApplyCommit.do",j="/nccloud/uapbd/customer/CustApplyCallback.do",O="/nccloud/uapbd/customer/CustApplyCardPrint.do",D="pk_customerpf",U=["custapplybanks","custtaxtypes","custcontacts","finance","sale","creditctl","bankaccsub"],N=["pk_org","destorg","pk_country","custprop"];function M(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getUrlParam("showBtn"),n=e.getUrlParam("status");n="add"==n||"edit"==n?"edit":"browse";if(a&&"false"==a)e.button.setButtonVisible(["Edit","Add","Delete","Refresh","Query","PrintGrp","Print","Output","CommitGrp","Commit","Callback","Bankacc","Back","Attment","ApproveInfo","Save","Cancel","AddLine","DelLine"],!1),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1);else if(t)e.button.setButtonVisible(["Edit","Save","Cancel","AddLine","DelLine","Delete","Refresh","Query","PrintGrp","Print","Output","CommitGrp","Commit","Callback","Bankacc","Back","Attment","ApproveInfo"],!1),e.button.setButtonVisible(["Add"],!0);else{"edit"==n||"add"==n?(e.button.setButtonVisible(["Edit","Add","Delete","Refresh","Query","PrintGrp","Print","Output","CommitGrp","Commit","Callback","Bankacc","Back","Attment","ApproveInfo"],!1),e.button.setButtonVisible(["Save","Cancel","AddLine","DelLine"],!0),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1)):(e.button.setButtonVisible(["Save","Cancel","AddLine","DelLine","Back","Print","Commit"],!1),e.button.setButtonVisible(["Edit","Add","Delete","Refresh","Query","PrintGrp","Output","CommitGrp","Callback","Bankacc","Attment","ApproveInfo"],!0),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!0));var r=e.form.getFormItemsValue(T,"approvestate").value;"-1"==r?(e.button.setButtonDisabled(["CommitGrp","Edit","Delete","Bankacc"],!1),e.button.setButtonDisabled(["Callback","ApproveInfo"],!0)):"3"==r||"1"==r?(e.button.setButtonDisabled(["CommitGrp","Edit","Delete","Bankacc"],!0),e.button.setButtonDisabled(["Callback","ApproveInfo"],!1)):(e.button.setButtonDisabled(["CommitGrp","Callback","Edit","Delete","Bankacc"],!0),e.button.setButtonDisabled("ApproveInfo",!1))}setTimeout(function(){return e.form.setFormStatus(T,n)},1),setTimeout(function(){return e.form.setFormStatus("customer",n)},1),U.forEach(function(t){"finance"!=t&&"sale"!=t&&"creditctl"!=t&&e.cardTable.setStatus(t,n)}),window.onbeforeunload="add"!=n&&"edit"!=n?null:function(){return""}}var R=(n=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.call(a),a.formId=T,a.searchId=P,a.tableId=_,a.state={pk_org:"",title_code:"",totalcount:0,applycount:0,showBaseInfo:!0,isList:!0,showApprove:!1,approveDetailShow:!1,billid:null,billNumInitState:null,curOrg:"",json:{}},a.bankaccConfig={tableId:"custbank",formId1:"accbasinfo",formId2:"netbankinfo",cardTableId:"bankaccsub",mainPk:a.props.getUrlParam("id"),bankaccModalChange:a.bankaccModalChange.bind(a)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),s(t,[{key:"modifierMeta",value:function(e,t){var a=this,n=e.getUrlParam("status");return t[T].status=n,t.accbasinfo.items.find(function(e){return"accnum"==e.attrcode}).reg=new RegExp("^\\d*$"),t.custcontacts.items.find(function(e){return"pk_linkman"==e.attrcode}).form=e.form,t.custcontacts.items.forEach(function(e){e.attrcode.indexOf("pk_linkman")>=0&&"pk_linkman.sex"!=e.attrcode&&(e.refcode="uapbd/refer/linkman/LinkmanFormRefer/index")}),t.custcontacts_edit.items.find(function(e){return"pk_linkman"==e.attrcode}).form=e.form,t.custcontacts_edit.items.forEach(function(e){e.attrcode.indexOf("pk_linkman")>=0&&"pk_linkman.sex"!=e.attrcode&&(e.refcode="uapbd/refer/linkman/LinkmanFormRefer/index")}),t[T].items=t[T].items.map(function(e,t){return"pk_org"==e.attrcode&&(e.queryCondition={AppCode:B,TreeRefActionExt:"nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder"}),e}),U.forEach(function(n){var r={itemtype:"customer",attrcode:"opr",label:a.state.json["10140CUSTPF-000019"],visible:!0,className:"table-opr",width:200,fixed:"right",render:function(t,a,r){var o=e.cardTable.getStatus(n),s="browse"===o?["Spread"]:["Detail"];return n==_&&(s=[]),["finance","sale","creditctl"].includes(n)||"browse"==o||s.push("Delline"),"custapplybanks"==n&&(s=[]),e.button.createOprationButton(s,{area:"table-opr-area",buttonLimit:3,onButtonClick:function(e,t){return function(e,t,a,n,r,o){switch(t){case"Spread":e.cardTable.toggleRowView(o,n);break;case"Detail":e.cardTable.openModel(o,"edit",n,r);break;case"Delline":e.cardTable.delRowsByIndex(o,r);break;default:console.log(t,r)}}(e,t,0,a,r,n)}})}};t[n].items.push(r)}),t}},{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140CUSTPF",domainName:"uapbd",callback:function(t,a,n){a&&e.setState({json:t,inlt:n},function(){e.initTemplate(e.props,function(){e.props.form.setFormStatus(e.formId,"edit");var t=e.props.getUrlParam("status");if("add"!=t){var a=e.props.getUrlParam("id");e.getdata(a,function(a){var n=e.props.getUrlParam("codeedit"),r=e.props.getUrlParam("vbillnumedit");"edit"==t&&(e.props.form.setFormItemsDisabled(e.formId,{billnumber:!r}),e.props.form.setFormItemsDisabled("customer",{code:!n})),"edit"==t||"add"==t?e.updateSpeTableBtnStatus(a,"edit"):e.updateSpeTableBtnStatus(a)})}else e.setDefaultValue(void 0,function(){e.props.form.setFormItemsValue(T,{pk_org:{value:e.state.curOrg.refpk,display:e.state.curOrg.refname}}),e.afterEvent(e.props,T,"pk_org",e.state.curOrg),e.updateSpeTableBtnStatus(-1,"edit")})})})}})}},{key:"pfProcess",value:function(e,t){var a=this,n={pks:[this.props.getUrlParam("id")],content:t};(0,c.ajax)({url:e,data:n,success:function(t){e==x?!t.data.workflow||"approveflow"!=t.data.workflow&&"workflow"!=t.data.workflow?((0,c.toast)({color:"success",content:a.state.json["10140CUSTPF-000020"]}),a.setState({compositedata:null,compositedisplay:!1}),a.getdata(a.props.getUrlParam("id"),function(e){a.updateSpeTableBtnStatus(e)})):a.setState({compositedata:t.data,compositedisplay:!0}):e==j&&((0,c.toast)({content:a.state.json["10140CUSTPF-000021"],color:"success"}),a.getdata(a.props.getUrlParam("id"),function(e){a.updateSpeTableBtnStatus(e)}))}})}},{key:"updateSpeTableBtnStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"browse",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{finance:"browse",sale:"browse",creditctl:"browse"},n=["Finan","Sale","Credit"],r=["FinanceRefresh","SaleRefresh","CreditctlRefresh"],o={};["finance","sale","creditctl"].forEach(function(s,i){var l=a[s];"edit"==t||"add"==t||-1!=e?(o[n[i]+"Edit"]=!1,o[n[i]+"Save"]=!1,o[n[i]+"Cancel"]=!1,o[r[i]]=!1):"edit"==l||"add"==l?(o[n[i]+"Edit"]=!1,o[n[i]+"Save"]=!0,o[n[i]+"Cancel"]=!0,o[r[i]]=!1):(o[n[i]+"Edit"]=!0,o[n[i]+"Save"]=!1,o[n[i]+"Cancel"]=!1,o[r[i]]=!0)}),this.props.button.setButtonVisible(o)}},{key:"speTableEdit",value:function(e){var t=this,a=[this.state.json["10140CUSTPF-000049"],this.state.json["10140CUSTPF-000050"],this.state.json["10140CUSTPF-000051"]],n=!1,r={};["finance","sale","creditctl"].forEach(function(o,s){if(e!=o){if(r[o]="browse","edit"==t.props.cardTable.getStatus(o)&&!n)return(0,c.toast)({color:"warning",content:a[s]}),void(n=!0)}else r[o]="edit"}),n||(this.props.cardTable.setStatus(e,"edit"),this.updateSpeTableBtnStatus(-1,"browse",r))}},{key:"getTableHeadSpe",value:function(e){var t=this.props.button.createButtonApp;return l.default.createElement("div",{className:"shoulder-definition-area"},l.default.createElement("div",{className:"definition-icons",style:{padding:"0px"}},t({area:e+"-action",onButtonClick:this.buttonClick.bind(this)})))}},{key:"onCardTableAfterEvent",value:function(e,t,a,n,r,o,s){if(r[0].newvalue.value!=r[0].oldvalue.value){var i={};i.value=s.values.pk_region.value,i.display=s.values.pk_region.display,e.cardTable.setValByKeyAndIndex(this.tableId,o,"pk_region.name",i),s.values.pk_region.display=n.refcode}}},{key:"showApprove",value:function(){this.setState({showApprove:!0})}},{key:"closeApprove",value:function(){this.setState({showApprove:!1})}},{key:"bankaccClick",value:function(e,t){switch(t){case"BankAdd":this.setState({isList:!1})}}},{key:"bankaccModalChange",value:function(e){var t=e.isList;delete e.isList,t?(this.bankaccConfig=o({tableId:"custbank",formId1:"accbasinfo",formId2:"netbankinfo",cardTableId:"bankaccsub",mainPk:this.props.getUrlParam("id"),bankaccModalChange:this.bankaccModalChange.bind(this)},e),this.props.modal.close("bankaccList"),this.props.modal.show("bankaccForm")):(this.bankaccConfig={tableId:"custbank",formId1:"accbasinfo",formId2:"netbankinfo",cardTableId:"bankaccsub",mainPk:this.props.getUrlParam("id"),bankaccModalChange:this.bankaccModalChange.bind(this)},this.props.modal.close("bankaccForm"),this.props.modal.show("bankaccList"))}},{key:"linkmanClose",value:function(e){e.cardTable.getAllRows("custcontacts").forEach(function(e){2==e.status&&e.values.forEach(function(e){e.display=e.value})})}},{key:"cardTableDoubleClick",value:function(e,t,a){if("edit"==e.form.getFormStatus(this.formId)){var n=t.values.pk_linkman.value;(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyQueryLinkman.do",data:{pk:n},success:function(t){e.modal.show("linkman"),e.form.setAllFormValue({Linkman:t.data.Linkman}),e.form.setFormStatus("Linkman","edit")}})}}},{key:"linkmanSaveClick",value:function(){var e=this,t=this.props.form.getAllFormValue("Linkman"),a={model:t},n=["name","sex","vjob","phone","cell"],r=this.props.cardTable.getAllRows("custcontacts");(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplySaveLinkman.do",data:a,success:function(a){var o=!1,s=a.data;if(r.forEach(function(e){e.values.pk_linkman.value==s&&(n.forEach(function(a){e.values["pk_linkman."+a].display=t.rows[0].values[a].value}),e.values.pk_linkman.value=s,o=!0)}),!o){var i={};n.forEach(function(a){if(i["pk_linkman."+a]={value:t.rows[0].values[a].value,display:t.rows[0].values[a].value},"sex"==a){var n=t.rows[0].values[a].value;i["pk_linkman."+a].display=n&&"1"==n?e.state.json["10140CUSTPF-000031"]:e.state.json["10140CUSTPF-000032"]}}),i.pk_linkman={value:s,display:t.rows[0].values.name.value};var l={rowid:s,status:2,values:i};r.push(l)}e.props.cardTable.setTableData("custcontacts",{rows:r})}})}},{key:"onLinkmanBeforeEvent",value:function(e,t,a,n,r,o,s){var i=e.meta.getMeta();return"model"==s&&(t="custcontacts_edit"),o.values.pk_linkman.value?(this.editLinkmanPk=o.values.pk_linkman.value,i[t].items.find(function(e){return"pk_linkman"==e.attrcode}).queryCondition=function(){return{pk_linkman:o.values.pk_linkman.value}}):(i[t].items.find(function(e){return"pk_linkman"==e.attrcode}).queryCondition=function(){return{}},this.editLinkmanPk=null),this.linkmanIndex=r,i[t].items.find(function(e){return"pk_linkman"==e.attrcode}).onAfterEdit=this.onLinkmanAfterEdit.bind(this),!0}},{key:"onLinkmanAfterEdit",value:function(e){var t=this,a=["name","sex","vjob","phone","cell"],n=this.props.cardTable.getAllRows("custcontacts"),r=e.linkmanRefer.rows[0].values.pk_linkman.value;n.forEach(function(n,o){var s=n.values.pk_linkman.value;s!=r&&(null!=s&&""!=s||o!=t.linkmanIndex)||(a.forEach(function(a){"sex"==a?(n.values["pk_linkman."+a].value=e.linkmanRefer.rows[0].values[a].value,e.linkmanRefer.rows[0].values[a].value&&(n.values["pk_linkman."+a].display=1==e.linkmanRefer.rows[0].values[a].value?t.state.json["10140CUSTPF-000031"]:t.state.json["10140CUSTPF-000032"])):"name"==a?(n.values.pk_linkman.value=e.linkmanRefer.rows[0].values[a].value,n.values.pk_linkman.display=e.linkmanRefer.rows[0].values[a].value,delete n.values.pk_linkman.isEdit):(n.values["pk_linkman."+a].value=e.linkmanRefer.rows[0].values[a].value,n.values["pk_linkman."+a].display=e.linkmanRefer.rows[0].values[a].value)}),n.values.pk_linkman.value=r)}),this.props.cardTable.setTableData("custcontacts",{rows:n})}},{key:"resetDeptAndPsnRef",value:function(e,t,a,n,r,o,s){var i=this.props.meta.getMeta(),l="model"==s?t+"_edit":t;return"finance"==t&&(i[l].items.find(function(e){return"pk_respdept1"==e.attrcode}).queryCondition=function(){return{pk_org:o.values.pk_org.value}},i.finance.items.find(function(e){return"pk_resppsn1"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.pk_respdept1&&o.values.pk_respdept1.value&&""!=o.values.pk_respdept1.value&&(e.pk_dept=o.values.pk_respdept1.value),e},i.finance_edit.items.find(function(e){return"pk_resppsn1"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.pk_respdept1&&o.values.pk_respdept1.value&&""!=o.values.pk_respdept1.value&&(e.pk_dept=o.values.pk_respdept1.value),e}),"sale"==t&&(i[l].items.find(function(e){return"respdept"==e.attrcode}).queryCondition=function(){return{pk_org:o.values.pk_org.value}},i.sale.items.find(function(e){return"respperson"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.respdept&&o.values.respdept.value&&""!=o.values.respdept.value&&(e.pk_dept=o.values.respdept.value),e},i.sale_edit.items.find(function(e){return"respperson"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.respdept&&o.values.respdept.value&&""!=o.values.respdept.value&&(e.pk_dept=o.values.respdept.value),e}),this.props.meta.setMeta(i),!0}},{key:"onSpeCardTableAfterEvent",value:function(e,t,a,n,r,o,s){r[0].newvalue.value!=r[0].oldvalue.value&&("pk_resppsn1"==a&&"finance"==t?this.props.cardTable.setValByKeyAndIndex(t,o,"pk_respdept1",{value:n.values.pk_dept.value,display:n.values.deptname.values}):"respperson"==a&&"sale"==t&&this.props.cardTable.setValByKeyAndIndex(t,o,"respdept",{value:n.values.pk_dept.value,display:n.values.deptname.values}))}},{key:"onReturnClick",value:function(){this.props.pushTo("/list",{pagecode:"10140CUSTPF_custpflist",appcode:B,status:"browse"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.cardTable,n=t.form,r=t.button,o=t.modal,s=t.cardPagination.createCardPagination,i=n.createForm,c=a.createCardTable,d=r.createButtonApp,f=(r.createButton,o.createModal),w=this.props.getUrlParam("status"),S=this.state.showBaseInfo?"icon-jiantouxia1":"icon-jiantouyou",T=this.state.showBaseInfo?"show-form":"hide-form";return l.default.createElement("div",{className:"nc-bill-card"},l.default.createElement("div",{className:"nc-bill-top-area"},l.default.createElement(b,null,l.default.createElement("div",{className:"nc-bill-header-area"},l.default.createElement("div",null,"browse"==w?l.default.createElement(m,{onClick:this.onReturnClick.bind(this)}):""),l.default.createElement("div",{className:"header-title-search-area"},l.default.createElement("h2",{className:"title-search-detail"},this.state.json["10140CUSTPF-000001"],"browse"==w?"："+this.state.title_code:"")),l.default.createElement("div",{className:"header-button-area"},d({area:"header-button-area",onButtonClick:this.buttonClick.bind(this)}),s({handlePageInfoChange:this.pageInfoClick.bind(this)})))),l.default.createElement(h,null,l.default.createElement(v,{to:this.formId,spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000000"])),l.default.createElement(v,{to:"custapplybanks",spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000003"])),l.default.createElement(v,{to:"custcontacts",spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000005"])),l.default.createElement(v,{to:"custtaxtypes",spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000004"])),l.default.createElement(v,{to:"finance",spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000006"])),l.default.createElement(v,{to:"sale",spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000007"])),l.default.createElement(v,{to:"creditctl",spy:!0,smooth:!0,duration:300,offset:-100},l.default.createElement("p",null,this.state.json["10140CUSTPF-000008"]))),l.default.createElement(k,{name:this.formId},l.default.createElement("div",{className:"nc-bill-form-area"},i(this.formId,{onAfterEvent:this.afterEvent.bind(this)}))),l.default.createElement(k,{name:this.state.json["10140CUSTPF-000000"]},l.default.createElement("div",{className:"nc-bill-form-area"},l.default.createElement("div",{className:"group-form-wrapper"},l.default.createElement("div",{className:"group-form-name"},l.default.createElement("span",{className:"toggle-form-icon iconfont "+S,onClick:function(){var t=!e.state.showBaseInfo;e.setState({showBaseInfo:t})}}),l.default.createElement("span",{className:"name"},this.state.json["10140CUSTPF-000000"])),l.default.createElement("div",{className:"group-form-item "+T+" "},i("customer",{onAfterEvent:this.afterEvent.bind(this)})))))),l.default.createElement("div",{className:"nc-bill-bottom-area"},l.default.createElement(k,{name:"custapplybanks"},l.default.createElement("div",{className:"nc-bill-table-area"},c("custapplybanks",{}))),l.default.createElement(k,{name:"custcontacts"},l.default.createElement("div",{className:"nc-bill-table-area"},c("custcontacts",{tableHead:this.getTableHead.bind(this,"custcontacts"),onBeforeEvent:this.onLinkmanBeforeEvent.bind(this),modelClose:this.linkmanClose.bind(this)}))),l.default.createElement(k,{name:"custtaxtypes"},l.default.createElement("div",{className:"nc-bill-table-area"},c("custtaxtypes",{tableHead:this.getTableHead.bind(this,"custtaxtypes")}))),l.default.createElement(k,{name:"finance"},l.default.createElement("div",{className:"nc-bill-table-area"},c("finance",{tableHead:this.getTableHeadSpe.bind(this,"finance"),onBeforeEvent:this.resetDeptAndPsnRef.bind(this),onAfterEvent:this.onSpeCardTableAfterEvent.bind(this),hideAdd:!0,hideDel:!0,hideModelSave:!0}))),l.default.createElement(k,{name:"sale"},l.default.createElement("div",{className:"nc-bill-table-area"},c("sale",{tableHead:this.getTableHeadSpe.bind(this,"sale"),onBeforeEvent:this.resetDeptAndPsnRef.bind(this),onAfterEvent:this.onSpeCardTableAfterEvent.bind(this),hideAdd:!0,hideDel:!0,hideModelSave:!0}))),l.default.createElement(k,{name:"creditctl"},l.default.createElement("div",{className:"nc-bill-table-area"},c("creditctl",{tableHead:this.getTableHeadSpe.bind(this,"creditctl"),hideAdd:!0,hideDel:!0,hideModelSave:!0}))),f("delete",{title:this.state.json["10140CUSTPF-000016"],content:this.state.json["10140CUSTPF-000017"],beSureBtnClick:this.delConfirm.bind(this)}),(0,u.createBankaccList)(Object.assign({json:this.state.json},this.props),this.bankaccConfig),(0,u.createBankaccForm)(Object.assign({json:this.state.json},this.props),this.bankaccConfig),f("linkman",{title:this.state.json["10140CUSTPF-000033"],content:i("Linkman",{}),beSureBtnClick:this.linkmanSaveClick.bind(this)})),l.default.createElement(y,{ref:"printOutput",url:O,data:{funcode:"10140CUSTPF",nodekey:"custpfcard",oids:this.state.ids,outputType:"output"}}),this.state.showlogoUploader&&l.default.createElement(g,{billId:"uapbd/6d6d4a15-d9bb-4b0c-9da3-80760872bf87/"+this.props.getUrlParam("id"),placement:"bottom_right",multiple:!1,onHide:this.onHideUploader.bind(this)}),this.state.compositedisplay?l.default.createElement(p.default,{title:this.state.json["10140CUSTPF-000034"],data:this.state.compositedata,display:this.state.compositedisplay,getResult:this.getAssginUsedr.bind(this),cancel:this.turnOff.bind(this)}):"",l.default.createElement(C,{show:this.state.approveDetailShow,close:this.closeApprove.bind(this),billtype:"10KH",billid:this.state.billid}))}}]),t}(),r=function(){var e=this;this.initTemplate=function(t,a){t.createUIDom({pagecode:E},function(n){if(n){if(n.template){var r=n.template;e.modifierMeta(t,r),t.meta.setMeta(r)}if(n.button){var o=n.button;t.button.setButtons(o),M(t)}n.context&&n.context.pk_org&&n.context.org_Name&&(e.state.curOrg={refname:n.context.org_Name,refpk:n.context.pk_org}),a&&a()}})},this.setDefaultValue=function(t,a){t&&(t.preBillCode=e.preBillCode,t.preCustCode=e.preCustCode,t.hasPreBillCode=e.hasPreBillCode,t.hasPreCustCode=e.hasPreCustCode),(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyAdd.do",data:t,success:function(t){if(t.data){e.props.form.setAllFormValue(f({},e.formId,t.data[e.formId][e.formId])),e.props.form.setAllFormValue(f({},"customer",t.data.customer.customer)),e.setItemsProperty(t),e.preBillCode=t.data.preBillCode,e.preCustCode=t.data.preCustCode,e.hasPreBillCode=t.data.hasPreBillCode,e.hasPreCustCode=t.data.hasPreCustCode;var n=t.data.customer.customer.rows[0].values.pk_org.value,r=e.props.meta.getMeta();["pk_areacl","pk_custclass","pk_customer_main","pk_supplier"].forEach(function(e){r.customer.items.find(function(t){return t.attrcode==e}).queryCondition=function(){return{pk_org:n}}}),e.props.meta.setMeta(r)}a&&a()},error:function(e){(0,c.toast)({color:"danger",content:e.message})}})},this.setItemsProperty=function(t){var a=t.data[e.formId][e.formId].rows[0],n=t.data.customer.customer.rows[0],r=a.values.pk_org,o=(a.values.billnumber,a.values.destorg),s=n.values.custprop,i="Y"==t.data.billnumberIsEditable;e.props.form.setFormItemsDisabled(e.formId,{billnumber:!i});var l="Y"==t.data.cstBillNumCanEdit;if(e.props.form.setFormItemsDisabled("customer",{code:!l}),i?null!=e.state.billNumInitState&&e.props.form.setFormItemsRequired(e.formId,{billnumber:e.state.billNumInitState}):(null==e.state.billNumInitState&&(e.state.billNumInitState=e.props.form.getFormItemsRequired(e.formId,"billnumber")),e.props.form.setFormItemsRequired(e.formId,{billnumber:!1})),r&&o){var u=null!=r.value&&"0"==o.value;e.props.form.setFormItemsDisabled("customer",{custprop:u})}if(s){var c="1"==s.value;e.props.form.setFormItemsRequired("customer",{pk_financeorg:c}),e.props.form.setFormItemsDisabled("customer",{pk_financeorg:!c});var p=e.props.meta.getMeta();p&&null!=p&&null!=p.customer&&(p.customer.items=p.customer.items.map(function(e){return"pk_financeorg"==e.attrcode&&(e.queryCondition={AppCode:B,TreeRefActionExt:"nccloud.web.uapbd.customer.custapply.ref.BusinessUnitTreeRefExt"}),e}),e.props.meta.setMeta(p))}},this.getAssginUsedr=function(t){e.pfProcess(x,t)},this.turnOff=function(){e.setState({compositedata:null,compositedisplay:!1})},this.buttonClick=function(t,a){switch(a){case"Add":t.form.EmptyAllFormValue("customer"),t.form.EmptyAllFormValue(e.formId),U.forEach(function(e){setTimeout(function(){return t.cardTable.setTableData(e,{rows:[]})},1)}),t.setUrlParam({pagecode:E,appcode:B,status:"add"}),e.setDefaultValue(void 0,function(){e.props.form.setFormItemsValue(e.formId,{pk_org:{value:e.state.curOrg.refpk,display:e.state.curOrg.refname}}),e.afterEvent(t,T,"pk_org",e.state.curOrg),M(t),e.updateSpeTableBtnStatus(-1,"edit")});break;case"Edit":e.valid(t,"edit",e.edit.bind(e,t));break;case"Delete":e.props.modal.show("delete",{title:e.state.json["10140CUSTPF-000022"],content:e.state.json["10140CUSTPF-000023"],beSureBtnClick:e.delConfirm.bind(e)});break;case"Save":e.saveClick(t);break;case"Enable":var n=t.form.getAllFormValue(e.formId),r={isEnable:!0,list:[]},o={pk_bankaccbas:n.rows[0].values.pk_bankaccbas.value,pk_custbank:n.rows[0].values.pk_custbank.value,pk_cust:n.rows[0].values.pk_cust.value};r.list.push(o),(0,c.ajax)({url:F,data:r,success:function(t){e.getdata(o.pk_custbank,o.pk_bankaccbas,o.pk_cust),(0,c.toast)({color:"success",title:e.state.json["10140CUSTPF-000024"]})}});break;case"Disable":n=t.form.getAllFormValue(e.formId),r={isEnable:!1,list:[]},o={pk_bankaccbas:n.rows[0].values.pk_bankaccbas.value,pk_custbank:n.rows[0].values.pk_custbank.value,pk_cust:n.rows[0].values.pk_cust.value},r.list.push(o),(0,c.ajax)({url:F,data:r,success:function(t){e.getdata(o.pk_custbank,o.pk_bankaccbas,o.pk_cust),(0,c.toast)({color:"success",title:e.state.json["10140CUSTPF-000025"]})}});break;case"Back":t.pushTo("/list",{pagecode:"10140CUSTPF_custpflist",appcode:B,status:"browse"});break;case"Refresh":e.refresh(t);break;case"CommitGrp":case"Commit":e.pfProcess(x);break;case"Callback":e.pfProcess(j);break;case"Approve":e.showApprove();break;case"UnApprove":e.pfProcess(unApproveUrl);break;case"Cancel":(0,c.promptBox)({color:"warning",title:e.state.json["10140CUSTPF-000027"],content:e.state.json["10140CUSTPF-000028"],beSureBtnClick:e.Cancel.bind(e,t)});break;case"Bankacc":t.modal.show("bankaccList");break;case"PrintGrp":case"Print":e.onPrint();break;case"Output":e.onOutput();break;case"Attment":e.Attment();break;case"ApproveInfo":e.setState({approveDetailShow:!0,billid:t.form.getFormItemsValue(T,D).value});break;case"FinanEdit":e.speTableEdit("finance");break;case"SaleEdit":e.speTableEdit("sale");break;case"CreditEdit":e.speTableEdit("creditctl");break;case"FinanSave":r={};var s=t.form.getAllFormValue(e.formId),i=t.form.getAllFormValue("customer");r.CustomerPfVO=s,r.CustomerVO=i,U.forEach(function(e){"bankaccsub"!=e&&(r[e]=t.cardTable.getAllData(e))}),(0,c.ajax)({url:A,data:r,success:function(a){t.pushTo("/card",{status:"browse",id:a.data}),e.bankaccConfig.mainPk=a.data;e.getdata(a.data);e.updateSpeTableBtnStatus(),e.setState({backVisible:!0}),e.props.cardTable.setStatus("finance","browse"),e.finanTableStatus="browse"}});break;case"SaleSave":r={},s=t.form.getAllFormValue(e.formId),i=t.form.getAllFormValue("customer"),r.CustomerPfVO=s,r.CustomerVO=i,U.forEach(function(e){"bankaccsub"!=e&&(r[e]=t.cardTable.getAllData(e))}),(0,c.ajax)({url:A,data:r,success:function(a){t.pushTo("/card",{status:"browse",id:a.data}),e.bankaccConfig.mainPk=a.data;e.getdata(a.data);e.updateSpeTableBtnStatus(),e.setState({backVisible:!0}),e.props.cardTable.setStatus("sale","browse"),e.finanTableStatus="browse"}});break;case"CreditSave":r={},s=t.form.getAllFormValue(e.formId),i=t.form.getAllFormValue("customer"),r.CustomerPfVO=s,r.CustomerVO=i,U.forEach(function(e){"bankaccsub"!=e&&(r[e]=t.cardTable.getAllData(e))}),(0,c.ajax)({url:A,data:r,success:function(a){t.pushTo("/card",{status:"browse",id:a.data}),e.bankaccConfig.mainPk=a.data;e.getdata(a.data);e.updateSpeTableBtnStatus(),e.setState({backVisible:!0}),e.props.cardTable.setStatus("creditctl","browse")}});break;case"FinanCancel":e.props.cardTable.resetTableData("finance"),e.props.cardTable.setStatus("finance","browse"),e.updateSpeTableBtnStatus();break;case"SaleCancel":e.props.cardTable.resetTableData("sale"),e.props.cardTable.setStatus("purchase","browse"),e.updateSpeTableBtnStatus();break;case"CreditCancel":e.props.cardTable.resetTableData("creditctl"),e.props.cardTable.setStatus("purchase","browse"),e.updateSpeTableBtnStatus();break;case"FinanceRefresh":e.getdata(e.props.getUrlParam("id"),null,["fiance"]);break;case"SaleRefresh":e.getdata(e.props.getUrlParam("id"),null,["sale"]);break;case"CreditctlRefresh":e.getdata(e.props.getUrlParam("id"),null,["creditctl"])}},this.closeApprove=function(){e.setState({approveDetailShow:!1})},this.edit=function(t){t.setUrlParam({pagecode:E,appcode:B,status:"edit",id:t.getUrlParam("id")}),M(t),e.updateSpeTableBtnStatus(-1,"edit")},this.valid=function(t,a,n){var r={pk:t.form.getFormItemsValue(T,D).value,action:a};(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyValid.do",data:r,success:function(t){t&&t.data&&(e.props.form.setFormItemsDisabled(e.formId,{billnumber:!t.data.vbillnumedit}),e.props.form.setFormItemsDisabled("customer",{code:!t.data.codeedit}),n&&n())}})},this.Cancel=function(t){var a=void 0==t.getUrlParam("id")?S("preid","uapbd.customer.custapply.cache"):e.props.getUrlParam("id");e.getdata(a,function(t){e.updateSpeTableBtnStatus(t)}),t.form.setFormStatus(e.formId,"browse"),t.form.setFormStatus("customer","browse"),U.forEach(function(e){t.cardTable.setStatus(e,"browse")}),t.setUrlParam({pagecode:E,appcode:B,status:"browse"}),M(t,""==a||null==a)},this.Attment=function(){e.state.showlogoUploader=!0,e.setState(e.state)},this.onHideUploader=function(){e.state.showlogoUploader=!1,e.setState(e.state)},this.onPrint=function(){var t=e.props.form.getAllFormValue(T);if(0!==t.length){var a=[];a.push(t.rows[0].values[D].value),(0,c.print)("pdf",O,{funcode:"10140CUSTPF",nodekey:"custpfcard",oids:a})}else(0,c.toast)({content:e.state.json["10140CUSTPF-000029"],color:"warning"})},this.onOutput=function(){var t=e.props.form.getAllFormValue(T);if(0!==t.length){var a=[];a.push(t.rows[0].values[D].value),e.setState({ids:a},e.refs.printOutput.open())}else(0,c.toast)({content:e.state.json["10140CUSTPF-000029"],color:"warning"})},this.refresh=function(t){t.setUrlParam({pagecode:E,appcode:B,status:t.getUrlParam("status"),id:t.getUrlParam("id")}),e.getdata(t.getUrlParam("id"),function(){(0,c.toast)({title:e.state.json["10140CUSTPF-000026"],color:"success"})})},this.addLineClick=function(t){e.props.cardTable.addRow(t)},this.pageInfoClick=function(e,t){var a={pk:t,pageid:E};(0,c.ajax)({url:I,data:a,success:function(a){a.data.head&&(e.form.setAllFormValue(f({},T,a.data.head[T])),e.setUrlParam(t)),a.data.body&&e.editTable.setTableData(_,a.data.body[_])}})},this.afterEvent=function(t,a,n,r,o,s,i,l){if(N.includes(n)){var u={},c=e.props.form.getAllFormValue("customerpf"),p=e.props.form.getAllFormValue("customer");if(u.CustomerPfVO=c,u.CustomerVO=p,u.key=n,u.status=e.props.getUrlParam("status"),"pk_org"==n&&t.meta.getMeta().customer.items.forEach(function(e){["pk_custclass","pk_areacl","pk_customer_main","pk_supplier"].includes(e.attrcode)&&(e.queryCondition={pk_org:r.value})}),"destorg"==n){var d="0"==r.value;e.props.form.setFormItemsDisabled("customer",{custprop:d,pk_financeorg:d})}if("custprop"==n){var f="1"==r.value;e.props.form.setFormItemsRequired("customer",{pk_financeorg:f})}e.setDefaultValue(u)}},this.getTableHead=function(t){var a=e.props.button,n=a.createButtonApp;a.createButton;return l.default.createElement("div",{className:"shoulder-definition-area"},l.default.createElement("div",{className:"definition-icons"},n({area:"definition-icons",onButtonClick:e.addLineClick.bind(e,t)}),e.props.cardTable.createBrowseIcons(t,{iconArr:["close","open","max","setCol"],maxDestAreaId:"nc-bill-card"})))},this.getdata=function(t,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r={pk:t};(0,c.ajax)({url:I,data:r,success:function(r){var o=-1;if(r.data){if(r.data.head){var s,i=(f(s={},e.formId,r.data.head[e.formId]),f(s,"customer",r.data.customer.customer),s);e.props.form.setAllFormValue(i),o=r.data.head[e.formId].rows[0].values.approvestate.value}if(r.data.bodys){if(n.length>0)return void r.data.bodys.forEach(function(t,a){n.forEach(function(n){t.hasOwnProperty(n)&&e.props.cardTable.setTableData(n,r.data.bodys[a][n])})});r.data.bodys.forEach(function(t,a){U.forEach(function(n){t.hasOwnProperty(n)&&e.props.cardTable.setTableData(n,r.data.bodys[a][n])})})}}else e.props.form.EmptyAllFormValue(e.formId),e.props.form.EmptyAllFormValue("customer");M(e.props,""==t||null==t),e.setState(e.state),a&&"function"==typeof a&&a(o)}})},this.saveClick=function(t){var a="/nccloud/uapbd/customer/CustApplySave.do";"edit"===e.props.getUrlParam("status")&&(a=A);var n={};if(t.form.isCheckNow(e.formId)){var r=t.form.getAllFormValue(e.formId),o=t.form.getAllFormValue("customer");n.CustomerPfVO=r,n.CustomerVO=o,U.forEach(function(e){"bankaccsub"!=e&&(n[e]=t.cardTable.getAllData(e))});var s=e.props.meta.getMeta(),i=[];(s=s.customer.items).forEach(function(e){1==e.required&&(null!=o.rows[0].values[e.attrcode].value&&""!=o.rows[0].values[e.attrcode].value||i.push(e.label))});var l=null;i.length>0?(l=e.state.json["10140CUSTPF-000053"]+"["+i.join("],[")+"]",r.rows[0].values.memo.value=l):r.rows[0].values.memo.value=null,n.preCustCode=e.preCustCode,n.hasPreCustCode=e.hasPreCustCode,(0,c.ajax)({url:a,data:n,success:function(a){var n=a.data;t.setUrlParam({pagecode:E,appcode:B,status:"browse",id:n}),w("preid","uapbd.customer.custapply.cache",n),e.getdata(n,function(t){e.updateSpeTableBtnStatus(t,"browse")}),l?(0,c.toast)({color:"warning",content:l}):(0,c.toast)({color:"success",title:e.state.json["10140CUSTPF-000030"]})}})}},this.delConfirm=function(){(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyDelete.do",data:{deleteinfo:[{pk_org:e.props.form.getFormItemsValue(e.formId,"pk_org").value,id:null==e.props.getUrlParam("id")?e.props.form.getFormItemsValue(e.formId,D).value:e.props.getUrlParam("id"),ts:e.props.form.getFormItemsValue(e.formId,"ts").value}]},success:function(t){t&&e.props.pushTo("/list",{pagecode:"10140CUSTPF_custpflist",appcode:B,status:"browse"})}})},this.modelSave=function(t){e.props.cardTable.closeModel(t),e.saveClick(e.props)}},n);R=(0,c.createPage)({})(R),t.default=R},254:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e};t.createBankaccList=function(e,t){var a=e.cardTable,r=e.form,s=e.button,i=e.modal,l=(e.cardPagination,e.table),u=(r.createForm,a.createCardTable,s.createButtonApp,l.createSimpleTable,i.createModal),c=React.createElement("div",null,React.createElement(o.default,n({},e,t)));return u("bankaccList",{content:c,noFooter:!0})},t.createBankaccForm=function(e,t){e.cardTable,e.form,e.button;var a=e.modal,r=(e.cardPagination,e.table,a.createModal),o=React.createElement("div",null,React.createElement(s.default,n({},e,t)));return r("bankaccForm",{content:o,size:"xlg",noFooter:!0})};var r=a(1),o=i(a(255)),s=i(a(256));function i(e){return e&&e.__esModule?e:{default:e}}r.base.NCAffix,r.base.NCPopconfirm,r.base.NCFormControl,r.base.NCAnchor,r.base.NCScrollElement,r.base.NCScrollLink,r.base.createModal},255:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r),s=a(1);s.base.NCPopconfirm,s.base.NCIcon,s.base.NCTabs.NCTabPane;var i="/nccloud/uapbd/customer/CustAppDelBank.do",l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.doubleClick=function(e,t,n){var r={isList:!0,cardStatus:"browse",accnum:e.accnum.value,pk_banktype:e.pk_banktype.value};a.props.bankaccModalChange&&a.props.bankaccModalChange(r)},a.tableId=e.tableId,a.selectedRow=null;var n=a.props.meta.getMeta(),r=!1;return n[a.tableId].items.forEach(function(e){"opr"==e.attrcode&&(r=!0)}),e.button.setPopContent("BankListDel",a.props.json["10140CUSTPF-000052"]),r||(n[a.tableId].items.push({itemtype:"customer",attrcode:"opr",label:a.props.json["10140SPF-000019"],fixed:"right",className:"tab le-opr",visible:!0,render:function(t,n,r){return e.button.createOprationButton(["BankListEdit","BankListDel"],{area:"brow-action",buttonLimit:3,onButtonClick:function(e,o){a.tableRowButtonClick(e,o,t,n,r)}})}}),a.props.meta.setMeta(n)),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"tableRowButtonClick",value:function(e,t,a,n,r){var o=this;switch(t){case"BankListEdit":var l={isList:!0,accnum:n.accnum.value,pk_banktype:n.pk_banktype.value,cardStatus:"edit"};this.props.bankaccModalChange&&this.props.bankaccModalChange(l);break;case"BankListDel":l={mainPk:this.props.mainPk,accnum:n.accnum.value,pk_banktype:n.pk_banktype.value},(0,s.ajax)({url:i,data:l,success:function(e){o.getData(o.props)}})}}},{key:"updateButtonStatus",value:function(){this.props.button.setButtonVisible(["BankAdd","BankRefresh"],!0),this.props.button.setButtonVisible(["BankEdit","BankDelete","BankCancel","BankSave","BankBack","BankSaveAdd"],!1)}},{key:"componentDidMount",value:function(){var e=this;this.getData(this.props),setTimeout(function(){return e.updateButtonStatus()},1)}},{key:"getData",value:function(e){var t={mainPk:e.mainPk};(0,s.ajax)({url:"/nccloud/uapbd/customer/CustAppQueryBankList.do",data:t,success:function(t){t&&t.data&&t.data.hasOwnProperty(e.tableId)?e.table.setAllTableData(e.tableId,t.data[e.tableId]):e.table.setAllTableData(e.tableId,{rows:[]})}})}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"BankAdd":var n=this.selectedRow,r={isList:!0,cardStatus:"add"};this.props.bankaccModalChange&&this.props.bankaccModalChange(r);break;case"BankEdit":n=this.selectedRow,console.log(n),r={isList:!0,accnum:n.accnum.value,pk_banktype:n.pk_banktype.value,cardStatus:"edit"},this.props.bankaccModalChange&&this.props.bankaccModalChange(r);break;case"BankDelete":n=this.selectedRow,r={mainPk:this.props.mainPk,accnum:n.accnum.value,pk_banktype:n.pk_banktype.value},(0,s.ajax)({url:i,data:r,success:function(e){a.getData(a.props)}});break;case"BankRefresh":this.getData(this.props)}}},{key:"onRowClick",value:function(e,t,a,n){this.selectedRow=a}},{key:"render",value:function(){var e=this.props,t=e.table,a=e.button,n=(e.search,t.createSimpleTable),r=a.createButtonApp;a.createButton;return o.default.createElement("div",{className:"nc-bill-list"},o.default.createElement("div",{className:"nc-bill-header-area"},o.default.createElement("div",{className:"header-title-search-area"},o.default.createElement("h2",{className:"title-search-detail"},this.props.json["10140CUSTPF-000018"])),o.default.createElement("div",{className:"header-button-area"},r({area:"bank-action",buttonLimit:3,onButtonClick:this.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),o.default.createElement("div",{style:{height:"10px"}}),o.default.createElement("div",{className:"nc-bill-table-area"},n(this.tableId,{onRowClick:this.onRowClick.bind(this),onRowDoubleClick:this.doubleClick.bind(this),showIndex:!0})))}}]),t}();t.default=l},256:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(2),o=i(r),s=(i(a(131)),a(1));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=s.base.NCAffix,c=(s.base.NCPopconfirm,s.base.NCFormControl,s.base.NCBackBtn),p="/nccloud/uapbd/customer/CustAppSaveBank.do",d="/nccloud/uapbd/customer/CustAppDelBank.do",f="/nccloud/uapbd/customer/CustApplyExField.do",m=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.setBankAccSubDefault=function(e){var t={isAdd:!1};a.getValueFromForm(t),t.mainPk=a.props.mainPk;var n=t.cardTable.model.rows;n.forEach(function(e){e.values.isdefault.value=!1}),n[e].values.isdefault.value=!0,(0,s.ajax)({url:p,data:t,success:function(e){a.props.cardTable.setStatus(a.props.cardTableId,"browse"),a.props.form.setAllFormValue(l({},a.props.formId1,e.data.head.custbank)),a.props.form.setAllFormValue(l({},a.props.formId2,e.data.head.custbank)),e.data.body&&e.data.body[a.props.cardTableId]&&a.props.cardTable.setTableData(a.props.cardTableId,e.data.body[a.props.cardTableId]),a.accnum=e.data.head.custbank.rows[0].values.accnum.value,a.pk_banktype=e.data.head.custbank.rows[0].values.pk_banktype.value,a.cardStatus="browse",a.updateButtonStatus()}})},a.delConfirm=function(){(0,s.ajax)({url:d,data:{deleteinfo:[{id:a.props.getUrlParam("id"),ts:a.props.form.getFormItemsValue(a.formId,"ts").value}]},success:function(e){e&&a.props.linkTo("../list/index.html")}})},a.getTableHead=function(){var e=a.props.button.createButtonApp;return o.default.createElement("div",{className:"shoulder-definition-area"},o.default.createElement("div",{className:"definition-icons"},e({area:"bank-body",onButtonClick:a.buttonClick.bind(a)}),a.props.cardTable.createBrowseIcons(a.tableId,{iconArr:["close","open","max","setCol"],maxDestAreaId:"nc-bill-card"})))},a.formId1=a.props.formId1,a.formId2=a.props.formId2,a.tableId=a.props.cardTableId,a.cardStatus=a.props.cardStatus,a.accnum=a.props.accnum,a.pk_banktype=a.props.pk_banktype,a.state={pk_org:"",title_code:"",totalcount:0,applycount:0,showAccbase:!0,showNetBank:!1,backVisible:!0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),n(t,[{key:"componentDidMount",value:function(){var e=this,t=this.cardStatus;t&&"add"==t?(setTimeout(function(){return e.props.form.EmptyAllFormValue(e.props.formId1)},1),setTimeout(function(){return e.props.form.EmptyAllFormValue(e.props.formId2)},1),setTimeout(function(){return e.props.cardTable.setTableData(e.props.cardTableId,{rows:[]})},1),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId1,"edit")},1),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId2,"edit")},1),setTimeout(function(){return e.props.cardTable.setStatus(e.props.cardTableId,"edit")},1),(0,s.ajax)({url:f,data:{pk_country:this.props.form.getFormItemsValue("customer","pk_country").value,operation:"bankinfo"},success:function(t){if(t.data.pk_currtype){e.props.cardTable.addRow(e.props.cardTableId,0,{pk_currtype:{value:t.data.pk_currtype,display:t.data.currtypename}});var a=e.props.form.getFormItemsValue("customer","name");e.props.form.setFormItemsValue(e.props.formId1,{accname:{value:a.name.value,display:a.name.display}})}}})):t&&"edit"==t?(this.getData(this.props.mainPk,this.accnum,this.pk_banktype),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId1,"edit")},1),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId2,"edit")},1),setTimeout(function(){return e.props.cardTable.setStatus(e.props.cardTableId,"edit")},1)):t&&"browse"==t&&this.getData(this.props.mainPk,this.accnum,this.pk_banktype),setTimeout(function(){return e.updateButtonStatus()},1)}},{key:"updateButtonStatus",value:function(){var e=this.cardStatus;if(e&&"browse"==e)this.props.button.setButtonVisible(["BankAdd","BankEdit","BankDelete","BankRefresh","BankDefault"],!0),this.props.button.setButtonVisible(["BankCancel","BankSave","BankAddLine","BankBack","BankSaveAdd"],!1),this.setState({backVisible:!0});else{var t=["BankCancel","BankSave","BankAddLine"],a=["BankAdd","BankEdit","BankDelete","BankRefresh","BankBack","BankDefault"];"add"==this.cardStatus?t.push("BankSaveAdd"):a.push("BankSaveAdd"),this.props.button.setButtonVisible(a,!1),this.props.button.setButtonVisible(t,!0),this.setState({backVisible:!1})}}},{key:"getData",value:function(e,t,a){var n=this,r={mainPk:e,accnum:t,pk_banktype:a};(0,s.ajax)({url:"/nccloud/uapbd/customer/CustAppQueryBankCard.do",data:r,success:function(e){n.props.form.setAllFormValue(l({},n.props.formId1,e.data.head.custbank)),n.props.form.setAllFormValue(l({},n.props.formId2,e.data.head.custbank)),e.data.body&&e.data.body[n.props.cardTableId]&&n.props.cardTable.setTableData(n.props.cardTableId,e.data.body[n.props.cardTableId])}})}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"BankAdd":this.props.form.EmptyAllFormValue(this.props.formId1),this.props.form.EmptyAllFormValue(this.props.formId2),this.props.cardTable.setTableData(this.props.cardTableId,{rows:[]}),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId1,"edit")},1),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId2,"edit")},1),setTimeout(function(){return a.props.cardTable.setStatus(a.props.cardTableId,"edit")},1),this.cardStatus="add",setTimeout(function(){return a.updateButtonStatus()},1),(0,s.ajax)({url:f,data:{pk_country:this.props.form.getFormItemsValue("customer","pk_country").value,operation:"bankinfo"},success:function(e){if(e.data.pk_currtype){a.props.cardTable.addRow(a.props.cardTableId,0,{pk_currtype:{value:e.data.pk_currtype,display:e.data.currtypename}});var t=a.props.form.getFormItemsValue("customer","name");a.props.form.setFormItemsValue(a.props.formId1,{accname:{value:t.name.value,display:t.name.display}})}}});break;case"BankEdit":this.props.form.setFormStatus(this.props.formId1,"edit"),this.props.form.setFormStatus(this.props.formId2,"edit"),this.props.cardTable.setStatus(this.props.cardTableId,"edit"),this.cardStatus="edit",setTimeout(function(){return a.updateButtonStatus()},1);break;case"BankSave":var n={isAdd:"add"==this.cardStatus};if(!this.getValueFromForm(n))return;n.mainPk=this.props.mainPk,(0,s.ajax)({url:p,data:n,success:function(e){a.props.form.setFormStatus(a.props.formId1,"browse"),a.props.form.setFormStatus(a.props.formId2,"browse"),a.props.cardTable.setStatus(a.props.cardTableId,"browse"),a.props.form.setAllFormValue(l({},a.props.formId1,e.data.head.custbank)),a.props.form.setAllFormValue(l({},a.props.formId2,e.data.head.custbank)),e.data.body&&e.data.body[a.props.cardTableId]&&a.props.cardTable.setTableData(a.props.cardTableId,e.data.body[a.props.cardTableId]),a.accnum=e.data.head.custbank.rows[0].values.accnum.value,a.pk_banktype=e.data.head.custbank.rows[0].values.pk_banktype.value,a.cardStatus="browse",a.updateButtonStatus()}});break;case"BankDelete":var r={mainPk:this.props.mainPk,accnum:this.accnum,pk_banktype:this.pk_banktype};(0,s.ajax)({url:d,data:r,success:function(e){r={isList:!1},a.props.bankaccModalChange&&a.props.bankaccModalChange(r)}});break;case"BankCancel":this.props.form.setFormStatus(this.props.formId1,"browse"),this.props.form.setFormStatus(this.props.formId2,"browse"),this.props.cardTable.setStatus(this.props.cardTableId,"browse"),this.accnum&&this.pk_banktype&&this.getData(this.props.mainPk,this.accnum,this.pk_banktype),this.cardStatus="browse",this.updateButtonStatus();break;case"BankAddLine":setTimeout(function(){return a.props.cardTable.addRow(a.props.cardTableId)},1);break;case"BankBack":r={isList:!1},this.props.bankaccModalChange&&this.props.bankaccModalChange(r);break;case"BankDefault":var o=this.props.cardTable.getCheckedRows(this.props.cardTableId);if(o&&0!=o.length){var i=o[0],u=i.data.values.isdefault.value;u&&null!=u&&1==u?(0,s.toast)({content:this.props.json["10140CUSTPF-000010"],color:"danger"}):this.props.modal.show("modal",{title:this.props.json["10140CUSTPF-000011"],content:this.props.json["10140CUSTPF-000012"],beSureBtnClick:this.setBankAccSubDefault.bind(this,i.index)})}else(0,s.toast)({content:this.props.json["10140CUSTPF-000009"],color:"danger"});break;case"BankSaveAdd":if(n={isAdd:"add"==this.props.cardStatus},!this.getValueFromForm(n))return;n.mainPk=this.props.mainPk,(0,s.ajax)({url:p,data:n,success:function(e){a.props.form.EmptyAllFormValue(a.props.formId1),a.props.form.EmptyAllFormValue(a.props.formId2),a.props.cardTable.setTableData(a.props.cardTableId,{rows:[]}),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId1,"edit")},1),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId2,"edit")},1),setTimeout(function(){return a.props.cardTable.setStatus(a.props.cardTableId,"edit")},1),a.cardStatus="add",setTimeout(function(){return a.updateButtonStatus()},1),(0,s.ajax)({url:f,data:{pk_country:a.props.form.getFormItemsValue("customer","pk_country").value,operation:"bankinfo"},success:function(e){if(e.data.pk_currtype){a.props.cardTable.addRow(a.props.cardTableId,0,{pk_currtype:{value:e.data.pk_currtype,display:e.data.currtypename}});var t=a.props.form.getFormItemsValue("customer","name");a.props.form.setFormItemsValue(a.props.formId1,{accname:{value:t.name.value,display:t.name.display}})}}})}});break;default:console.log(t,index)}}},{key:"onAfterEvent",value:function(e,t,a,n,r){var o=this;if(null==r||null==r.value||r.value&&n.value!=r.value)if("pk_banktype"==a){var i=e.meta.getMeta();i.accbasinfo.items.find(function(e){return"pk_bankdoc"==e.attrcode}).queryCondition=function(){return{pk_banktype:n.value}},e.meta.setMeta(i)}else"pk_bankdoc"==a&&(n&&n.value?(0,s.ajax)({url:f,data:{operation:"bankdoc",primaryKey:n.value},success:function(e){if(e.data){var t={pk_banktype:{value:e.data.value,display:e.data.display}};o.props.form.setFormItemsValue(o.formId1,t),o.props.form.setFormItemsDisabled(o.formId1,{pk_banktype:!0})}}}):(this.props.form.setFormItemsDisabled(this.formId1,{pk_banktype:!1}),this.props.form.setFormItemsValue(this.formId1,{pk_banktype:{value:null,display:null}})))}},{key:"getValueFromForm",value:function(e){if(!this.props.form.isCheckNow([this.props.formId1,this.props.formId2]))return!1;var t=this.props.form.getAllFormValue(this.props.formId1),a=this.props.form.getAllFormValue(this.props.formId2);delete t.rows[0].values.bankaccsub,delete a.rows[0].values.bankaccsub,e.form1={model:t},e.form2={model:a},e.cardTable={model:{rows:this.props.cardTable.getVisibleRows(this.props.cardTableId)}};var n=this.props.cardTable.getAllRows(this.props.cardTableId);return null!=n&&0!=n.length||((0,s.toast)({color:"danger",content:this.props.json["10140CUSTPF-000013"]}),!1)}},{key:"render",value:function(){var e=this,t=this.props,a=t.cardTable,n=t.form,r=t.button,s=t.modal,i=(t.cardPagination.createCardPagination,n.createForm),l=a.createCardTable,p=r.createButtonApp,d=(r.createButton,s.createModal),f=this.state.showAccbase?"icon-jiantouxia1":"icon-jiantouyou",m=this.state.showAccbase?"show-form":"hide-form",b=this.state.showNetBank?"icon-jiantouxia1":"icon-jiantouyou",h=this.state.showNetBank?"show-form":"hide-form";return o.default.createElement("div",{id:"nc-bill-card"},o.default.createElement("div",{className:"nc-bill-card"},o.default.createElement(u,null,o.default.createElement("div",{className:"nc-bill-header-area"},o.default.createElement(c,{className:"title-search-detail",style:{"line-height":"32px",display:this.state.backVisible?"inline":"none"},onClick:this.buttonClick.bind(this,this.props,"BankBack")}),o.default.createElement("div",{className:"header-button-area"},p({area:"bank-action",onButtonClick:this.buttonClick.bind(this)})))),o.default.createElement("div",{className:"nc-bill-form-area"},o.default.createElement("div",{className:"group-form-wrapper"},o.default.createElement("div",{className:"group-form-name"},o.default.createElement("span",{className:"toggle-form-icon iconfont "+f,onClick:function(){var t=!e.state.showAccbase;e.setState({showAccbase:t})}}),o.default.createElement("span",{className:"name"},this.props.json["10140CUSTPF-000014"])),o.default.createElement("div",{className:"group-form-item "+m+" "},i(this.props.formId1,{onAfterEvent:this.onAfterEvent.bind(this)}))),o.default.createElement("div",{className:"group-form-wrapper"},o.default.createElement("div",{className:"group-form-name"},o.default.createElement("span",{className:"toggle-form-icon iconfont "+b,onClick:function(){var t=!e.state.showNetBank;e.setState({showNetBank:t})}}),o.default.createElement("span",{className:"name"},this.props.json["10140CUSTPF-000015"])),o.default.createElement("div",{className:"group-form-item "+h+" "},i(this.props.formId2,{})))),o.default.createElement("div",{className:"nc-bill-table-area"},l(this.tableId,{tableHead:this.getTableHead.bind(this),showIndex:!0,showCheck:!0})),d("delete",{title:this.props.json["10140CUSTPF-000016"],content:this.props.json["10140CUSTPF-000017"],beSureBtnClick:this.delConfirm.bind(this)}),d("modal",{})))}}]),t}();t.default=m},261:function(e,t,a){e.exports=a(252)},5:function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var a=function(e,t){var a=e[1]||"",n=e[3];if(!n)return a;if(t&&"function"==typeof btoa){var r=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(n),o=n.sources.map(function(e){return"/*# sourceURL="+n.sourceRoot+e+" */"});return[a].concat(o).concat([r]).join("\n")}return[a].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+a+"}":a}).join("")},t.i=function(e,a){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},r=0;r<this.length;r++){var o=this[r][0];"number"==typeof o&&(n[o]=!0)}for(r=0;r<e.length;r++){var s=e[r];"number"==typeof s[0]&&n[s[0]]||(a&&!s[2]?s[2]=a:a&&(s[2]="("+s[2]+") and ("+a+")"),t.push(s))}},t}},6:function(e,t,a){var n={},r=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),o=function(e){var t={};return function(e){return void 0===t[e]&&(t[e]=function(e){return document.querySelector(e)}.call(this,e)),t[e]}}(),s=null,i=0,l=[],u=a(148);function c(e,t){for(var a=0;a<e.length;a++){var r=e[a],o=n[r.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++)o.parts[s](r.parts[s]);for(;s<r.parts.length;s++)o.parts.push(h(r.parts[s],t))}else{var i=[];for(s=0;s<r.parts.length;s++)i.push(h(r.parts[s],t));n[r.id]={id:r.id,refs:1,parts:i}}}}function p(e,t){for(var a=[],n={},r=0;r<e.length;r++){var o=e[r],s=t.base?o[0]+t.base:o[0],i={css:o[1],media:o[2],sourceMap:o[3]};n[s]?n[s].parts.push(i):a.push(n[s]={id:s,parts:[i]})}return a}function d(e,t){var a=o(e.insertInto);if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===e.insertAt)n?n.nextSibling?a.insertBefore(t,n.nextSibling):a.appendChild(t):a.insertBefore(t,a.firstChild),l.push(t);else{if("bottom"!==e.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");a.appendChild(t)}}function f(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function m(e){var t=document.createElement("style");return e.attrs.type="text/css",b(t,e.attrs),d(e,t),t}function b(e,t){Object.keys(t).forEach(function(a){e.setAttribute(a,t[a])})}function h(e,t){var a,n,r,o;if(t.transform&&e.css){if(!(o=t.transform(e.css)))return function(){};e.css=o}if(t.singleton){var l=i++;a=s||(s=m(t)),n=v.bind(null,a,l,!1),r=v.bind(null,a,l,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(a=function(e){var t=document.createElement("link");return e.attrs.type="text/css",e.attrs.rel="stylesheet",b(t,e.attrs),d(e,t),t}(t),n=function(e,t,a){var n=a.css,r=a.sourceMap,o=void 0===t.convertToAbsoluteUrls&&r;(t.convertToAbsoluteUrls||o)&&(n=u(n));r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var s=new Blob([n],{type:"text/css"}),i=e.href;e.href=URL.createObjectURL(s),i&&URL.revokeObjectURL(i)}.bind(null,a,t),r=function(){f(a),a.href&&URL.revokeObjectURL(a.href)}):(a=m(t),n=function(e,t){var a=t.css,n=t.media;n&&e.setAttribute("media",n);if(e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}.bind(null,a),r=function(){f(a)});return n(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;n(e=t)}else r()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||(t.singleton=r()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var a=p(e,t);return c(a,t),function(e){for(var r=[],o=0;o<a.length;o++){var s=a[o];(i=n[s.id]).refs--,r.push(i)}e&&c(p(e,t),t);for(o=0;o<r.length;o++){var i;if(0===(i=r[o]).refs){for(var l=0;l<i.parts.length;l++)i.parts[l]();delete n[i.id]}}}};var k=function(){var e=[];return function(t,a){return e[t]=a,e.filter(Boolean).join("\n")}}();function v(e,t,a,n){var r=a?"":n.css;if(e.styleSheet)e.styleSheet.cssText=k(t,r);else{var o=document.createTextNode(r),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(o,s[t]):e.appendChild(o)}}}})});
//# sourceMappingURL=index.557bd6d0.js.map