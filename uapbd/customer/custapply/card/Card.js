(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[2],{252:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s,r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},n=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),l=a(2),i=d(l),u=(d(a(131)),a(254)),c=a(1),p=d(a(233));function d(e){return e&&e.__esModule?e:{default:e}}function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}c.base.NCBackBtn;var f=c.base.NCAffix,b=(c.base.NCPopconfirm,c.base.NCFormControl,c.base.NCAnchor),k=c.base.NCScrollElement,h=c.base.NCScrollLink,v=c.high.PrintOutput,C=c.high.NCUploader,g=c.high.ApproveDetail,y=c.cardCache.setDefData,S=(c.cardCache.getDefData,c.cardCache.addCache,c.cardCache.getCacheById,c.cardCache.updateCache,c.cardCache.getCurrentLastId),T=(c.cardCache.getNextId,c.cardCache.deleteCacheById,"customerpf"),w="bankaccsub",_="10140CUSTPF_custpfcard",B="search",I="10140CUSTPF",P="/nccloud/uapbd/customer/CustApplyCardQuery.do",E="/nccloud/uapbd/customer/CustApplyUpdate.do",F="/nccloud/uapbd/supbanken/enableSupbankenCard.do",A="/nccloud/uapbd/customer/CustApplyCommit.do",j="/nccloud/uapbd/customer/CustApplyCallback.do",V="/nccloud/uapbd/customer/CustApplyCardPrint.do",D="pk_customerpf",U=["custapplybanks","custtaxtypes","custcontacts","finance","sale","creditctl","bankaccsub"],N=["pk_org","destorg","pk_country","custprop"];function x(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.getUrlParam("showBtn"),s=e.getUrlParam("status");s="add"==s||"edit"==s?"edit":"browse";if(a&&"false"==a)e.button.setButtonVisible(["Edit","Add","Delete","Refresh","Query","PrintGrp","Print","Output","CommitGrp","Commit","Callback","Bankacc","Back","Attment","ApproveInfo","Save","Cancel","AddLine","DelLine"],!1),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1);else if(t)e.button.setButtonVisible(["Edit","Save","Cancel","AddLine","DelLine","Delete","Refresh","Query","PrintGrp","Print","Output","CommitGrp","Commit","Callback","Bankacc","Back","Attment","ApproveInfo"],!1),e.button.setButtonVisible(["Add"],!0);else{"edit"==s||"add"==s?(e.button.setButtonVisible(["Edit","Add","Delete","Refresh","Query","PrintGrp","Print","Output","CommitGrp","Commit","Callback","Bankacc","Back","Attment","ApproveInfo"],!1),e.button.setButtonVisible(["Save","Cancel","AddLine","DelLine"],!0),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1)):(e.button.setButtonVisible(["Save","Cancel","AddLine","DelLine","Back","Print","Commit"],!1),e.button.setButtonVisible(["Edit","Add","Delete","Refresh","Query","PrintGrp","Output","CommitGrp","Callback","Bankacc","Attment","ApproveInfo"],!0),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!0));var r=e.form.getFormItemsValue(T,"approvestate").value;"-1"==r?(e.button.setButtonDisabled(["CommitGrp","Edit","Delete","Bankacc"],!1),e.button.setButtonVisible(["Callback","ApproveInfo"],!1)):"3"==r||"1"==r?(e.button.setButtonVisible(["CommitGrp","Edit","Delete","Bankacc"],!1),e.button.setButtonDisabled(["Callback","ApproveInfo"],!1)):(e.button.setButtonVisible(["CommitGrp","Callback","Edit","Delete","Bankacc"],!1),e.button.setButtonDisabled("ApproveInfo",!1))}e.BillHeadInfo.setBillHeadInfoVisible({showBackBtn:"browse"===s}),setTimeout(function(){return e.form.setFormStatus(T,s)},1),setTimeout(function(){return e.form.setFormStatus("customer",s)},1),U.forEach(function(t){"finance"!=t&&"sale"!=t&&"creditctl"!=t&&e.cardTable.setStatus(t,s)}),window.onbeforeunload="add"!=s&&"edit"!=s?null:function(){return""}}var O=(s=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.call(a),a.formId=T,a.searchId=B,a.tableId=w,a.state={pk_org:"",title_code:"",totalcount:0,applycount:0,showBaseInfo:!0,isList:!0,showApprove:!1,approveDetailShow:!1,billid:null,billNumInitState:null,curOrg:"",json:{}},a.bankaccConfig={tableId:"custbank",formId1:"accbasinfo",formId2:"netbankinfo",cardTableId:"bankaccsub",mainPk:a.props.getUrlParam("id"),bankaccModalChange:a.bankaccModalChange.bind(a)},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),n(t,[{key:"modifierMeta",value:function(e,t){var a=this,s=e.getUrlParam("status");return t[T].status=s,t.accbasinfo.items.find(function(e){return"accnum"==e.attrcode}).reg=new RegExp("^\\d*$"),t.custcontacts.items.find(function(e){return"pk_linkman"==e.attrcode}).form=e.form,t.custcontacts.items.forEach(function(e){e.attrcode.indexOf("pk_linkman")>=0&&"pk_linkman.sex"!=e.attrcode&&(e.refcode="uapbd/refer/linkman/LinkmanFormRefer/index")}),t.custcontacts_edit.items.find(function(e){return"pk_linkman"==e.attrcode}).form=e.form,t.custcontacts_edit.items.forEach(function(e){e.attrcode.indexOf("pk_linkman")>=0&&"pk_linkman.sex"!=e.attrcode&&(e.refcode="uapbd/refer/linkman/LinkmanFormRefer/index")}),t[T].items=t[T].items.map(function(e,t){return"pk_org"==e.attrcode&&(e.queryCondition={AppCode:I,TreeRefActionExt:"nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder"}),e}),U.forEach(function(s){var r={itemtype:"customer",attrcode:"opr",label:a.state.json["10140CUSTPF-000019"],visible:!0,className:"table-opr",width:200,fixed:"right",render:function(t,a,r){var o=e.cardTable.getStatus(s),n="browse"===o?["Spread"]:["Detail"];return s==w&&(n=[]),["finance","sale","creditctl"].includes(s)||"browse"==o||n.push("Delline"),"custapplybanks"==s&&(n=[]),e.button.createOprationButton(n,{area:"table-opr-area",buttonLimit:3,onButtonClick:function(e,t){return function(e,t,a,s,r,o){switch(t){case"Spread":e.cardTable.toggleRowView(o,s);break;case"Detail":e.cardTable.openModel(o,"edit",s,r);break;case"Delline":e.cardTable.delRowsByIndex(o,r);break;default:console.log(t,r)}}(e,t,0,a,r,s)}})}};t[s].items.push(r)}),t}},{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140CUSTPF",domainName:"uapbd",callback:function(t,a,s){a&&e.setState({json:t,inlt:s},function(){e.initTemplate(e.props,function(){e.props.form.setFormStatus(e.formId,"edit");var t=e.props.getUrlParam("status");if("add"!=t){var a=e.props.getUrlParam("id");e.getdata(a,function(a){var s=e.props.getUrlParam("codeedit"),r=e.props.getUrlParam("vbillnumedit");"edit"==t&&(e.props.form.setFormItemsDisabled(e.formId,{billnumber:!r}),e.props.form.setFormItemsDisabled("customer",{code:!s})),"edit"==t||"add"==t?e.updateSpeTableBtnStatus(a,"edit"):e.updateSpeTableBtnStatus(a)})}else e.setDefaultValue(void 0,function(){e.props.form.setFormItemsValue(T,{pk_org:{value:e.state.curOrg.refpk,display:e.state.curOrg.refname}}),e.afterEvent(e.props,T,"pk_org",e.state.curOrg),e.updateSpeTableBtnStatus(-1,"edit")})})})}})}},{key:"pfProcess",value:function(e,t){var a=this,s={pks:[this.props.getUrlParam("id")],content:t};(0,c.ajax)({url:e,data:s,success:function(t){e==A?!t.data.workflow||"approveflow"!=t.data.workflow&&"workflow"!=t.data.workflow?((0,c.toast)({color:"success",content:a.state.json["10140CUSTPF-000020"]}),a.setState({compositedata:null,compositedisplay:!1}),a.getdata(a.props.getUrlParam("id"),function(e){a.updateSpeTableBtnStatus(e)})):a.setState({compositedata:t.data,compositedisplay:!0}):e==j&&((0,c.toast)({content:a.state.json["10140CUSTPF-000021"],color:"success"}),a.getdata(a.props.getUrlParam("id"),function(e){a.updateSpeTableBtnStatus(e)}))}})}},{key:"updateSpeTableBtnStatus",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"browse",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{finance:"browse",sale:"browse",creditctl:"browse"},s=["Finan","Sale","Credit"],r=["FinanceRefresh","SaleRefresh","CreditctlRefresh"],o={};["finance","sale","creditctl"].forEach(function(n,l){var i=a[n];"edit"==t||"add"==t||-1!=e?(o[s[l]+"Edit"]=!1,o[s[l]+"Save"]=!1,o[s[l]+"Cancel"]=!1,o[r[l]]=!1):"edit"==i||"add"==i?(o[s[l]+"Edit"]=!1,o[s[l]+"Save"]=!0,o[s[l]+"Cancel"]=!0,o[r[l]]=!1):(o[s[l]+"Edit"]=!0,o[s[l]+"Save"]=!1,o[s[l]+"Cancel"]=!1,o[r[l]]=!0)}),this.props.button.setButtonVisible(o)}},{key:"speTableEdit",value:function(e){var t=this,a=[this.state.json["10140CUSTPF-000049"],this.state.json["10140CUSTPF-000050"],this.state.json["10140CUSTPF-000051"]],s=!1,r={};["finance","sale","creditctl"].forEach(function(o,n){if(e!=o){if(r[o]="browse","edit"==t.props.cardTable.getStatus(o)&&!s)return(0,c.toast)({color:"warning",content:a[n]}),void(s=!0)}else r[o]="edit"}),s||(this.props.cardTable.setStatus(e,"edit"),this.updateSpeTableBtnStatus(-1,"browse",r))}},{key:"getTableHeadSpe",value:function(e){var t=this.props.button.createButtonApp;return i.default.createElement("div",{className:"shoulder-definition-area"},i.default.createElement("div",{className:"definition-icons",style:{padding:"0px"}},t({area:e+"-action",onButtonClick:this.buttonClick.bind(this)})))}},{key:"onCardTableAfterEvent",value:function(e,t,a,s,r,o,n){if(r[0].newvalue.value!=r[0].oldvalue.value){var l={};l.value=n.values.pk_region.value,l.display=n.values.pk_region.display,e.cardTable.setValByKeyAndIndex(this.tableId,o,"pk_region.name",l),n.values.pk_region.display=s.refcode}}},{key:"showApprove",value:function(){this.setState({showApprove:!0})}},{key:"closeApprove",value:function(){this.setState({showApprove:!1})}},{key:"bankaccClick",value:function(e,t){switch(t){case"BankAdd":this.setState({isList:!1})}}},{key:"bankaccModalChange",value:function(e){var t=e.isList;delete e.isList,t?(this.bankaccConfig=o({tableId:"custbank",formId1:"accbasinfo",formId2:"netbankinfo",cardTableId:"bankaccsub",mainPk:this.props.getUrlParam("id"),bankaccModalChange:this.bankaccModalChange.bind(this)},e),this.props.modal.close("bankaccList"),this.props.modal.show("bankaccForm")):(this.bankaccConfig={tableId:"custbank",formId1:"accbasinfo",formId2:"netbankinfo",cardTableId:"bankaccsub",mainPk:this.props.getUrlParam("id"),bankaccModalChange:this.bankaccModalChange.bind(this)},this.props.modal.close("bankaccForm"),this.props.modal.show("bankaccList"))}},{key:"linkmanClose",value:function(e){e.cardTable.getAllRows("custcontacts").forEach(function(e){2==e.status&&e.values.forEach(function(e){e.display=e.value})})}},{key:"cardTableDoubleClick",value:function(e,t,a){if("edit"==e.form.getFormStatus(this.formId)){var s=t.values.pk_linkman.value;(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyQueryLinkman.do",data:{pk:s},success:function(t){e.modal.show("linkman"),e.form.setAllFormValue({Linkman:t.data.Linkman}),e.form.setFormStatus("Linkman","edit")}})}}},{key:"linkmanSaveClick",value:function(){var e=this,t=this.props.form.getAllFormValue("Linkman"),a={model:t},s=["name","sex","vjob","phone","cell"],r=this.props.cardTable.getAllRows("custcontacts");(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplySaveLinkman.do",data:a,success:function(a){var o=!1,n=a.data;if(r.forEach(function(e){e.values.pk_linkman.value==n&&(s.forEach(function(a){e.values["pk_linkman."+a].display=t.rows[0].values[a].value}),e.values.pk_linkman.value=n,o=!0)}),!o){var l={};s.forEach(function(a){if(l["pk_linkman."+a]={value:t.rows[0].values[a].value,display:t.rows[0].values[a].value},"sex"==a){var s=t.rows[0].values[a].value;l["pk_linkman."+a].display=s&&"1"==s?e.state.json["10140CUSTPF-000031"]:e.state.json["10140CUSTPF-000032"]}}),l.pk_linkman={value:n,display:t.rows[0].values.name.value};var i={rowid:n,status:2,values:l};r.push(i)}e.props.cardTable.setTableData("custcontacts",{rows:r})}})}},{key:"onLinkmanBeforeEvent",value:function(e,t,a,s,r,o,n){var l=e.meta.getMeta();return"model"==n&&(t="custcontacts_edit"),o.values.pk_linkman.value?(this.editLinkmanPk=o.values.pk_linkman.value,l[t].items.find(function(e){return"pk_linkman"==e.attrcode}).queryCondition=function(){return{pk_linkman:o.values.pk_linkman.value}}):(l[t].items.find(function(e){return"pk_linkman"==e.attrcode}).queryCondition=function(){return{}},this.editLinkmanPk=null),this.linkmanIndex=r,l[t].items.find(function(e){return"pk_linkman"==e.attrcode}).onAfterEdit=this.onLinkmanAfterEdit.bind(this),!0}},{key:"onLinkmanAfterEdit",value:function(e){var t=this,a=["name","sex","vjob","phone","cell"],s=this.props.cardTable.getAllRows("custcontacts"),r=e.linkmanRefer.rows[0].values.pk_linkman.value;s.forEach(function(s,o){var n=s.values.pk_linkman.value;n!=r&&(null!=n&&""!=n||o!=t.linkmanIndex)||(a.forEach(function(a){"sex"==a?(s.values["pk_linkman."+a].value=e.linkmanRefer.rows[0].values[a].value,e.linkmanRefer.rows[0].values[a].value&&(s.values["pk_linkman."+a].display=1==e.linkmanRefer.rows[0].values[a].value?t.state.json["10140CUSTPF-000031"]:t.state.json["10140CUSTPF-000032"])):"name"==a?(s.values.pk_linkman.value=e.linkmanRefer.rows[0].values[a].value,s.values.pk_linkman.display=e.linkmanRefer.rows[0].values[a].value,delete s.values.pk_linkman.isEdit):(s.values["pk_linkman."+a].value=e.linkmanRefer.rows[0].values[a].value,s.values["pk_linkman."+a].display=e.linkmanRefer.rows[0].values[a].value)}),s.values.pk_linkman.value=r)}),this.props.cardTable.setTableData("custcontacts",{rows:s})}},{key:"resetDeptAndPsnRef",value:function(e,t,a,s,r,o,n){var l=this.props.meta.getMeta(),i="model"==n?t+"_edit":t;return"finance"==t&&(l[i].items.find(function(e){return"pk_respdept1"==e.attrcode}).queryCondition=function(){return{pk_org:o.values.pk_org.value}},l.finance.items.find(function(e){return"pk_resppsn1"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.pk_respdept1&&o.values.pk_respdept1.value&&""!=o.values.pk_respdept1.value&&(e.pk_dept=o.values.pk_respdept1.value),e},l.finance_edit.items.find(function(e){return"pk_resppsn1"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.pk_respdept1&&o.values.pk_respdept1.value&&""!=o.values.pk_respdept1.value&&(e.pk_dept=o.values.pk_respdept1.value),e}),"sale"==t&&(l[i].items.find(function(e){return"respdept"==e.attrcode}).queryCondition=function(){return{pk_org:o.values.pk_org.value}},l.sale.items.find(function(e){return"respperson"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.respdept&&o.values.respdept.value&&""!=o.values.respdept.value&&(e.pk_dept=o.values.respdept.value),e},l.sale_edit.items.find(function(e){return"respperson"==e.attrcode}).queryCondition=function(){var e={pk_org:o.values.pk_org.value};return o&&o.values&&o.values.respdept&&o.values.respdept.value&&""!=o.values.respdept.value&&(e.pk_dept=o.values.respdept.value),e}),this.props.meta.setMeta(l),!0}},{key:"onSpeCardTableAfterEvent",value:function(e,t,a,s,r,o,n){r[0].newvalue.value!=r[0].oldvalue.value&&("pk_resppsn1"==a&&"finance"==t?this.props.cardTable.setValByKeyAndIndex(t,o,"pk_respdept1",{value:s.values.pk_dept.value,display:s.values.deptname.values}):"respperson"==a&&"sale"==t&&this.props.cardTable.setValByKeyAndIndex(t,o,"respdept",{value:s.values.pk_dept.value,display:s.values.deptname.values}))}},{key:"onReturnClick",value:function(){this.props.pushTo("/list",{pagecode:"10140CUSTPF_custpflist",appcode:I,status:"browse"})}},{key:"render",value:function(){var e=this,t=this.props,a=t.cardTable,s=t.form,r=t.button,o=t.modal,n=t.cardPagination,l=t.BillHeadInfo,c=n.createCardPagination,d=l.createBillHeadInfo,m=s.createForm,y=a.createCardTable,S=r.createButtonApp,T=(r.createButton,o.createModal),w=this.props.getUrlParam("status"),_=this.state.showBaseInfo?"icon-jiantouxia1":"icon-jiantouyou",B=this.state.showBaseInfo?"show-form":"hide-form";return i.default.createElement("div",{className:"nc-bill-card"},i.default.createElement("div",{className:"nc-bill-top-area"},i.default.createElement(f,null,i.default.createElement("div",{className:"nc-bill-header-area"},i.default.createElement("div",{className:"header-title-search-area"},d({backBtnClick:this.onReturnClick.bind(this)}),i.default.createElement("h2",{className:"title-search-detail"},this.state.json["10140CUSTPF-000001"],"browse"==w?"："+this.state.title_code:"")),i.default.createElement("div",{className:"header-button-area"},S({area:"header-button-area",onButtonClick:this.buttonClick.bind(this)}),c({handlePageInfoChange:this.pageInfoClick.bind(this)})))),i.default.createElement(b,null,i.default.createElement(h,{to:this.formId,spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000000"])),i.default.createElement(h,{to:"custapplybanks",spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000003"])),i.default.createElement(h,{to:"custcontacts",spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000005"])),i.default.createElement(h,{to:"custtaxtypes",spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000004"])),i.default.createElement(h,{to:"finance",spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000006"])),i.default.createElement(h,{to:"sale",spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000007"])),i.default.createElement(h,{to:"creditctl",spy:!0,smooth:!0,duration:300,offset:-100},i.default.createElement("p",null,this.state.json["10140CUSTPF-000008"]))),i.default.createElement(k,{name:this.formId},i.default.createElement("div",{className:"nc-bill-form-area"},m(this.formId,{onAfterEvent:this.afterEvent.bind(this)}))),i.default.createElement(k,{name:this.state.json["10140CUSTPF-000000"]},i.default.createElement("div",{className:"nc-bill-form-area"},i.default.createElement("div",{className:"group-form-wrapper"},i.default.createElement("div",{className:"group-form-name"},i.default.createElement("span",{className:"toggle-form-icon iconfont "+_,onClick:function(){var t=!e.state.showBaseInfo;e.setState({showBaseInfo:t})}}),i.default.createElement("span",{className:"name"},this.state.json["10140CUSTPF-000000"])),i.default.createElement("div",{className:"group-form-item "+B+" "},m("customer",{onAfterEvent:this.afterEvent.bind(this)})))))),i.default.createElement("div",{className:"nc-bill-bottom-area"},i.default.createElement(k,{name:"custapplybanks"},i.default.createElement("div",{className:"nc-bill-table-area"},y("custapplybanks",{}))),i.default.createElement(k,{name:"custcontacts"},i.default.createElement("div",{className:"nc-bill-table-area"},y("custcontacts",{tableHead:this.getTableHead.bind(this,"custcontacts"),onBeforeEvent:this.onLinkmanBeforeEvent.bind(this),modelClose:this.linkmanClose.bind(this)}))),i.default.createElement(k,{name:"custtaxtypes"},i.default.createElement("div",{className:"nc-bill-table-area"},y("custtaxtypes",{tableHead:this.getTableHead.bind(this,"custtaxtypes")}))),i.default.createElement(k,{name:"finance"},i.default.createElement("div",{className:"nc-bill-table-area"},y("finance",{tableHead:this.getTableHeadSpe.bind(this,"finance"),onBeforeEvent:this.resetDeptAndPsnRef.bind(this),onAfterEvent:this.onSpeCardTableAfterEvent.bind(this),hideAdd:!0,hideDel:!0,hideModelSave:!0}))),i.default.createElement(k,{name:"sale"},i.default.createElement("div",{className:"nc-bill-table-area"},y("sale",{tableHead:this.getTableHeadSpe.bind(this,"sale"),onBeforeEvent:this.resetDeptAndPsnRef.bind(this),onAfterEvent:this.onSpeCardTableAfterEvent.bind(this),hideAdd:!0,hideDel:!0,hideModelSave:!0}))),i.default.createElement(k,{name:"creditctl"},i.default.createElement("div",{className:"nc-bill-table-area"},y("creditctl",{tableHead:this.getTableHeadSpe.bind(this,"creditctl"),hideAdd:!0,hideDel:!0,hideModelSave:!0}))),T("delete",{title:this.state.json["10140CUSTPF-000016"],content:this.state.json["10140CUSTPF-000017"],beSureBtnClick:this.delConfirm.bind(this)}),(0,u.createBankaccList)(Object.assign({json:this.state.json},this.props),this.bankaccConfig),(0,u.createBankaccForm)(Object.assign({json:this.state.json},this.props),this.bankaccConfig),T("linkman",{title:this.state.json["10140CUSTPF-000033"],content:m("Linkman",{}),beSureBtnClick:this.linkmanSaveClick.bind(this)})),i.default.createElement(v,{ref:"printOutput",url:V,data:{funcode:"10140CUSTPF",nodekey:"custpfcard",oids:this.state.ids,outputType:"output"}}),this.state.showlogoUploader&&i.default.createElement(C,{billId:"uapbd/6d6d4a15-d9bb-4b0c-9da3-80760872bf87/"+this.props.getUrlParam("id"),placement:"bottom_right",multiple:!1,onHide:this.onHideUploader.bind(this)}),this.state.compositedisplay?i.default.createElement(p.default,{title:this.state.json["10140CUSTPF-000034"],data:this.state.compositedata,display:this.state.compositedisplay,getResult:this.getAssginUsedr.bind(this),cancel:this.turnOff.bind(this)}):"",i.default.createElement(g,{show:this.state.approveDetailShow,close:this.closeApprove.bind(this),billtype:"10KH",billid:this.state.billid}))}}]),t}(),r=function(){var e=this;this.initTemplate=function(t,a){t.createUIDom({pagecode:_},function(s){if(s){if(s.template){var r=s.template;e.modifierMeta(t,r),t.meta.setMeta(r)}if(s.button){var o=s.button;t.button.setButtons(o),x(t)}s.context&&s.context.pk_org&&s.context.org_Name&&(e.state.curOrg={refname:s.context.org_Name,refpk:s.context.pk_org}),a&&a()}})},this.setDefaultValue=function(t,a){t&&(t.preBillCode=e.preBillCode,t.preCustCode=e.preCustCode,t.hasPreBillCode=e.hasPreBillCode,t.hasPreCustCode=e.hasPreCustCode),(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyAdd.do",data:t,success:function(t){if(t.data){e.props.form.setAllFormValue(m({},e.formId,t.data[e.formId][e.formId])),e.props.form.setAllFormValue(m({},"customer",t.data.customer.customer)),e.setItemsProperty(t),e.preBillCode=t.data.preBillCode,e.preCustCode=t.data.preCustCode,e.hasPreBillCode=t.data.hasPreBillCode,e.hasPreCustCode=t.data.hasPreCustCode;var s=t.data.customer.customer.rows[0].values.pk_org.value,r=e.props.meta.getMeta();["pk_areacl","pk_custclass","pk_customer_main","pk_supplier"].forEach(function(e){r.customer.items.find(function(t){return t.attrcode==e}).queryCondition=function(){return{pk_org:s}}}),e.props.meta.setMeta(r)}a&&a()},error:function(e){(0,c.toast)({color:"danger",content:e.message})}})},this.setItemsProperty=function(t){var a=t.data[e.formId][e.formId].rows[0],s=t.data.customer.customer.rows[0],r=a.values.pk_org,o=(a.values.billnumber,a.values.destorg),n=s.values.custprop,l="Y"==t.data.billnumberIsEditable;e.props.form.setFormItemsDisabled(e.formId,{billnumber:!l});var i="Y"==t.data.cstBillNumCanEdit;if(e.props.form.setFormItemsDisabled("customer",{code:!i}),l?null!=e.state.billNumInitState&&e.props.form.setFormItemsRequired(e.formId,{billnumber:e.state.billNumInitState}):(null==e.state.billNumInitState&&(e.state.billNumInitState=e.props.form.getFormItemsRequired(e.formId,"billnumber")),e.props.form.setFormItemsRequired(e.formId,{billnumber:!1})),r&&o){var u=null!=r.value&&"0"==o.value;e.props.form.setFormItemsDisabled("customer",{custprop:u})}if(n){var c="1"==n.value;e.props.form.setFormItemsRequired("customer",{pk_financeorg:c}),e.props.form.setFormItemsDisabled("customer",{pk_financeorg:!c});var p=e.props.meta.getMeta();p&&null!=p&&null!=p.customer&&(p.customer.items=p.customer.items.map(function(e){return"pk_financeorg"==e.attrcode&&(e.queryCondition={AppCode:I,TreeRefActionExt:"nccloud.web.uapbd.customer.custapply.ref.BusinessUnitTreeRefExt"}),e}),e.props.meta.setMeta(p))}},this.getAssginUsedr=function(t){e.pfProcess(A,t)},this.turnOff=function(){e.setState({compositedata:null,compositedisplay:!1})},this.buttonClick=function(t,a){switch(a){case"Add":t.form.EmptyAllFormValue("customer"),t.form.EmptyAllFormValue(e.formId),U.forEach(function(e){setTimeout(function(){return t.cardTable.setTableData(e,{rows:[]})},1)}),t.setUrlParam({pagecode:_,appcode:I,status:"add"}),e.setDefaultValue(void 0,function(){e.props.form.setFormItemsValue(e.formId,{pk_org:{value:e.state.curOrg.refpk,display:e.state.curOrg.refname}}),e.afterEvent(t,T,"pk_org",e.state.curOrg),x(t),e.updateSpeTableBtnStatus(-1,"edit")});break;case"Edit":e.valid(t,"edit",e.edit.bind(e,t));break;case"Delete":(0,c.promptBox)({color:"warning",title:e.state.json["10140CUSTPF-000022"],content:e.state.json["10140CUSTPF-000023"],beSureBtnClick:e.delConfirm.bind(e)});break;case"Save":e.saveClick(t);break;case"Enable":var s=t.form.getAllFormValue(e.formId),r={isEnable:!0,list:[]},o={pk_bankaccbas:s.rows[0].values.pk_bankaccbas.value,pk_custbank:s.rows[0].values.pk_custbank.value,pk_cust:s.rows[0].values.pk_cust.value};r.list.push(o),(0,c.ajax)({url:F,data:r,success:function(t){e.getdata(o.pk_custbank,o.pk_bankaccbas,o.pk_cust),(0,c.toast)({color:"success",title:e.state.json["10140CUSTPF-000024"]})}});break;case"Disable":s=t.form.getAllFormValue(e.formId),r={isEnable:!1,list:[]},o={pk_bankaccbas:s.rows[0].values.pk_bankaccbas.value,pk_custbank:s.rows[0].values.pk_custbank.value,pk_cust:s.rows[0].values.pk_cust.value},r.list.push(o),(0,c.ajax)({url:F,data:r,success:function(t){e.getdata(o.pk_custbank,o.pk_bankaccbas,o.pk_cust),(0,c.toast)({color:"success",title:e.state.json["10140CUSTPF-000025"]})}});break;case"Back":t.pushTo("/list",{pagecode:"10140CUSTPF_custpflist",appcode:I,status:"browse"});break;case"Refresh":e.refresh(t);break;case"CommitGrp":case"Commit":e.pfProcess(A);break;case"Callback":e.pfProcess(j);break;case"Approve":e.showApprove();break;case"UnApprove":e.pfProcess(unApproveUrl);break;case"Cancel":(0,c.promptBox)({color:"warning",title:e.state.json["10140CUSTPF-000027"],content:e.state.json["10140CUSTPF-000028"],beSureBtnClick:e.Cancel.bind(e,t)});break;case"Bankacc":t.modal.show("bankaccList");break;case"PrintGrp":case"Print":e.onPrint();break;case"Output":e.onOutput();break;case"Attment":e.Attment();break;case"ApproveInfo":e.setState({approveDetailShow:!0,billid:t.form.getFormItemsValue(T,D).value});break;case"FinanEdit":e.speTableEdit("finance");break;case"SaleEdit":e.speTableEdit("sale");break;case"CreditEdit":e.speTableEdit("creditctl");break;case"FinanSave":r={};var n=t.form.getAllFormValue(e.formId),l=t.form.getAllFormValue("customer");r.CustomerPfVO=n,r.CustomerVO=l,U.forEach(function(e){"bankaccsub"!=e&&(r[e]=t.cardTable.getAllData(e))}),(0,c.ajax)({url:E,data:r,success:function(a){t.pushTo("/card",{status:"browse",id:a.data}),e.bankaccConfig.mainPk=a.data;e.getdata(a.data);e.updateSpeTableBtnStatus(),e.setState({backVisible:!0}),e.props.cardTable.setStatus("finance","browse"),e.finanTableStatus="browse"}});break;case"SaleSave":r={},n=t.form.getAllFormValue(e.formId),l=t.form.getAllFormValue("customer"),r.CustomerPfVO=n,r.CustomerVO=l,U.forEach(function(e){"bankaccsub"!=e&&(r[e]=t.cardTable.getAllData(e))}),(0,c.ajax)({url:E,data:r,success:function(a){t.pushTo("/card",{status:"browse",id:a.data}),e.bankaccConfig.mainPk=a.data;e.getdata(a.data);e.updateSpeTableBtnStatus(),e.setState({backVisible:!0}),e.props.cardTable.setStatus("sale","browse"),e.finanTableStatus="browse"}});break;case"CreditSave":r={},n=t.form.getAllFormValue(e.formId),l=t.form.getAllFormValue("customer"),r.CustomerPfVO=n,r.CustomerVO=l,U.forEach(function(e){"bankaccsub"!=e&&(r[e]=t.cardTable.getAllData(e))}),(0,c.ajax)({url:E,data:r,success:function(a){t.pushTo("/card",{status:"browse",id:a.data}),e.bankaccConfig.mainPk=a.data;e.getdata(a.data);e.updateSpeTableBtnStatus(),e.setState({backVisible:!0}),e.props.cardTable.setStatus("creditctl","browse")}});break;case"FinanCancel":e.props.cardTable.resetTableData("finance"),e.props.cardTable.setStatus("finance","browse"),e.updateSpeTableBtnStatus();break;case"SaleCancel":e.props.cardTable.resetTableData("sale"),e.props.cardTable.setStatus("purchase","browse"),e.updateSpeTableBtnStatus();break;case"CreditCancel":e.props.cardTable.resetTableData("creditctl"),e.props.cardTable.setStatus("purchase","browse"),e.updateSpeTableBtnStatus();break;case"FinanceRefresh":e.getdata(e.props.getUrlParam("id"),null,["fiance"]);break;case"SaleRefresh":e.getdata(e.props.getUrlParam("id"),null,["sale"]);break;case"CreditctlRefresh":e.getdata(e.props.getUrlParam("id"),null,["creditctl"])}},this.closeApprove=function(){e.setState({approveDetailShow:!1})},this.edit=function(t){t.setUrlParam({pagecode:_,appcode:I,status:"edit",id:t.getUrlParam("id")}),x(t),e.updateSpeTableBtnStatus(-1,"edit")},this.valid=function(t,a,s){var r={pk:t.form.getFormItemsValue(T,D).value,action:a};(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyValid.do",data:r,success:function(t){t&&t.data&&(e.props.form.setFormItemsDisabled(e.formId,{billnumber:!t.data.vbillnumedit}),e.props.form.setFormItemsDisabled("customer",{code:!t.data.codeedit}),s&&s())}})},this.Cancel=function(t){var a=S("uapbd.customer.custapply.cache");e.getdata(a,function(t){e.updateSpeTableBtnStatus(t)}),t.form.setFormStatus(e.formId,"browse"),t.form.setFormStatus("customer","browse"),U.forEach(function(e){t.cardTable.setStatus(e,"browse")}),t.setUrlParam({pagecode:_,appcode:I,status:"browse"}),x(t,""==a||null==a)},this.Attment=function(){e.state.showlogoUploader=!0,e.setState(e.state)},this.onHideUploader=function(){e.state.showlogoUploader=!1,e.setState(e.state)},this.onPrint=function(){var t=e.props.form.getAllFormValue(T);if(0!==t.length){var a=[];a.push(t.rows[0].values[D].value),(0,c.print)("pdf",V,{funcode:"10140CUSTPF",nodekey:"custpfcard",oids:a})}else(0,c.toast)({content:e.state.json["10140CUSTPF-000029"],color:"warning"})},this.onOutput=function(){var t=e.props.form.getAllFormValue(T);if(0!==t.length){var a=[];a.push(t.rows[0].values[D].value),e.setState({ids:a},e.refs.printOutput.open())}else(0,c.toast)({content:e.state.json["10140CUSTPF-000029"],color:"warning"})},this.refresh=function(t){t.setUrlParam({pagecode:_,appcode:I,status:t.getUrlParam("status"),id:t.getUrlParam("id")}),e.getdata(t.getUrlParam("id"),function(){(0,c.toast)({title:e.state.json["10140CUSTPF-000026"],color:"success"})})},this.addLineClick=function(t){e.props.cardTable.addRow(t)},this.pageInfoClick=function(e,t){var a={pk:t,pageid:_};(0,c.ajax)({url:P,data:a,success:function(a){a.data.head&&(e.form.setAllFormValue(m({},T,a.data.head[T])),e.setUrlParam(t)),a.data.body&&e.editTable.setTableData(w,a.data.body[w]),x(e)}})},this.afterEvent=function(t,a,s,r,o,n,l,i){if(N.includes(s)){var u={},c=e.props.form.getAllFormValue("customerpf"),p=e.props.form.getAllFormValue("customer");if(u.CustomerPfVO=c,u.CustomerVO=p,u.key=s,u.status=e.props.getUrlParam("status"),"pk_org"==s&&t.meta.getMeta().customer.items.forEach(function(e){["pk_custclass","pk_areacl","pk_customer_main","pk_supplier"].includes(e.attrcode)&&(e.queryCondition={pk_org:r.value})}),"destorg"==s){var d="0"==r.value;e.props.form.setFormItemsDisabled("customer",{custprop:d,pk_financeorg:d})}if("custprop"==s){var m="1"==r.value;e.props.form.setFormItemsRequired("customer",{pk_financeorg:m})}e.setDefaultValue(u)}},this.getTableHead=function(t){var a=e.props.button,s=a.createButtonApp;a.createButton;return i.default.createElement("div",{className:"shoulder-definition-area"},i.default.createElement("div",{className:"definition-icons"},s({area:"definition-icons",onButtonClick:e.addLineClick.bind(e,t)}),e.props.cardTable.createBrowseIcons(t,{iconArr:["close","open","max","setCol"],maxDestAreaId:"nc-bill-card"})))},this.getdata=function(t,a){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r={pk:t};(0,c.ajax)({url:P,data:r,success:function(r){var o=-1;if(r.data){if(r.data.head){var n,l=(m(n={},e.formId,r.data.head[e.formId]),m(n,"customer",r.data.customer.customer),n);e.props.form.setAllFormValue(l),o=r.data.head[e.formId].rows[0].values.approvestate.value}if(r.data.bodys){if(s.length>0)return void r.data.bodys.forEach(function(t,a){s.forEach(function(s){t.hasOwnProperty(s)&&e.props.cardTable.setTableData(s,r.data.bodys[a][s])})});r.data.bodys.forEach(function(t,a){U.forEach(function(s){t.hasOwnProperty(s)&&e.props.cardTable.setTableData(s,r.data.bodys[a][s])})})}}else e.props.form.EmptyAllFormValue(e.formId),e.props.form.EmptyAllFormValue("customer");x(e.props,""==t||null==t),e.setState(e.state),a&&"function"==typeof a&&a(o)}})},this.saveClick=function(t){var a="/nccloud/uapbd/customer/CustApplySave.do";"edit"===e.props.getUrlParam("status")&&(a=E);var s={};if(t.form.isCheckNow(e.formId)){var r=t.form.getAllFormValue(e.formId),o=t.form.getAllFormValue("customer");s.CustomerPfVO=r,s.CustomerVO=o,U.forEach(function(e){"bankaccsub"!=e&&(s[e]=t.cardTable.getAllData(e))});var n=e.props.meta.getMeta(),l=[];(n=n.customer.items).forEach(function(e){1==e.required&&(null!=o.rows[0].values[e.attrcode].value&&""!=o.rows[0].values[e.attrcode].value||l.push(e.label))});var i=null;l.length>0?(i=e.state.json["10140CUSTPF-000053"]+"["+l.join("],[")+"]",r.rows[0].values.memo.value=i):r.rows[0].values.memo.value=null,s.preCustCode=e.preCustCode,s.hasPreCustCode=e.hasPreCustCode,(0,c.ajax)({url:a,data:s,success:function(a){var s=a.data;t.setUrlParam({pagecode:_,appcode:I,status:"browse",id:s}),y("preid","uapbd.customer.custapply.cache",s),e.getdata(s,function(t){e.updateSpeTableBtnStatus(t,"browse")}),i?(0,c.toast)({color:"warning",content:i}):(0,c.toast)({color:"success",title:e.state.json["10140CUSTPF-000030"]})}})}},this.delConfirm=function(){(0,c.ajax)({url:"/nccloud/uapbd/customer/CustApplyDelete.do",data:{deleteinfo:[{pk_org:e.props.form.getFormItemsValue(e.formId,"pk_org").value,id:null==e.props.getUrlParam("id")?e.props.form.getFormItemsValue(e.formId,D).value:e.props.getUrlParam("id"),ts:e.props.form.getFormItemsValue(e.formId,"ts").value}]},success:function(t){t&&e.props.pushTo("/list",{pagecode:"10140CUSTPF_custpflist",appcode:I,status:"browse"})}})},this.modelSave=function(t){e.props.cardTable.closeModel(t),e.saveClick(e.props)}},s);O=(0,c.createPage)({})(O),t.default=O},254:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)Object.prototype.hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e};t.createBankaccList=function(e,t){var a=e.cardTable,r=e.form,n=e.button,l=e.modal,i=(e.cardPagination,e.table),u=(r.createForm,a.createCardTable,n.createButtonApp,i.createSimpleTable,l.createModal),c=React.createElement("div",null,React.createElement(o.default,s({},e,t)));return u("bankaccList",{content:c,noFooter:!0})},t.createBankaccForm=function(e,t){e.cardTable,e.form,e.button;var a=e.modal,r=(e.cardPagination,e.table,a.createModal),o=React.createElement("div",null,React.createElement(n.default,s({},e,t)));return r("bankaccForm",{content:o,size:"xlg",noFooter:!0})};var r=a(1),o=l(a(255)),n=l(a(256));function l(e){return e&&e.__esModule?e:{default:e}}r.base.NCAffix,r.base.NCPopconfirm,r.base.NCFormControl,r.base.NCAnchor,r.base.NCScrollElement,r.base.NCScrollLink,r.base.createModal},255:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),r=a(2),o=function(e){return e&&e.__esModule?e:{default:e}}(r),n=a(1);n.base.NCPopconfirm,n.base.NCIcon,n.base.NCTabs.NCTabPane;var l="/nccloud/uapbd/customer/CustAppDelBank.do",i=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));a.doubleClick=function(e,t,s){var r={isList:!0,cardStatus:"browse",accnum:e.accnum.value,pk_banktype:e.pk_banktype.value};a.props.bankaccModalChange&&a.props.bankaccModalChange(r)},a.onSelected=function(){},a.tableId=e.tableId,a.selectedRow=null;var s=a.props.meta.getMeta(),r=!1;return s[a.tableId].items.forEach(function(e){"opr"==e.attrcode&&(r=!0)}),e.button.setPopContent("BankListDel",a.props.json["10140CUSTPF-000052"]),r||(s[a.tableId].items.push({itemtype:"customer",attrcode:"opr",label:a.props.json["10140SPF-000019"],fixed:"right",className:"tab le-opr",visible:!0,render:function(t,s,r){return e.button.createOprationButton(["BankListEdit","BankListDel"],{area:"brow-action",buttonLimit:3,onButtonClick:function(e,o){a.tableRowButtonClick(e,o,t,s,r)}})}}),a.props.meta.setMeta(s)),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),s(t,[{key:"tableRowButtonClick",value:function(e,t,a,s,r){var o=this;switch(t){case"BankListEdit":var i={isList:!0,accnum:s.accnum.value,pk_banktype:s.pk_banktype.value,cardStatus:"edit"};this.props.bankaccModalChange&&this.props.bankaccModalChange(i);break;case"BankListDel":i={mainPk:this.props.mainPk,accnum:s.accnum.value,pk_banktype:s.pk_banktype.value},(0,n.ajax)({url:l,data:i,success:function(e){o.getData(o.props)}})}}},{key:"updateButtonStatus",value:function(){this.props.button.setButtonVisible(["BankAdd","BankRefresh"],!0),this.props.button.setButtonVisible(["BankEdit","BankDelete","BankCancel","BankSave","BankBack","BankSaveAdd"],!1)}},{key:"componentDidMount",value:function(){var e=this;this.getData(this.props),setTimeout(function(){return e.updateButtonStatus()},1)}},{key:"getData",value:function(e){var t={mainPk:e.mainPk};(0,n.ajax)({url:"/nccloud/uapbd/customer/CustAppQueryBankList.do",data:t,success:function(t){t&&t.data&&t.data.hasOwnProperty(e.tableId)?e.table.setAllTableData(e.tableId,t.data[e.tableId]):e.table.setAllTableData(e.tableId,{rows:[]})}})}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"BankAdd":var s=this.selectedRow,r={isList:!0,cardStatus:"add"};this.props.bankaccModalChange&&this.props.bankaccModalChange(r);break;case"BankEdit":s=this.selectedRow,console.log(s),r={isList:!0,accnum:s.accnum.value,pk_banktype:s.pk_banktype.value,cardStatus:"edit"},this.props.bankaccModalChange&&this.props.bankaccModalChange(r);break;case"BankDelete":s=this.selectedRow,r={mainPk:this.props.mainPk,accnum:s.accnum.value,pk_banktype:s.pk_banktype.value},(0,n.ajax)({url:l,data:r,success:function(e){a.getData(a.props)}});break;case"BankRefresh":this.getData(this.props)}}},{key:"onRowClick",value:function(e,t,a,s){this.selectedRow=a}},{key:"render",value:function(){var e=this.props,t=e.table,a=e.button,s=(e.search,t.createSimpleTable),r=a.createButtonApp;a.createButton;return o.default.createElement("div",{className:"nc-bill-list"},o.default.createElement("div",{className:"nc-bill-header-area"},o.default.createElement("div",{className:"header-title-search-area"},o.default.createElement("h2",{className:"title-search-detail"},this.props.json["10140CUSTPF-000018"])),o.default.createElement("div",{className:"header-button-area"},r({area:"bank-action",buttonLimit:3,onButtonClick:this.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),o.default.createElement("div",{style:{height:"10px"}}),o.default.createElement("div",{className:"nc-bill-table-area"},s(this.tableId,{onRowClick:this.onRowClick.bind(this),onRowDoubleClick:this.doubleClick.bind(this),showIndex:!0,onSelected:this.onSelected.bind(this),onSelectedAll:this.onSelected.bind(this)})))}}]),t}();t.default=i},256:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),r=a(2),o=l(r),n=(l(a(131)),a(1));function l(e){return e&&e.__esModule?e:{default:e}}function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var u=n.base.NCAffix,c=(n.base.NCPopconfirm,n.base.NCFormControl,n.base.NCBackBtn),p="/nccloud/uapbd/customer/CustAppSaveBank.do",d="/nccloud/uapbd/customer/CustAppDelBank.do",m="/nccloud/uapbd/customer/CustApplyExField.do",f=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return a.setBankAccSubDefault=function(e){var t={isAdd:!1};a.getValueFromForm(t),t.mainPk=a.props.mainPk;var s=t.cardTable.model.rows;s.forEach(function(e){e.values.isdefault.value=!1}),s[e].values.isdefault.value=!0,(0,n.ajax)({url:p,data:t,success:function(e){a.props.cardTable.setStatus(a.props.cardTableId,"browse"),a.props.form.setAllFormValue(i({},a.props.formId1,e.data.head.custbank)),a.props.form.setAllFormValue(i({},a.props.formId2,e.data.head.custbank)),e.data.body&&e.data.body[a.props.cardTableId]&&a.props.cardTable.setTableData(a.props.cardTableId,e.data.body[a.props.cardTableId]),a.accnum=e.data.head.custbank.rows[0].values.accnum.value,a.pk_banktype=e.data.head.custbank.rows[0].values.pk_banktype.value,a.cardStatus="browse",a.updateButtonStatus()}})},a.delConfirm=function(){(0,n.ajax)({url:d,data:{deleteinfo:[{id:a.props.getUrlParam("id"),ts:a.props.form.getFormItemsValue(a.formId,"ts").value}]},success:function(e){e&&a.props.linkTo("../list/index.html")}})},a.getTableHead=function(){var e=a.props.button.createButtonApp;return o.default.createElement("div",{className:"shoulder-definition-area"},o.default.createElement("div",{className:"definition-icons"},e({area:"bank-body",onButtonClick:a.buttonClick.bind(a)}),a.props.cardTable.createBrowseIcons(a.tableId,{iconArr:["close","open","max","setCol"],maxDestAreaId:"nc-bill-card"})))},a.formId1=a.props.formId1,a.formId2=a.props.formId2,a.tableId=a.props.cardTableId,a.cardStatus=a.props.cardStatus,a.accnum=a.props.accnum,a.pk_banktype=a.props.pk_banktype,a.state={pk_org:"",title_code:"",totalcount:0,applycount:0,showAccbase:!0,showNetBank:!1,backVisible:!0},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.cardStatus;t&&"add"==t?(setTimeout(function(){return e.props.form.EmptyAllFormValue(e.props.formId1)},1),setTimeout(function(){return e.props.form.EmptyAllFormValue(e.props.formId2)},1),setTimeout(function(){return e.props.cardTable.setTableData(e.props.cardTableId,{rows:[]})},1),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId1,"edit")},1),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId2,"edit")},1),setTimeout(function(){return e.props.cardTable.setStatus(e.props.cardTableId,"edit")},1),(0,n.ajax)({url:m,data:{pk_country:this.props.form.getFormItemsValue("customer","pk_country").value,operation:"bankinfo"},success:function(t){if(t.data.pk_currtype){e.props.cardTable.addRow(e.props.cardTableId,0,{pk_currtype:{value:t.data.pk_currtype,display:t.data.currtypename}});var a=e.props.form.getFormItemsValue("customer","name");e.props.form.setFormItemsValue(e.props.formId1,{accname:{value:a.name.value,display:a.name.display}})}}})):t&&"edit"==t?(this.getData(this.props.mainPk,this.accnum,this.pk_banktype),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId1,"edit")},1),setTimeout(function(){return e.props.form.setFormStatus(e.props.formId2,"edit")},1),setTimeout(function(){return e.props.cardTable.setStatus(e.props.cardTableId,"edit")},1)):t&&"browse"==t&&this.getData(this.props.mainPk,this.accnum,this.pk_banktype),setTimeout(function(){return e.updateButtonStatus()},1)}},{key:"updateButtonStatus",value:function(){var e=this.cardStatus;if(e&&"browse"==e)this.accnum&&this.pk_banktype?(this.props.button.setButtonVisible(["BankAdd","BankEdit","BankDelete","BankRefresh","BankDefault"],!0),this.props.button.setButtonVisible(["BankCancel","BankSave","BankAddLine","BankBack","BankSaveAdd"],!1)):(this.props.button.setButtonVisible(["BankAdd"],!0),this.props.button.setButtonVisible(["BankCancel","BankSave","BankAddLine","BankBack","BankSaveAdd","BankEdit","BankDelete","BankRefresh","BankDefault"],!1)),this.setState({backVisible:!0});else{var t=["BankCancel","BankSave","BankAddLine"],a=["BankAdd","BankEdit","BankDelete","BankRefresh","BankBack","BankDefault"];"add"==this.cardStatus?t.push("BankSaveAdd"):a.push("BankSaveAdd"),this.props.button.setButtonVisible(a,!1),this.props.button.setButtonVisible(t,!0),this.setState({backVisible:!1})}}},{key:"getData",value:function(e,t,a){var s=this,r={mainPk:e,accnum:t,pk_banktype:a};(0,n.ajax)({url:"/nccloud/uapbd/customer/CustAppQueryBankCard.do",data:r,success:function(e){s.props.form.setAllFormValue(i({},s.props.formId1,e.data.head.custbank)),s.props.form.setAllFormValue(i({},s.props.formId2,e.data.head.custbank)),e.data.body&&e.data.body[s.props.cardTableId]&&s.props.cardTable.setTableData(s.props.cardTableId,e.data.body[s.props.cardTableId])}})}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"BankAdd":this.props.form.EmptyAllFormValue(this.props.formId1),this.props.form.EmptyAllFormValue(this.props.formId2),this.props.cardTable.setTableData(this.props.cardTableId,{rows:[]}),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId1,"edit")},1),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId2,"edit")},1),setTimeout(function(){return a.props.cardTable.setStatus(a.props.cardTableId,"edit")},1),this.cardStatus="add",setTimeout(function(){return a.updateButtonStatus()},1),(0,n.ajax)({url:m,data:{pk_country:this.props.form.getFormItemsValue("customer","pk_country").value,operation:"bankinfo"},success:function(e){if(e.data.pk_currtype){a.props.cardTable.addRow(a.props.cardTableId,0,{pk_currtype:{value:e.data.pk_currtype,display:e.data.currtypename}});var t=a.props.form.getFormItemsValue("customer","name");a.props.form.setFormItemsValue(a.props.formId1,{accname:{value:t.name.value,display:t.name.display}})}}});break;case"BankEdit":this.props.form.setFormStatus(this.props.formId1,"edit"),this.props.form.setFormStatus(this.props.formId2,"edit"),this.props.cardTable.setStatus(this.props.cardTableId,"edit"),this.cardStatus="edit",setTimeout(function(){return a.updateButtonStatus()},1);break;case"BankSave":var s={isAdd:"add"==this.cardStatus};if(!this.getValueFromForm(s))return;s.mainPk=this.props.mainPk,(0,n.ajax)({url:p,data:s,success:function(e){a.props.form.setFormStatus(a.props.formId1,"browse"),a.props.form.setFormStatus(a.props.formId2,"browse"),a.props.cardTable.setStatus(a.props.cardTableId,"browse"),a.props.form.setAllFormValue(i({},a.props.formId1,e.data.head.custbank)),a.props.form.setAllFormValue(i({},a.props.formId2,e.data.head.custbank)),e.data.body&&e.data.body[a.props.cardTableId]&&a.props.cardTable.setTableData(a.props.cardTableId,e.data.body[a.props.cardTableId]),a.accnum=e.data.head.custbank.rows[0].values.accnum.value,a.pk_banktype=e.data.head.custbank.rows[0].values.pk_banktype.value,a.cardStatus="browse",a.updateButtonStatus()}});break;case"BankDelete":(0,n.promptBox)({color:"warning",title:this.props.json["10140CUSTPF-000022"],content:this.props.json["10140CUSTPF-000023"],beSureBtnClick:function(){var e={mainPk:a.props.mainPk,accnum:a.accnum,pk_banktype:a.pk_banktype};(0,n.ajax)({url:d,data:e,success:function(t){e={isList:!1},a.props.bankaccModalChange&&a.props.bankaccModalChange(e)}})}});break;case"BankCancel":(0,n.promptBox)({color:"warning",title:this.props.json["10140CUSTPF-000027"],content:this.props.json["10140CUSTPF-000028"],beSureBtnClick:function(){if(a.props.form.setFormStatus(a.props.formId1,"browse"),a.props.form.setFormStatus(a.props.formId2,"browse"),a.props.cardTable.setStatus(a.props.cardTableId,"browse"),a.props.form.EmptyAllFormValue(a.props.formId1),a.props.cardTable.setTableData(a.props.cardTableId,{rows:[]}),a.accnum&&a.pk_banktype)a.getData(a.props.mainPk,a.accnum,a.pk_banktype);else{var e=a.props.table.getAllTableData(a.props.tableId);e&&e.rows&&e.rows.length>0&&(a.accnum=e.rows[0].values.accnum.value,a.pk_banktype=e.rows[0].values.pk_banktype.value,a.getData(a.props.mainPk,a.accnum,a.pk_banktype))}a.cardStatus="browse",a.updateButtonStatus()}});break;case"BankAddLine":setTimeout(function(){return a.props.cardTable.addRow(a.props.cardTableId)},1);break;case"BankBack":this.props.bankaccModalChange&&this.props.bankaccModalChange({isList:!1});break;case"BankDefault":var r=this.props.cardTable.getCheckedRows(this.props.cardTableId);if(r&&0!=r.length){var o=r[0],l=o.data.values.isdefault.value;l&&null!=l&&1==l?(0,n.toast)({content:this.props.json["10140CUSTPF-000010"],color:"danger"}):this.props.modal.show("modal",{title:this.props.json["10140CUSTPF-000011"],content:this.props.json["10140CUSTPF-000012"],beSureBtnClick:this.setBankAccSubDefault.bind(this,o.index)})}else(0,n.toast)({content:this.props.json["10140CUSTPF-000009"],color:"danger"});break;case"BankSaveAdd":if(s={isAdd:"add"==this.props.cardStatus},!this.getValueFromForm(s))return;s.mainPk=this.props.mainPk,(0,n.ajax)({url:p,data:s,success:function(e){a.props.form.EmptyAllFormValue(a.props.formId1),a.props.form.EmptyAllFormValue(a.props.formId2),a.props.cardTable.setTableData(a.props.cardTableId,{rows:[]}),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId1,"edit")},1),setTimeout(function(){return a.props.form.setFormStatus(a.props.formId2,"edit")},1),setTimeout(function(){return a.props.cardTable.setStatus(a.props.cardTableId,"edit")},1),a.cardStatus="add",setTimeout(function(){return a.updateButtonStatus()},1),(0,n.ajax)({url:m,data:{pk_country:a.props.form.getFormItemsValue("customer","pk_country").value,operation:"bankinfo"},success:function(e){if(e.data.pk_currtype){a.props.cardTable.addRow(a.props.cardTableId,0,{pk_currtype:{value:e.data.pk_currtype,display:e.data.currtypename}});var t=a.props.form.getFormItemsValue("customer","name");a.props.form.setFormItemsValue(a.props.formId1,{accname:{value:t.name.value,display:t.name.display}})}}})}});break;default:console.log(t,index)}}},{key:"onAfterEvent",value:function(e,t,a,s,r){var o=this;if(null==r||null==r.value||r.value&&s.value!=r.value)if("pk_banktype"==a){var l=e.meta.getMeta();l.accbasinfo.items.find(function(e){return"pk_bankdoc"==e.attrcode}).queryCondition=function(){return{pk_banktype:s.value}},e.meta.setMeta(l)}else"pk_bankdoc"==a&&(s&&s.value?(0,n.ajax)({url:m,data:{operation:"bankdoc",primaryKey:s.value},success:function(e){if(e.data){var t={pk_banktype:{value:e.data.value,display:e.data.display}};o.props.form.setFormItemsValue(o.formId1,t),o.props.form.setFormItemsDisabled(o.formId1,{pk_banktype:!0})}}}):(this.props.form.setFormItemsDisabled(this.formId1,{pk_banktype:!1}),this.props.form.setFormItemsValue(this.formId1,{pk_banktype:{value:null,display:null}})))}},{key:"getValueFromForm",value:function(e){if(!this.props.form.isCheckNow([this.props.formId1,this.props.formId2]))return!1;var t=this.props.form.getAllFormValue(this.props.formId1),a=this.props.form.getAllFormValue(this.props.formId2);delete t.rows[0].values.bankaccsub,delete a.rows[0].values.bankaccsub,e.form1={model:t},e.form2={model:a},e.cardTable={model:{rows:this.props.cardTable.getVisibleRows(this.props.cardTableId)}};var s=this.props.cardTable.getAllRows(this.props.cardTableId);return null!=s&&0!=s.length||((0,n.toast)({color:"danger",content:this.props.json["10140CUSTPF-000013"]}),!1)}},{key:"render",value:function(){var e=this,t=this.props,a=t.cardTable,s=t.form,r=t.button,n=t.modal,l=(t.cardPagination.createCardPagination,s.createForm),i=a.createCardTable,p=r.createButtonApp,d=(r.createButton,n.createModal),m=this.state.showAccbase?"icon-jiantouxia1":"icon-jiantouyou",f=this.state.showAccbase?"show-form":"hide-form",b=this.state.showNetBank?"icon-jiantouxia1":"icon-jiantouyou",k=this.state.showNetBank?"show-form":"hide-form";return o.default.createElement("div",{id:"nc-bill-card"},o.default.createElement("div",{className:"nc-bill-card"},o.default.createElement(u,null,o.default.createElement("div",{className:"nc-bill-header-area"},o.default.createElement(c,{className:"title-search-detail",style:{"line-height":"32px",display:this.state.backVisible?"inline":"none"},onClick:this.buttonClick.bind(this,this.props,"BankBack")}),o.default.createElement("div",{className:"header-button-area"},p({area:"bank-action",onButtonClick:this.buttonClick.bind(this)})))),o.default.createElement("div",{className:"nc-bill-form-area"},o.default.createElement("div",{className:"group-form-wrapper"},o.default.createElement("div",{className:"group-form-name"},o.default.createElement("span",{className:"toggle-form-icon iconfont "+m,onClick:function(){var t=!e.state.showAccbase;e.setState({showAccbase:t})}}),o.default.createElement("span",{className:"name"},this.props.json["10140CUSTPF-000014"])),o.default.createElement("div",{className:"group-form-item "+f+" "},l(this.props.formId1,{onAfterEvent:this.onAfterEvent.bind(this)}))),o.default.createElement("div",{className:"group-form-wrapper"},o.default.createElement("div",{className:"group-form-name"},o.default.createElement("span",{className:"toggle-form-icon iconfont "+b,onClick:function(){var t=!e.state.showNetBank;e.setState({showNetBank:t})}}),o.default.createElement("span",{className:"name"},this.props.json["10140CUSTPF-000015"])),o.default.createElement("div",{className:"group-form-item "+k+" "},l(this.props.formId2,{})))),o.default.createElement("div",{className:"nc-bill-table-area"},i(this.tableId,{tableHead:this.getTableHead.bind(this),showIndex:!0,showCheck:!0})),d("delete",{title:this.props.json["10140CUSTPF-000016"],content:this.props.json["10140CUSTPF-000017"],beSureBtnClick:this.delConfirm.bind(this)}),d("modal",{})))}}]),t}();t.default=f}}]);
//# sourceMappingURL=Card.js.map