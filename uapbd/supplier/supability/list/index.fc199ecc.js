!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/supplier/supability/list/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/supplier/supability/list/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,function(e,t,a){return function(e){var t={};function a(o){if(t[o])return t[o].exports;var n=t[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,a),n.l=!0,n.exports}return a.m=e,a.c=t,a.d=function(e,t,o){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(a.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)a.d(o,n,function(t){return e[t]}.bind(null,n));return o},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=242)}({1:function(t,a){t.exports=e},2:function(e,a){e.exports=t},215:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n,r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&(e[o]=a[o])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var o=t[a];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,a,o){return a&&e(t.prototype,a),o&&e(t,o),t}}(),l=a(2),i=u(l),c=(u(a(3)),a(1));function u(e){return e&&e.__esModule?e:{default:e}}var p=c.high.PrintOutput,d=c.base.NCPopconfirm,f=(c.base.NCIcon,c.base.NCTabs.NCTabPane,"10140SACLSO_list"),h="search",b="supplyabilityset",g="pk_supabilityset",m="/nccloud/uapbd/supability/querySupabilityList.do",S="/nccloud/uapbd/supability/deleteSupability.do",v="/nccloud/uapbd/supability/printSupability.do",y=(o=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.call(a),a.searchId=h,a.tableId=b,a.selectedRowRecord=null,a.state={pks:[],json:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,l.Component),s(t,[{key:"modifierMeta",value:function(e,t){var a=this,o=["pk_org","pk_supabclass","pk_mategrade.pk_material"];t[h].items=t[h].items.map(function(e,t){return e.col="3",o.indexOf(e.attrcode)>=0&&(e.isShowDisabledData=!0),e});var n=["pk_org","pk_supabclass","pk_supplyname","pk_supgradesys","pk_mategrade.pk_material"];return t[h].items.forEach(function(e){n.indexOf(e.attrcode)>=0&&(e.isMultiSelectedEnabled=!0)}),t[h].items.find(function(e){return"pk_org"==e.attrcode}).queryCondition=function(){return{TreeRefActionExt:"nccloud.web.refer.sqlbuilder.PrimaryOrgSQLBuilder"}},t[b].items=t[b].items.map(function(t,a){return t.width=150,"project_code"==t.attrcode&&(t.render=function(t,a,o){return i.default.createElement("span",{style:{color:"#007ace",cursor:"pointer"},onClick:function(){var t=e.search.getAllSearchData(h);c.cacheTools.set("searchParams",t),e.pushTo("/card",{status:"browse",id:a[g].value})}},a&&a.project_code&&a.project_code.value)}),t}),t[b].items.push({itemtype:"customer",attrcode:"opr",label:this.state.json["10140SACLSO-000000"],width:200,fixed:"right",className:"table-opr",visible:!0,render:function(t,o,n){return i.default.createElement("span",null,i.default.createElement("span",{style:{cursor:"pointer"},onClick:function(){e.pushTo("/card",{status:"edit",id:o[g].value})}},a.state.json["10140SACLSO-000034"]),i.default.createElement("span",null,"   "),i.default.createElement(d,{trigger:"click",placement:"top",content:a.state.json["10140SACLSO-000023"],onClose:function(){var t=o[g].value,r={deleteInfo:[]};r.deleteInfo.push({id:o[g].value,ts:o.ts.value}),(0,c.ajax)({url:S,data:r,success:function(o){o.success&&((0,e.table.deleteCacheId)(b,t),(0,c.toast)({color:"success",content:a.state.json["10140SACLSO-000011"]}),e.table.deleteTableRowsByIndex(b,n))}})}},i.default.createElement("span",{style:{cursor:"pointer"}},a.state.json["10140SACLSO-000015"])))}}),t}},{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140SACLSO",domainName:"uapbd",callback:function(t,a,o){a&&e.setState({json:t,inlt:o},function(){e.initTemplate(e.props)})}});var t={Delete:!0};0==this.props.table.getAllTableData(this.tableId).rows.length&&(t.Print=!0,t.Output=!0),this.props.button.setButtonDisabled(t)}},{key:"buttonClick",value:function(e,t){var a=this;switch(t){case"Add":var o=e.search.getAllSearchData(h);c.cacheTools.set("searchParams",o),e.pushTo("/card",{status:"add"});break;case"Edit":o=e.search.getAllSearchData(h),c.cacheTools.set("searchParams",o);var n=this.props.table.getCheckedRows(this.tableId),r=null;if(!(n.length>0))return void(0,c.toast)({content:this.state.json["10140SACLSO-000024"],color:"warning"});r=n[0].data.values[g].value,e.pushTo("/card",{status:"edit",id:r});break;case"Refresh":this.refreshAction(e,!0),this.props.button.setButtonDisabled({Delete:!0});break;case"Delete":(0,c.promptBox)({color:"warning",title:this.state.json["10140SACLSO-000025"],content:this.state.json["10140SACLSO-000026"],noFooter:!1,noCancelBtn:!1,beSureBtnName:this.state.json["10140SACLSO-000005"],cancelBtnName:this.state.json["10140SACLSO-000006"],beSureBtnClick:this.deleteAction.bind(this)});break;case"Print":this.output("print");break;case"Output":var s=[];this.props.table.getAllTableData(b).rows.forEach(function(e){s.push(e.values[g].value)}),this.setState({pks:s},function(){a.refs.printOutput.open()})}}},{key:"output",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=[];this.props.table.getAllTableData(b).rows.forEach(function(e){t.push(e.values[g].value)}),""!=e&&(0,c.print)("pdf",v,{funcode:"10140SACLSO",nodekey:"supplyset-list",oids:t,outputType:e})}},{key:"deleteAction",value:function(){var e=this,t=this.props.table.getCheckedRows(b),a=[];t&&0!=t.length?(t.forEach(function(e){a.push({id:e.data.values[g].value,ts:e.data.values.ts.value})}),(0,c.ajax)({url:S,data:{deleteInfo:a},success:function(t){(0,c.toast)({color:"success",title:e.state.json["10140SACLSO-000011"]}),e.refreshAction(e.props),e.props.button.setButtonDisabled({Delete:!0})}})):taost({color:"warning",content:this.state.json["10140SACLSO-000027"]})}},{key:"onRowClick",value:function(e,t,a,o){this.selectedRowRecord=a}},{key:"onSelectChange",value:function(){this.props.table.getCheckedRows(this.tableId).length>0?this.props.button.setButtonDisabled(["Delete"],!1):this.props.button.setButtonDisabled(["Delete"],!0)}},{key:"getData",value:function(e,t,a){var o=this,n=this.props.search.getQueryInfo("search"),s=n.oid,l=r({},n,{pageInfo:{pageIndex:0,pageSize:10,total:0,totalPage:0},pagecode:f,queryAreaCode:h,oid:s,queryType:"tree"});(0,c.ajax)({url:m,data:l,success:function(e){if(console.log(e),e.data){var n=[];e.data[b].rows.forEach(function(e){n.push(e.values[g].value)}),e.data[b].allpks=n,o.props.button.setButtonDisabled({Print:!1,Output:!1}),o.props.table.setAllTableData(o.tableId,e.data[b]);var r=n.length,s=o.state.inlt;t&&(0,c.toast)({title:o.state.json["10140SACLSO-000028"],content:s&&s.get("10140SACLSO-000035",{count:r}),color:"success"})}else{o.props.button.setButtonDisabled({Print:!0,Output:!0}),o.props.table.setAllTableData(b,{allpks:[],rows:[]}),t&&(0,c.toast)({content:o.state.json["10140SACLSO-000031"],color:"warning",title:o.state.json["10140SACLSO-000032"]})}e.formulamsg&&e.formulamsg instanceof Array&&e.formulamsg.length>0&&o.props.dealFormulamsg(e.formulamsg,function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},b,"table")),a&&"function"==typeof a&&a()},error:function(e){console.log(e.message)}})}},{key:"render",value:function(){var e=this.props,t=e.table,a=e.button,o=e.search,n=e.modal,r=this.props.button.getButtons();r=r.sort(function(e,t){return t.btnorder-e.btnorder});var s=t.createSimpleTable,l=o.NCCreateSearch,c=n.createModal,u=a.createButtonApp;a.getButtons;return i.default.createElement("div",{className:"nc-bill-list"},i.default.createElement("div",{className:"nc-bill-header-area"},i.default.createElement("div",{className:"header-title-search-area"},i.default.createElement("h2",{className:"title-search-detail"},this.state.json["10140SACLSO-000021"])),i.default.createElement("div",{className:"header-button-area"},u({area:"header-action",buttonLimit:3,onButtonClick:this.buttonClick.bind(this),popContainer:document.querySelector(".header-button-area")}))),i.default.createElement("div",{className:"nc-bill-search-area"},l(this.searchId,{clickSearchBtn:this.clickSearchBtn.bind(this)})),i.default.createElement("div",{className:"nc-bill-table-area"},s(this.tableId,{dataSource:"upabd.supplier.supability.data",pkname:g,handlePageInfoChange:this.pageInfoClick,tableModelConfirm:this.tableModelConfirm,showIndex:!0,onRowClick:this.onRowClick.bind(this),showCheck:!0,onRowDoubleClick:this.doubleClick.bind(this),onSelected:this.onSelectChange.bind(this),onSelectedAll:this.onSelectChange.bind(this)})),i.default.createElement(p,{ref:"printOutput",url:v,data:{funcode:"10140SACLSO",oids:this.state.pks,nodekey:"supplyset-list",outputType:"output"}}),c("delete",{title:this.state.json["10140SACLSO-000025"],content:this.state.json["10140SACLSO-000033"],beSureBtnClick:this.deleteAction.bind(this)}))}}]),t}(),n=function(){var e=this;this.initTemplate=function(t){t.createUIDom({pagecode:f},function(a){if(a){if(a.template){var o=a.template;o=e.modifierMeta(t,o),t.meta.setMeta(o,function(){a.context&&a.context.pk_org&&a.context.org_Name&&t.search.setSearchValByField(h,"pk_org",{value:a.context.pk_org?a.context.pk_org:null,display:a.context.org_Name?a.context.org_Name:null})});var n=c.cacheTools.get("searchParams");if(n&&0!=n){t.search.setSearchValue(h,n);var s=t.search.getQueryInfo(h),l=s.oid,i=r({},s,{pageInfo:{pageIndex:0,pageSize:10,total:0,totalPage:0},pagecode:f,queryAreaCode:h,oid:l,queryType:"tree"});(0,c.ajax)({url:m,data:i,success:function(a){if(a.data){var o=[];a.data[b].rows.forEach(function(e){o.push(e.values[g].value)}),c.cacheTools.set("allpks",o),a.data[b].allpks=o,t.button.setButtonDisabled({Print:!1,Output:!1}),t.table.setAllTableData(b,a.data[b])}else{t.button.setButtonDisabled({Print:!0,Output:!0}),t.table.setAllTableData(b,{allpks:[],rows:[]}),(0,c.toast)({content:e.state.json["10140SACLSO-000022"],color:"warning"})}},error:function(e){console.log(e.message)}})}}if(a.button){var u=a.button;t.button.setButtons(u)}}})},this.getButtonNames=function(e){return"edit"===e||"add"===e||"save"===e?"main-button":"secondary - button"},this.doubleClick=function(t,a,o,n){var r=e.props.search.getAllSearchData(h);c.cacheTools.set("searchParams",r),e.props.pushTo("/card",{status:"browse",id:t[g].value})},this.refreshAction=function(t){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=t.search.getAllSearchData(h);o&&e.getData(o,!1,function(){a&&(0,c.toast)({title:e.state.json["10140SACLSO-000009"],color:"success"})})},this.pageInfoClick=function(t,a,o){t.table.getTablePageInfo(e.tableId),t.search.getAllSearchData(h);var n={allpks:o,pageid:f};(0,c.ajax)({url:"/nccloud/uapbd/taxregion/ProjectQueryPageGridByPks.do",data:n,success:function(e){var a=e.success,o=e.data;a&&(o?t.table.setAllTableData(b,o[b]):t.table.setAllTableData(b,{rows:[]}))}})},this.clickSearchBtn=function(t,a){a&&(c.cacheTools.set("searchParams",a),e.searchVal=a,e.getData(a,!0))}},o);y=(0,c.createPage)({initTemplate:[],mutiLangCode:"10140SACLSO"})(y),t.default=y},242:function(e,t,a){e.exports=a(215)},3:function(e,t){e.exports=a}})});
//# sourceMappingURL=index.fc199ecc.js.map