!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nc-lightapp-front"),require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["nc-lightapp-front","react","react-dom"],t):"object"==typeof exports?exports["uapbd/supplier/supbanken/card/index"]=t(require("nc-lightapp-front"),require("react"),require("react-dom")):e["uapbd/supplier/supbanken/card/index"]=t(e["nc-lightapp-front"],e.React,e.ReactDOM)}(window,function(e,t,a){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var s=t[n]={i:n,l:!1,exports:{}};return e[n].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)a.d(n,s,function(t){return e[t]}.bind(null,s));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="../../../../",a(a.s=406)}({1:function(t,a){t.exports=e},2:function(e,a){e.exports=t},290:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,s,o=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),r=a(2),l=u(r),i=(u(a(3)),a(1));function u(e){return e&&e.__esModule?e:{default:e}}function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function d(e){if(Array.isArray(e)){for(var t=0,a=Array(e.length);t<e.length;t++)a[t]=e[t];return a}return Array.from(e)}var p=i.base.NCAffix,b=(i.base.NCPopconfirm,i.base.NCFormControl,i.base.NCBackBtn),f=i.high.PrintOutput,m="supbankacc",v="bankaccsub",h="search",k="/nccloud/uapbd/supbanken/enableSupbankenCard.do",g="/nccloud/uapbd/supbanken/printSupbanken.do";function y(e){var t=e.getUrlParam("status");"edit"==t||"add"==t?(e.button.setButtonVisible(["Edit","Add","back","Delete","Refresh"],!1),e.button.setButtonVisible(["Save","Cancel","AddLine","DelLine"],!0),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!1)):(e.button.setButtonVisible(["Save","Cancel","AddLine","DelLine"],!1),e.button.setButtonVisible(["Add","Edit","Delete","back","Refresh"],!0),e.cardPagination.setCardPaginationVisible("cardPaginationBtn",!0)),e.form.setFormStatus(m,t),e.cardTable.setStatus(v,"edit"==t||"add"==t?"edit":"browse")}var E=(n=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return s.call(a),a.formId=m,a.searchId=h,a.tableId=v,a.state={pk_org:"",title_code:"",totalcount:0,applycount:0,pks:[],backVisible:!0,json:{}},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),o(t,[{key:"componentDidMount",value:function(){var e=this;this.props.MultiInit.getMultiLang({moduleId:"10140SBAE",domainName:"uapbd",callback:function(t,a,n){a&&e.setState({json:t,inlt:n},function(){e.initTemplate(e.props);var t=e.props.getUrlParam("id").split("_");e.getdata.apply(e,d(t))})}}),this.props.cardPagination.setCardPaginationId({id:this.props.getUrlParam("id"),status:0})}},{key:"modifierMeta",value:function(e,t){var a=this,n=e.getUrlParam("status");t[m].status=n,t[v].status=n;var s={itemtype:"customer",attrcode:"opr",label:this.state.json["10140SBAE-000000"],visible:!0,className:"table-opr",width:200,fixed:"right",render:function(t,n,s){return"browse"===e.cardTable.getStatus(v)?l.default.createElement("span",{onClick:function(){e.cardTable.toggleRowView(v,n)}}," ",a.state.json["10140SBAE-000015"]):l.default.createElement("div",{className:"currency-opr-col"},l.default.createElement("span",{className:"currency-opr-del",onClick:function(t){e.cardTable.openModel(v,"edit",n,s),t.stopPropagation()}},a.state.json["10140SBAE-000016"]),"  ",l.default.createElement("span",{className:"currency-opr-del",onClick:function(t){e.cardTable.delRowsByIndex(v,s),t.stopPropagation()}},a.state.json["10140SBAE-000017"]))}};return t[v].items.push(s),t}},{key:"enableSureEventClick",value:function(){var e=this,t=this.props.form.getAllFormValue(this.formId),a={isEnable:!0,list:[]},n={pk_bankaccbas:t.rows[0].values.pk_bankaccbas.value,pk_custbank:t.rows[0].values.pk_custbank.value,pk_cust:t.rows[0].values.pk_cust.value};a.list.push(n),(0,i.ajax)({url:k,data:a,success:function(t){e.getdata(n.pk_custbank,n.pk_bankaccbas,n.pk_cust,function(){(0,i.toast)({color:"success",title:e.state.json["10140SBAE-000009"]})})}})}},{key:"disableSureEventClick",value:function(){var e=this,t=this.props.form.getAllFormValue(this.formId),a={isEnable:!1,list:[]},n={pk_bankaccbas:t.rows[0].values.pk_bankaccbas.value,pk_custbank:t.rows[0].values.pk_custbank.value,pk_cust:t.rows[0].values.pk_cust.value};a.list.push(n),(0,i.ajax)({url:k,data:a,success:function(t){e.getdata(n.pk_custbank,n.pk_bankaccbas,n.pk_cust,function(){(0,i.toast)({color:"success",title:e.state.json["10140SBAE-000010"]})})}})}},{key:"output",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=(this.props.table.getAllTableData(v),this.props.getUrlParam("id").split("_"));""!=e&&(0,i.print)("pdf",g,{funcode:"10140SBAE",nodekey:"supcard",oids:t,outputType:e})}},{key:"onCardTableAfterEvent",value:function(e,t,a,n,s,o,r){if(console.log(s),console.log(r),s[0].newvalue.value!=s[0].oldvalue.value){var l={};l.value=r.values.pk_region.value,l.display=r.values.pk_region.display,e.cardTable.setValByKeyAndIndex(this.tableId,o,"pk_region.name",l),r.values.pk_region.display=n.refcode}}},{key:"render",value:function(){var e=this.props,t=e.cardTable,a=e.form,n=e.button,s=e.modal,o=e.cardPagination.createCardPagination,r=this.props.button.getButtons();r=r.sort(function(e,t){return t.btnorder-e.btnorder});var u=a.createForm,c=t.createCardTable,d=n.createButtonApp,m=s.createModal,v=this.props.getUrlParam("status");return l.default.createElement("div",{className:"nc-bill-card"},l.default.createElement("div",{className:"nc-bill-top-area"},l.default.createElement(p,null,l.default.createElement("div",{className:"nc-bill-header-area"},l.default.createElement(b,{className:"title-search-detail",style:{display:this.state.backVisible?"inline":"none"},onClick:this.buttonClick.bind(this,this.props,"Back")}),l.default.createElement("div",{className:"header-title-search-area"},(0,i.createPageIcon)(),l.default.createElement("h2",{className:"title-search-detail"},this.state.json["10140SBAE-000023"],"browse"==v?"："+this.state.title_code:"")),l.default.createElement("div",{className:"header-button-area"},d({area:"header-action",onButtonClick:this.buttonClick.bind(this)}),o({handlePageInfoChange:this.pageInfoClick.bind(this)})))),l.default.createElement("div",{className:"nc-bill-form-area"},u(this.formId,{onAfterEvent:this.afterEvent.bind(this)}))),l.default.createElement("div",{className:"nc-bill-bottom-area"},l.default.createElement("div",{className:"nc-bill-table-area"},c(this.tableId,{tableHead:this.getTableHead.bind(this),modelSave:this.modelSave.bind(this),onAfterEvent:this.onCardTableAfterEvent.bind(this),showIndex:!0,showCheck:!0}))),m("delete",{title:this.state.json["10140SBAE-000013"],content:this.state.json["10140SBAE-000014"],beSureBtnClick:this.delConfirm}),m("enable",{title:this.state.json["10140SBAE-000002"],content:this.state.json["10140SBAE-000003"],beSureBtnClick:this.enableSureEventClick.bind(this)}),m("disable",{title:this.state.json["10140SBAE-000006"],content:this.state.json["10140SBAE-000007"],beSureBtnClick:this.disableSureEventClick.bind(this)}),l.default.createElement(f,{ref:"printOutput",url:g,data:{funcode:"10140SBAE",oids:this.state.pks,nodekey:"supcard",outputType:"output"}}))}}]),t}(),s=function(){var e=this;this.initTemplate=function(t){t.createUIDom({pagecode:"10140SBAE_card"},function(a){if(a){if(a.template){var n=a.template;e.modifierMeta(t,n),t.meta.setMeta(n)}if(a.button){var s=a.button;t.button.setButtons(s),y(t)}}})},this.setDefaultValue=function(){e.props.form.setFormItemsValue(e.formId,{bill_status:{value:"0",display:e.state.json["10140SBAE-000001"]}})},this.buttonClick=function(t,a){switch(a){case"Enable":(0,i.promptBox)({color:"warning",title:e.state.json["10140SBAE-000002"],content:e.state.json["10140SBAE-000003"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140SBAE-000004"],cancelBtnName:e.state.json["10140SBAE-000005"],beSureBtnClick:e.enableSureEventClick.bind(e)});break;case"Disable":(0,i.promptBox)({color:"warning",title:e.state.json["10140SBAE-000006"],content:e.state.json["10140SBAE-000007"],noFooter:!1,noCancelBtn:!1,beSureBtnName:e.state.json["10140SBAE-000004"],cancelBtnName:e.state.json["10140SBAE-000005"],beSureBtnClick:e.disableSureEventClick.bind(e)});break;case"Back":t.pushTo("/list",{});break;case"Refresh":t.pushTo("/card",{status:t.getUrlParam("status"),id:t.getUrlParam("id")}),(0,i.toast)({title:e.state.json["10140SBAE-000008"],color:"success"});break;case"Print":e.output("print");break;case"Output":var n=e.props.getUrlParam("id").split("_");e.setState({pks:n},function(){e.refs.printOutput.open()})}},this.pageInfoClick=function(t,a){var n=a.split("_");e.getdata.apply(e,d(n).concat([function(){t.setUrlParam(a)}]))},this.afterEvent=function(e,t,a,n,s,o,r,l){},this.getdata=function(t,a,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o={pk_custbank:t,pk_bankaccbas:a,pk_cust:n};(0,i.ajax)({url:"/nccloud/uapbd/supbanken/querySupbankenCard.do",data:o,success:function(t){if(t.data.head){e.props.form.setAllFormValue(c({},e.formId,t.data.head[e.formId]));var a=t.data.head[e.formId].rows[0].values.accname.value;e.setState({title_code:a})}if(t.data.body){var n=t.data.body[e.tableId].rows[0].values.isdefault;n&&"Y"==n.value?(t.data.body[e.tableId].rows[0].values.isdefault.value=!0,t.data.body[e.tableId].rows[0].values.isdefault.display=!1):n?(t.data.body[e.tableId].rows[0].values.isdefault.value=!1,t.data.body[e.tableId].rows[0].values.isdefault.display=!1):t.data.body[e.tableId].rows[0].values.isdefault={value:!1,display:!1},e.props.cardTable.setTableData(e.tableId,t.data.body[e.tableId]);var o=e.props.cardTable.getNumberOfRows(e.tableId);e.props.cardTable.getAllRows(e.tableId);e.setState({applycount:0}),e.setState({totalcount:o})}2==t.data.head[e.formId].rows[0].values.enablestate.value?(e.props.button.setButtonVisible(["Enable"],!1),e.props.button.setButtonVisible(["Disable"],!0)):(e.props.button.setButtonVisible(["Enable"],!0),e.props.button.setButtonVisible(["Disable"],!1)),s&&"function"==typeof s&&s.call(e)}})},this.saveClick=function(){e.props.editTable.filterEmptyRows(v);var t=e.props.createMasterChildData("10140SBAE_card",e.formId,e.tableId);delete t.head[m].rows[0].values.pk_taxregions;var a="/nccloud/uapbd/taxregion/saveTaxregion.do";"edit"===e.props.getUrlParam("status")&&(a="/nccloud/uapbd/taxregion/updateTaxregion.do"),(0,i.ajax)({url:a,data:t,success:function(t){var a=null;t.success&&(t.data&&(t.data.head&&t.data.head[e.formId]&&(e.props.form.setAllFormValue(c({},e.formId,t.data.head[e.formId])),a=t.data.head[e.formId].rows[0].values.pk_taxregion.value),t.data.body&&t.data.body[e.tableId]&&e.props.cardTable.setTableData(e.tableId,t.data.body[e.tableId])),(0,i.toast)({content:e.state.json["10140SBAE-000011"],color:"success"}),e.props.pushTo("/card",{status:"browse",id:a}),y(e.props))}})},this.delConfirm=function(){(0,i.ajax)({url:deleteUrl,data:{deleteinfo:[{id:e.props.getUrlParam("id"),ts:e.props.form.getFormItemsValue(e.formId,"ts").value}]},success:function(t){t&&e.props.pushTo("/list")}})},this.modelSave=function(t){t.cardTable.closeModel(e.tableId),e.saveClick()},this.getButtonNames=function(e){return"edit"===e||"add"===e||"save"===e?"main-button":"secondary - button"},this.getTableHead=function(){var t=e.props.button.createButtonApp,a=(e.props.button.getButtons(),e.props.getUrlParam("status"));return l.default.createElement("div",{className:"shoulder-definition-area"},l.default.createElement("div",{className:"definition-search"},"browse"==a?l.default.createElement("div",null,l.default.createElement("span",{className:"definition-search-title"},e.state.json["10140SBAE-000018"]," | ",e.state.json["10140SBAE-000019"],"："),l.default.createElement("span",{className:"count"},e.state.totalcount),l.default.createElement("span",null,e.state.json["10140SBAE-000020"]),l.default.createElement("span",null,"  ",e.state.json["10140SBAE-000021"]," ："),l.default.createElement("span",{className:"count"},e.state.applycount),l.default.createElement("span",null,e.state.json["10140SBAE-000022"])):""),l.default.createElement("div",{className:"definition-icons",style:{padding:"0px"}},t({area:"body-action",onButtonClick:e.buttonClick.bind(e)}),e.props.cardTable.createBrowseIcons(e.tableId,{iconArr:["close","open","max","setCol"],maxDestAreaId:"nc-bill-card"})))}},n);E=(0,i.createPage)({initTemplate:[]})(E),t.default=E},3:function(e,t){e.exports=a},406:function(e,t,a){e.exports=a(290)}})});
//# sourceMappingURL=index.88176172.js.map